!function(){var t,e,n=(t=function(t,r){(function(t){(function(){"use strict";function t(t){if(t>2147483647)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=n.prototype,e}function n(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return a(t)}return i(t,e,r)}function i(e,r,i){if("string"==typeof e)return function(e,r){if("string"==typeof r&&""!==r||(r="utf8"),!n.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var i=0|u(e,r),o=t(i),a=o.write(e,r);return a!==i&&(o=o.slice(0,a)),o}(e,r);if(ArrayBuffer.isView(e))return s(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(j(e,ArrayBuffer)||e&&j(e.buffer,ArrayBuffer))return function(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var i;return(i=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r)).__proto__=n.prototype,i}(e,r,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return n.from(o,r,i);var a=function(e){if(n.isBuffer(e)){var r=0|l(e.length),i=t(r);return 0===i.length||e.copy(i,0,0,r),i}return void 0!==e.length?"number"!=typeof e.length||B(e.length)?t(0):s(e):"Buffer"===e.type&&Array.isArray(e.data)?s(e.data):void 0}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return n.from(e[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function o(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function a(e){return o(e),t(e<0?0:0|l(e))}function s(e){for(var r=e.length<0?0:0|l(e.length),n=t(r),i=0;i<r;i+=1)n[i]=255&e[i];return n}function l(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function u(t,e){if(n.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||j(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return T(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return L(t).length;default:if(o)return i?-1:T(t).length;e=(""+e).toLowerCase(),o=!0}}function c(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function p(t,e,r,i,o){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),B(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=n.from(e,i)),n.isBuffer(e))return 0===e.length?-1:h(t,e,r,i,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):h(t,[e],r,i,o);throw new TypeError("val must be string, number or Buffer")}function h(t,e,r,n,i){var o,a=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,r/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var c=-1;for(o=r;o<s;o++)if(u(t,o)===u(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*a}else-1!==c&&(o-=o-c),c=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var p=!0,h=0;h<l;h++)if(u(t,o+h)!==u(e,h)){p=!1;break}if(p)return o}return-1}function d(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(B(s))return a;t[r+a]=s}return a}function f(t,e,r,n){return O(T(e,t.length-r),t,r,n)}function v(t,e,r,n){return O(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function m(t,e,r,n){return v(t,e,r,n)}function b(t,e,r,n){return O(L(e),t,r,n)}function g(t,e,r,n){return O(function(t,e){for(var r,n,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=(r=t.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function w(t,e,r){return 0===e&&r===t.length?$.fromByteArray(t):$.fromByteArray(t.slice(e,r))}function y(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,a,s,l,u=t[i],c=null,p=u>239?4:u>223?3:u>191?2:1;if(i+p<=r)switch(p){case 1:u<128&&(c=u);break;case 2:128==(192&(o=t[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&(l=(15&u)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,p=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=p}return function(t){var e=t.length;if(e<=_)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=_));return r}(n)}r.Buffer=n,r.INSPECT_MAX_BYTES=50,n.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}(),n.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192,n.from=function(t,e,r){return i(t,e,r)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array,n.alloc=function(e,r,n){return function(e,r,n){return o(e),e<=0?t(e):void 0!==r?"string"==typeof n?t(e).fill(r,n):t(e).fill(r):t(e)}(e,r,n)},n.allocUnsafe=function(t){return a(t)},n.allocUnsafeSlow=function(t){return a(t)},n.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==n.prototype},n.compare=function(t,e){if(j(t,Uint8Array)&&(t=n.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=n.from(e,e.offset,e.byteLength)),!n.isBuffer(t)||!n.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,i=e.length,o=0,a=Math.min(r,i);o<a;++o)if(t[o]!==e[o]){r=t[o],i=e[o];break}return r<i?-1:i<r?1:0},n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return n.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=n.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var a=t[r];if(j(a,Uint8Array)&&(a=n.from(a)),!n.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},n.byteLength=u,n.prototype._isBuffer=!0,n.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)c(this,e,e+1);return this},n.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)c(this,e,e+3),c(this,e+1,e+2);return this},n.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)c(this,e,e+7),c(this,e+1,e+6),c(this,e+2,e+5),c(this,e+3,e+4);return this},n.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?y(this,0,t):function(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return k(this,e,r);case"utf8":case"utf-8":return y(this,e,r);case"ascii":return x(this,e,r);case"latin1":case"binary":return C(this,e,r);case"base64":return w(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===n.compare(this,t)},n.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},n.prototype.compare=function(t,e,r,i,o){if(j(t,Uint8Array)&&(t=n.from(t,t.offset,t.byteLength)),!n.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),e<0||r>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=r)return 0;if(i>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var a=(o>>>=0)-(i>>>=0),s=(r>>>=0)-(e>>>=0),l=Math.min(a,s),u=this.slice(i,o),c=t.slice(e,r),p=0;p<l;++p)if(u[p]!==c[p]){a=u[p],s=c[p];break}return a<s?-1:s<a?1:0},n.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},n.prototype.indexOf=function(t,e,r){return p(this,t,e,r,!0)},n.prototype.lastIndexOf=function(t,e,r){return p(this,t,e,r,!1)},n.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return d(this,t,e,r);case"utf8":case"utf-8":return f(this,t,e,r);case"ascii":return v(this,t,e,r);case"latin1":case"binary":return m(this,t,e,r);case"base64":return b(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function x(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function C(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function k(t,e,r){var n,i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var o="",a=e;a<r;++a)o+=(n=t[a])<16?"0"+n.toString(16):n.toString(16);return o}function E(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function P(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function A(t,e,r,i,o,a){if(!n.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<a)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function M(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function V(t,e,r,n,i){return e=+e,r>>>=0,i||M(t,0,r,4),rt.write(t,e,r,n,23,4),r+4}function S(t,e,r,n,i){return e=+e,r>>>=0,i||M(t,0,r,8),rt.write(t,e,r,n,52,8),r+8}n.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var i=this.subarray(t,e);return i.__proto__=n.prototype,i},n.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},n.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},n.prototype.readUInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),this[t]},n.prototype.readUInt16LE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]|this[t+1]<<8},n.prototype.readUInt16BE=function(t,e){return t>>>=0,e||P(t,2,this.length),this[t]<<8|this[t+1]},n.prototype.readUInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},n.prototype.readUInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},n.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},n.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||P(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},n.prototype.readInt8=function(t,e){return t>>>=0,e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},n.prototype.readInt16LE=function(t,e){t>>>=0,e||P(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt16BE=function(t,e){t>>>=0,e||P(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt32LE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},n.prototype.readInt32BE=function(t,e){return t>>>=0,e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},n.prototype.readFloatLE=function(t,e){return t>>>=0,e||P(t,4,this.length),rt.read(this,t,!0,23,4)},n.prototype.readFloatBE=function(t,e){return t>>>=0,e||P(t,4,this.length),rt.read(this,t,!1,23,4)},n.prototype.readDoubleLE=function(t,e){return t>>>=0,e||P(t,8,this.length),rt.read(this,t,!0,52,8)},n.prototype.readDoubleBE=function(t,e){return t>>>=0,e||P(t,8,this.length),rt.read(this,t,!1,52,8)},n.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||A(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},n.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||A(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},n.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,1,255,0),this[e]=255&t,e+1},n.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},n.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},n.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},n.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},n.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);A(this,t,e,r,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},n.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);A(this,t,e,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[e+o]=255&t;--o>=0&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},n.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},n.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},n.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},n.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},n.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||A(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},n.prototype.writeFloatLE=function(t,e,r){return V(this,t,e,!0,r)},n.prototype.writeFloatBE=function(t,e,r){return V(this,t,e,!1,r)},n.prototype.writeDoubleLE=function(t,e,r){return S(this,t,e,!0,r)},n.prototype.writeDoubleBE=function(t,e,r){return S(this,t,e,!1,r)},n.prototype.copy=function(t,e,r,i){if(!n.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var o=i-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,i);else if(this===t&&r<e&&e<i)for(var a=o-1;a>=0;--a)t[a+e]=this[a+r];else Uint8Array.prototype.set.call(t,this.subarray(r,i),e);return o},n.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!n.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var o=t.charCodeAt(0);("utf8"===i&&o<128||"latin1"===i)&&(t=o)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var a;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(a=e;a<r;++a)this[a]=t;else{var s=n.isBuffer(t)?t:n.from(t,i),l=s.length;if(0===l)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(a=0;a<r-e;++a)this[a+e]=s[a%l]}return this};var D=/[^+/0-9A-Za-z-_]/g;function T(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],a=0;a<n;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function L(t){return $.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(D,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function O(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function j(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function B(t){return t!=t}}).call(this)}).call(this,n({}).Buffer)},function(r){return e||t(e={exports:{},parent:r},e.exports),e.exports}),i={};(function(t){(function(){"use strict";var r=[],n=void 0===t?window:t,o=Math.pow(256,6),a=Math.pow(2,52),s=2*a,l=Math.random;function u(t){var e,r=t.length,n=this,i=0,o=n.i=n.j=0,a=n.S=[];for(r||(t=[r++]);i<256;)a[i]=i++;for(i=0;i<256;i++)a[i]=a[o=255&o+t[i%r]+(e=a[i])],a[o]=e;(n.g=function(t){for(var e,r=0,i=n.i,o=n.j,a=n.S;t--;)e=a[i=255&i+1],r=256*r+a[255&(a[i]=a[o=255&o+e])+(a[o]=e)];return n.i=i,n.j=o,r})(256)}function c(t,e){for(var r,n=t+"",i=0;i<n.length;)e[255&i]=255&(r^=19*e[255&i])+n.charCodeAt(i++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}(i=function(t,l){if(l&&!0===l.global)return l.global=!1,Math.random=i(t,l),l.global=!0,Math.random;var h=[],d=(c(function t(r,n){var i,o=[],a=(typeof r)[0];if(n&&"o"==a)for(i in r)try{o.push(t(r[i],n-1))}catch(e){}return o.length?o:"s"==a?r:r+"\0"}(l&&l.entropy?[t,p(r)]:0 in arguments?t:function(t){try{return n.crypto.getRandomValues(t=new Uint8Array(256)),p(t)}catch(e){return[+new Date,n,n.navigator&&n.navigator.plugins,n.screen,p(r)]}}(),3),h),new u(h));return c(p(d.S),r),function(){for(var t=d.g(6),e=o,r=0;t<a;)t=256*(t+r),e*=256,r=d.g(1);for(;t>=s;)t/=2,e/=2,r>>>=1;return(t+r)/e}}).resetGlobal=function(){Math.random=l},c(Math.random(),r)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var o={exports:{}};!function(){"use strict";var t=.5*(Math.sqrt(3)-1),e=(3-Math.sqrt(3))/6,r=(Math.sqrt(5)-1)/4,n=(5-Math.sqrt(5))/20;function i(t){var e;e="function"==typeof t?t:t?function(){var t,e=0,r=0,n=0,i=1,o=(t=4022871197,function(e){e=e.toString();for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});e=o(" "),r=o(" "),n=o(" ");for(var a=0;a<arguments.length;a++)(e-=o(arguments[a]))<0&&(e+=1),(r-=o(arguments[a]))<0&&(r+=1),(n-=o(arguments[a]))<0&&(n+=1);return o=null,function(){var t=2091639*e+2.3283064365386963e-10*i;return e=r,r=n,n=t-(i=0|t)}}(t):Math.random,this.p=a(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var r=0;r<512;r++)this.perm[r]=this.p[255&r],this.permMod12[r]=this.perm[r]%12}function a(t){var e,r=new Uint8Array(256);for(e=0;e<256;e++)r[e]=e;for(e=0;e<255;e++){var n=e+~~(t()*(256-e)),i=r[e];r[e]=r[n],r[n]=i}return r}i.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(r,n){var i,o,a=this.permMod12,s=this.perm,l=this.grad3,u=0,c=0,p=0,h=(r+n)*t,d=Math.floor(r+h),f=Math.floor(n+h),v=(d+f)*e,m=r-(d-v),b=n-(f-v);m>b?(i=1,o=0):(i=0,o=1);var g=m-i+e,w=b-o+e,y=m-1+2*e,_=b-1+2*e,x=255&d,C=255&f,k=.5-m*m-b*b;if(k>=0){var E=3*a[x+s[C]];u=(k*=k)*k*(l[E]*m+l[E+1]*b)}var P=.5-g*g-w*w;if(P>=0){var A=3*a[x+i+s[C+o]];c=(P*=P)*P*(l[A]*g+l[A+1]*w)}var M=.5-y*y-_*_;if(M>=0){var V=3*a[x+1+s[C+1]];p=(M*=M)*M*(l[V]*y+l[V+1]*_)}return 70*(u+c+p)},noise3D:function(t,e,r){var n,i,o,a,s,l,u,c,p,h,d=this.permMod12,f=this.perm,v=this.grad3,m=(t+e+r)*(1/3),b=Math.floor(t+m),g=Math.floor(e+m),w=Math.floor(r+m),y=(b+g+w)*(1/6),_=t-(b-y),x=e-(g-y),C=r-(w-y);_>=x?x>=C?(s=1,l=0,u=0,c=1,p=1,h=0):_>=C?(s=1,l=0,u=0,c=1,p=0,h=1):(s=0,l=0,u=1,c=1,p=0,h=1):x<C?(s=0,l=0,u=1,c=0,p=1,h=1):_<C?(s=0,l=1,u=0,c=0,p=1,h=1):(s=0,l=1,u=0,c=1,p=1,h=0);var k=_-s+1/6,E=x-l+1/6,P=C-u+1/6,A=_-c+1/6*2,M=x-p+1/6*2,V=C-h+1/6*2,S=_-1+.5,D=x-1+.5,T=C-1+.5,L=255&b,O=255&g,j=255&w,B=.6-_*_-x*x-C*C;if(B<0)n=0;else{var I=3*d[L+f[O+f[j]]];n=(B*=B)*B*(v[I]*_+v[I+1]*x+v[I+2]*C)}var R=.6-k*k-E*E-P*P;if(R<0)i=0;else{var F=3*d[L+s+f[O+l+f[j+u]]];i=(R*=R)*R*(v[F]*k+v[F+1]*E+v[F+2]*P)}var U=.6-A*A-M*M-V*V;if(U<0)o=0;else{var z=3*d[L+c+f[O+p+f[j+h]]];o=(U*=U)*U*(v[z]*A+v[z+1]*M+v[z+2]*V)}var N=.6-S*S-D*D-T*T;if(N<0)a=0;else{var H=3*d[L+1+f[O+1+f[j+1]]];a=(N*=N)*N*(v[H]*S+v[H+1]*D+v[H+2]*T)}return 32*(n+i+o+a)},noise4D:function(t,e,i,o){var a,s,l,u,c,p,h,d,f,v,m,b,g,w,y,_,x,C=this.perm,k=this.grad4,E=(t+e+i+o)*r,P=Math.floor(t+E),A=Math.floor(e+E),M=Math.floor(i+E),V=Math.floor(o+E),S=(P+A+M+V)*n,D=t-(P-S),T=e-(A-S),L=i-(M-S),O=o-(V-S),j=0,B=0,I=0,R=0;D>T?j++:B++,D>L?j++:I++,D>O?j++:R++,T>L?B++:I++,T>O?B++:R++,L>O?I++:R++;var F=D-(p=j>=3?1:0)+n,U=T-(h=B>=3?1:0)+n,z=L-(d=I>=3?1:0)+n,N=O-(f=R>=3?1:0)+n,H=D-(v=j>=2?1:0)+2*n,q=T-(m=B>=2?1:0)+2*n,K=L-(b=I>=2?1:0)+2*n,G=O-(g=R>=2?1:0)+2*n,$=D-(w=j>=1?1:0)+3*n,W=T-(y=B>=1?1:0)+3*n,Y=L-(_=I>=1?1:0)+3*n,Q=O-(x=R>=1?1:0)+3*n,X=D-1+4*n,J=T-1+4*n,Z=L-1+4*n,tt=O-1+4*n,et=255&P,rt=255&A,nt=255&M,it=255&V,ot=.6-D*D-T*T-L*L-O*O;if(ot<0)a=0;else{var at=C[et+C[rt+C[nt+C[it]]]]%32*4;a=(ot*=ot)*ot*(k[at]*D+k[at+1]*T+k[at+2]*L+k[at+3]*O)}var st=.6-F*F-U*U-z*z-N*N;if(st<0)s=0;else{var lt=C[et+p+C[rt+h+C[nt+d+C[it+f]]]]%32*4;s=(st*=st)*st*(k[lt]*F+k[lt+1]*U+k[lt+2]*z+k[lt+3]*N)}var ut=.6-H*H-q*q-K*K-G*G;if(ut<0)l=0;else{var ct=C[et+v+C[rt+m+C[nt+b+C[it+g]]]]%32*4;l=(ut*=ut)*ut*(k[ct]*H+k[ct+1]*q+k[ct+2]*K+k[ct+3]*G)}var pt=.6-$*$-W*W-Y*Y-Q*Q;if(pt<0)u=0;else{var ht=C[et+w+C[rt+y+C[nt+_+C[it+x]]]]%32*4;u=(pt*=pt)*pt*(k[ht]*$+k[ht+1]*W+k[ht+2]*Y+k[ht+3]*Q)}var dt=.6-X*X-J*J-Z*Z-tt*tt;if(dt<0)c=0;else{var ft=C[et+1+C[rt+1+C[nt+1+C[it+1]]]]%32*4;c=(dt*=dt)*dt*(k[ft]*X+k[ft+1]*J+k[ft+2]*Z+k[ft+3]*tt)}return 27*(a+s+l+u+c)}},i._buildPermutationTable=a,"undefined"!=typeof define&&define.amd&&define((function(){return i})),void 0!==o.exports?o.exports.SimplexNoise=i:"undefined"!=typeof window&&(window.SimplexNoise=i),o.exports=i}(),o=o.exports;var a=function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]},s=function t(e){e=a(e,null);var r,n,s,l=Math.random,u=null,c=!1;return p(e),{value:h,createRandom:function(e){return t(e)},setSeed:p,getSeed:function(){return r},getRandomSeed:function(){return String(Math.floor(1e6*Math.random()))},valueNonZero:function(){for(var t=0;0===t;)t=h();return t},permuteNoise:function(){s=d()},noise1D:function(t,e,r){if(!isFinite(t))throw new TypeError("x component for noise() must be finite");return e=a(e,1),(r=a(r,1))*s.noise2D(t*e,0)},noise2D:function(t,e,r,n){if(!isFinite(t))throw new TypeError("x component for noise() must be finite");if(!isFinite(e))throw new TypeError("y component for noise() must be finite");return r=a(r,1),(n=a(n,1))*s.noise2D(t*r,e*r)},noise3D:function(t,e,r,n,i){if(!isFinite(t))throw new TypeError("x component for noise() must be finite");if(!isFinite(e))throw new TypeError("y component for noise() must be finite");if(!isFinite(r))throw new TypeError("z component for noise() must be finite");return n=a(n,1),(i=a(i,1))*s.noise3D(t*n,e*n,r*n)},noise4D:function(t,e,r,n,i,o){if(!isFinite(t))throw new TypeError("x component for noise() must be finite");if(!isFinite(e))throw new TypeError("y component for noise() must be finite");if(!isFinite(r))throw new TypeError("z component for noise() must be finite");if(!isFinite(n))throw new TypeError("w component for noise() must be finite");return i=a(i,1),(o=a(o,1))*s.noise4D(t*i,e*i,r*i,n*i)},sign:function(){return f()?1:-1},boolean:f,chance:function(t){if("number"!=typeof(t=a(t,.5)))throw new TypeError("expected n to be a number");return h()<t},range:v,rangeFloor:m,pick:function(t){return 0===t.length?void 0:t[m(0,t.length)]},shuffle:function(t){if(!Array.isArray(t))throw new TypeError("Expected Array, got "+typeof t);for(var e,r,n=t.length,i=t.slice();n;)e=Math.floor(h()*n--),r=i[n],i[n]=i[e],i[e]=r;return i},onCircle:b,insideCircle:function(t,e){t=a(t,1),b(1,e=e||[]);var r=t*Math.sqrt(h());return e[0]*=r,e[1]*=r,e},onSphere:function(t,e){t=a(t,1),e=e||[];var r=h()*Math.PI*2,n=2*h()-1,i=r,o=Math.acos(n);return e[0]=t*Math.sin(o)*Math.cos(i),e[1]=t*Math.sin(o)*Math.sin(i),e[2]=t*Math.cos(o),e},insideSphere:function(t,e){t=a(t,1),e=e||[];var r=h()*Math.PI*2,n=2*h()-1,i=h(),o=r,s=Math.acos(n),l=t*Math.cbrt(i);return e[0]=l*Math.sin(s)*Math.cos(o),e[1]=l*Math.sin(s)*Math.sin(o),e[2]=l*Math.cos(s),e},quaternion:function(t){t=t||[];var e=h(),r=h(),n=h(),i=Math.sqrt(1-e),o=Math.sqrt(e),a=2*Math.PI*r,s=2*Math.PI*n,l=Math.sin(a)*i,u=Math.cos(a)*i,c=Math.sin(s)*o,p=Math.cos(s)*o;return t[0]=l,t[1]=u,t[2]=c,t[3]=p,t},weighted:w,weightedSet:function(t){return 0===(t=t||[]).length?null:t[g(t)].value},weightedSetIndex:g,gaussian:function(t,e){if(t=a(t,0),e=a(e,1),c){c=!1;var r=u;return u=null,t+e*r}var n=0,i=0,o=0;do{o=(n=2*h()-1)*n+(i=2*h()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);return u=i*s,c=!0,t+e*(n*s)}};function p(t,e){"number"==typeof t||"string"==typeof t?n=i(r=t,e):(r=void 0,n=l),s=d(),u=null,c=!1}function h(){return n()}function d(){return new o(n)}function f(){return h()>.5}function v(t,e){if(void 0===e&&(e=t,t=0),"number"!=typeof t||"number"!=typeof e)throw new TypeError("Expected all arguments to be numbers");return h()*(e-t)+t}function m(t,e){if(void 0===e&&(e=t,t=0),"number"!=typeof t||"number"!=typeof e)throw new TypeError("Expected all arguments to be numbers");return Math.floor(v(t,e))}function b(t,e){t=a(t,1),e=e||[];var r=2*h()*Math.PI;return e[0]=t*Math.cos(r),e[1]=t*Math.sin(r),e}function g(t){return 0===(t=t||[]).length?-1:w(t.map((function(t){return t.weight})))}function w(t){if(0===(t=t||[]).length)return-1;var e,r=0;for(e=0;e<t.length;e++)r+=t[e];if(r<=0)throw new Error("Weights must sum to > 0");var n=h()*r;for(e=0;e<t.length;e++){if(n<t[e])return e;n-=t[e]}return 0}}(),l=function(t,e,r){if("number"!=typeof e||"number"!=typeof r)throw new TypeError('Must specify "to" and "from" arguments as numbers');if(e>r){var n=e;e=r,r=n}var i=r-e;return 0===i?r:t-i*Math.floor((t-e)/i)},u=Number.EPSILON;function c(t,e,r){return e<r?t<e?e:t>r?r:t:t<r?r:t>e?e:t}function p(t,e,r){return t*(1-r)+e*r}function h(t,e,r){return Math.abs(t-e)<u?0:(r-t)/(e-t)}function d(t,e){return e=a(e,0),"number"==typeof t&&isFinite(t)?t:e}function f(t){if("number"!=typeof t)throw new TypeError("Expected dims argument");return function(e,r){var n;r=a(r,0),null==e?n=r:"number"==typeof e&&isFinite(e)&&(n=e);var i,o=[];if(null==n)for(i=0;i<t;i++)o[i]=d(e[i],r);else for(i=0;i<t;i++)o[i]=n;return o}}function v(t,e,r,n){if(n=n||[],t.length!==e.length)throw new TypeError("min and max array are expected to have the same length");for(var i=0;i<t.length;i++)n[i]=p(t[i],e[i],r);return n}function m(t,e){if("number"!=typeof(t=a(t,0)))throw new TypeError("Expected n argument to be a number");for(var r=[],n=0;n<t;n++)r.push(e);return r}function w(t,e){return(t%e+e)%e}function y(t,e,r,n){return p(t,e,1-Math.exp(-r*n))}var _={mod:w,fract:function(t){return t-Math.floor(t)},sign:function(t){return t>0?1:t<0?-1:0},degToRad:function(t){return t*Math.PI/180},radToDeg:function(t){return 180*t/Math.PI},wrap:l,pingPong:function(t,e){return t=w(t,2*e),e-Math.abs(t-e)},linspace:function(t,e){if("number"!=typeof(t=a(t,0)))throw new TypeError("Expected n argument to be a number");"boolean"==typeof(e=e||{})&&(e={endpoint:!0});var r=a(e.offset,0);return e.endpoint?m(t).map((function(e,n){return t<=1?0:(n+r)/(t-1)})):m(t).map((function(e,n){return(n+r)/t}))},lerp:p,lerpArray:v,inverseLerp:h,lerpFrames:function(t,e,r){e=c(e,0,1);var n=t.length-1,i=e*n,o=Math.floor(i),a=i-o,s=Math.min(o+1,n),l=t[o%t.length],u=t[s%t.length];if("number"==typeof l&&"number"==typeof u)return p(l,u,a);if(Array.isArray(l)&&Array.isArray(u))return v(l,u,a,r);throw new TypeError("Mismatch in value type of two array elements: "+o+" and "+s)},clamp:c,clamp01:function(t){return c(t,0,1)},smoothstep:function(t,e,r){var n=c(h(t,e,r),0,1);return n*n*(3-2*n)},damp:y,dampArray:function(t,e,r,n,i){i=i||[];for(var o=0;o<t.length;o++)i[o]=y(t[o],e[o],r,n);return i},mapRange:function(t,e,r,n,i,o){if(Math.abs(e-r)<u)return n;var a=(t-e)/(r-e)*(i-n)+n;return o&&(i<n?a<i?a=i:a>n&&(a=n):a>i?a=i:a<n&&(a=n)),a},expand2D:f(2),expand3D:f(3),expand4D:f(4)},x={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},C={};C.RGBAToHSLA=function(t){var e=function(t){var e,r,n=t[0],i=t[1],o=t[2],a=Math.min(n,i,o),s=Math.max(n,i,o),l=s-a;return s===a?e=0:n===s?e=(i-o)/l:i===s?e=2+(o-n)/l:o===s&&(e=4+(n-i)/l),(e=Math.min(60*e,360))<0&&(e+=360),r=(a+s)/2,[e/360,s===a?0:r<=.5?l/(s+a):l/(2-s-a),r]}([t[0]/255,t[1]/255,t[2]/255]);return[Math.max(0,Math.min(360,Math.round(360*e[0]))),Math.max(0,Math.min(100,Math.round(100*e[1]))),Math.max(0,Math.min(100,Math.round(100*e[2]))),t[3]]},C.HSLAToRGBA=function(t){var e=function(t){var e,r,n,i,o,a=t[0],s=t[1],l=t[2];if(0===s)return[o=l,o,o];e=2*l-(r=l<.5?l*(1+s):l+s-l*s),i=[0,0,0];for(var u=0;u<3;u++)(n=a+1/3*-(u-1))<0&&n++,n>1&&n--,o=6*n<1?e+6*(r-e)*n:2*n<1?r:3*n<2?e+(r-e)*(2/3-n)*6:e,i[u]=o;return i}([l(t[0],0,360)/360,t[1]/100,t[2]/100]);return[Math.max(0,Math.min(255,Math.round(255*e[0]))),Math.max(0,Math.min(255,Math.round(255*e[1]))),Math.max(0,Math.min(255,Math.round(255*e[2]))),t[3]]};var k=function(t){if("string"!=typeof t)throw new TypeError("Hex code parsing must be performed on a string parameter");if(t=t.toLowerCase(),!/^#[a-f0-9]+$/.test(t))return null;var e=t.replace(/^#/,""),r=1;8===e.length&&(r=parseInt(e.slice(6,8),16)/255,e=e.slice(0,6)),4===e.length&&(r=parseInt(e.slice(3,4).repeat(2),16)/255,e=e.slice(0,3)),3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var n=parseInt(e,16);return[n>>16,n>>8&255,255&n,r]},E=function(t){if(!t||!Array.isArray(t))throw new TypeError("Must specify an array to convert into a hex code");var e=Math.max(0,Math.min(255,Math.round(t[0]||0))),r=Math.max(0,Math.min(255,Math.round(t[1]||0))),n=Math.max(0,Math.min(255,Math.round(t[2]||0))),i=t[3];void 0!==i&&isFinite(i)||(i=1);var o=Math.max(0,Math.min(255,Math.round(255*i))),a=255===o?"":(256|o).toString(16).slice(1);return"#"+((n|r<<8|e<<16|1<<24).toString(16).slice(1)+a)},P={};function A(t){if("string"!=typeof t)throw new TypeError("Color parsing must be performed on a string parameter");var e,r,n;if((t=t.toLowerCase())in x?t=x[t]:"transparent"===t&&(t="#00000000"),/^#[a-f0-9]+$/.test(t))e=k(t),n=E(e),r=C.RGBAToHSLA(e);else{var i=/^((?:rgb|hsl)a?)\s*\(([^)]*)\)/.exec(t);if(!i)return null;var o=i[1].replace(/a$/,""),a=i[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map((function(t,e){return e<=2?Math.round(parseFloat(t)||0):("number"==typeof(t=parseFloat(t))&&isFinite(t)||(t=1),t)}));void 0!==a[3]&&isFinite(a[3])||(a[3]=1),"rgb"===o?(r=C.RGBAToHSLA(a),e=a):"hsl"===o&&(e=C.HSLAToRGBA(a),a[0]=l(a[0],0,360),r=a),n=E(e)}return e||n||r?{hex:n,alpha:e[3],rgb:e.slice(0,3),rgba:e,hsl:r.slice(0,3),hsla:r}:null}function M(t,e,r,n){return t=Math.max(0,Math.min(255,Math.round(t))),e=Math.max(0,Math.min(255,Math.round(e))),r=Math.max(0,Math.min(255,Math.round(r))),1!==n&&isFinite(n)&&void 0!==n?"rgba("+[t,e,r,n=Math.max(0,Math.min(1,n))].join(", ")+")":"rgb("+[t,e,r].join(", ")+")"}function V(t,e,r,n){return t=l(t,0,360),t=Math.max(0,Math.min(360,Math.round(t))),e=Math.max(0,Math.min(100,Math.round(e))),r=Math.max(0,Math.min(100,Math.round(r))),1!==n&&isFinite(n)&&void 0!==n?"hsla("+[t,e,r,n=Math.max(0,Math.min(1,n))].join(", ")+")":"hsl("+[t,e,r].join(", ")+")"}P.parse=function(t){return"string"==typeof t?A(t):Array.isArray(t)&&t.length>=3?A(M(t[0],t[1],t[2],t[3])):t&&"object"==typeof t&&(t.hex?e=t.hex:t.rgba?e=M(t.rgba[0],t.rgba[1],t.rgba[2],t.rgba[3]):t.hsla?e=V(t.hsla[0],t.hsla[1],t.hsla[2],t.hsla[3]):t.rgb?e=M(t.rgb[0],t.rgb[1],t.rgb[2]):t.hsl&&(e=V(t.hsl[0],t.hsl[1],t.hsl[2])),e)?A(e):null;var e},P.style=function(t){var e=P.parse(t);if(e){var r=e.rgba;return M(r[0],r[1],r[2],r[3])}return null};function S(t){return Math.pow((t+.055)/1.055,2.4)}var D={};D.parse=P.parse,D.style=P.style,D.names=x,D.relativeLuminance=function(t){var e,r,n,i,o=D.parse(t);return o?(e=o.rgb,r=e[0]/255,n=e[1]/255,i=e[2]/255,.2126*(r<=.03928?r*(1/12.92):S(r))+.7152*(n<=.03928?n*(1/12.92):S(n))+.0722*(i<=.03928?i*(1/12.92):S(i))):null},D.contrastRatio=function(t,e){var r=D.relativeLuminance(t),n=D.relativeLuminance(e);return null==r||null==n?null:(Math.max(r,n)+.05)/(Math.min(r,n)+.05)},D.offsetHSL=function(t,e,r,n){var i=D.parse(t);return i?(i.hsla[0]+=e||0,i.hsla[1]=Math.max(0,Math.min(100,i.hsla[1]+(r||0))),i.hsla[2]=Math.max(0,Math.min(100,i.hsla[2]+(n||0))),D.parse({hsla:i.hsla})):null},D.blend=function(t,e,r){var n=D.parse(t),i=D.parse(e);if(null==n||null==i)return null;var o=n.rgba,a=i.rgba,s=(r="number"==typeof r&&isFinite(r)?r:1)*a[3];if(s>=1)return i;for(var l=0;l<3;l++)a[l]=a[l]*s+o[l]*(o[3]*(1-s));return a[3]=Math.max(0,Math.min(1,s+o[3]*(1-s))),D.parse(a)},D.hexToRGBA=k,D.RGBAToHex=E,D.RGBAToHSLA=C.RGBAToHSLA,D.HSLAToRGBA=C.HSLAToRGBA;var T={};function L(t,e,r){var n,i,o,a,s,l=t.length,u=j(t[0],e),c=[];for(r||(r=[]),n=1;n<l;n++){for(i=t[n-1],a=s=j(o=t[n],e);;){if(!(u|a)){c.push(i),a!==s?(c.push(o),n<l-1&&(r.push(c),c=[])):n===l-1&&c.push(o);break}if(u&a)break;u?u=j(i=O(i,o,u,e),e):a=j(o=O(i,o,a,e),e)}u=s}return c.length&&r.push(c),r}function O(t,e,r,n){return 8&r?[t[0]+(e[0]-t[0])*(n[3]-t[1])/(e[1]-t[1]),n[3]]:4&r?[t[0]+(e[0]-t[0])*(n[1]-t[1])/(e[1]-t[1]),n[1]]:2&r?[n[2],t[1]+(e[1]-t[1])*(n[2]-t[0])/(e[0]-t[0])]:1&r?[n[0],t[1]+(e[1]-t[1])*(n[0]-t[0])/(e[0]-t[0])]:null}function j(t,e){var r=0;return t[0]<e[0]?r|=1:t[0]>e[2]&&(r|=2),t[1]<e[1]?r|=4:t[1]>e[3]&&(r|=8),r}T=L,L.polyline=L,L.polygon=function(t,e){var r,n,i,o,a,s,l;for(n=1;n<=8;n*=2){for(r=[],o=!(j(i=t[t.length-1],e)&n),a=0;a<t.length;a++)(l=!(j(s=t[a],e)&n))!==o&&r.push(O(i,s,n,e)),l&&r.push(s),i=s,o=l;if(!(t=r).length)break}return r};var B={},I=Math.abs,R=Math.min;function F(t,e,r,n){var i=I(t-e);return null==r&&(r=F.DBL_EPSILON),null==n&&(n=r),i<=r||i<=n*R(I(t),I(e))||t===e}F.FLT_EPSILON=1.1920929e-7,F.DBL_EPSILON=2220446049250313e-31,B=F;var U=Object.prototype.toString,z=function(t){return t.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===U.call(t.buffer)||Array.isArray(t)},N={},H=Math.abs,q=Math.min;function K(t,e,r,n){var i=H(t-e);return i<=r||i<=n*q(H(t),H(e))||t===e}K.FLT_EPSILON=1.1920929e-7,K.DBL_EPSILON=2220446049250313e-31,N=K;for(var G=function(t,e,r,n){return!!(t&&e&&z(t)&&z(e))&&t.length===e.length&&("number"!=typeof r&&(r=N.FLT_EPSILON),"number"!=typeof n&&(n=r),Array.prototype.slice.call(t).every((function(t,i){var o=e[i];return t===o||N(t,o,r,n)})))},$={toByteArray:function(t){var e,r,n=tt(t),i=n[0],o=n[1],a=new Q(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),s=0,l=o>0?i-4:i;for(r=0;r<l;r+=4)e=Y[t.charCodeAt(r)]<<18|Y[t.charCodeAt(r+1)]<<12|Y[t.charCodeAt(r+2)]<<6|Y[t.charCodeAt(r+3)],a[s++]=e>>16&255,a[s++]=e>>8&255,a[s++]=255&e;return 2===o&&(e=Y[t.charCodeAt(r)]<<2|Y[t.charCodeAt(r+1)]>>4,a[s++]=255&e),1===o&&(e=Y[t.charCodeAt(r)]<<10|Y[t.charCodeAt(r+1)]<<4|Y[t.charCodeAt(r+2)]>>2,a[s++]=e>>8&255,a[s++]=255&e),a},fromByteArray:function(t){for(var e,r=t.length,n=r%3,i=[],o=0,a=r-n;o<a;o+=16383)i.push(et(t,o,o+16383>a?a:o+16383));return 1===n?(e=t[r-1],i.push(W[e>>2]+W[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],i.push(W[e>>10]+W[e>>4&63]+W[e<<2&63]+"=")),i.join("")}},W=[],Y=[],Q="undefined"!=typeof Uint8Array?Uint8Array:Array,X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",J=0,Z=X.length;J<Z;++J)W[J]=X[J],Y[X.charCodeAt(J)]=J;function tt(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function et(t,e,r){for(var n,i,o=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(W[(i=n)>>18&63]+W[i>>12&63]+W[i>>6&63]+W[63&i]);return o.join("")}Y["-".charCodeAt(0)]=62,Y["_".charCodeAt(0)]=63;var rt={read:function(t,e,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?i-1:0,h=r?-1:1,d=t[e+p];for(p+=h,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+t[e+p],p+=h,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+t[e+p],p+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=u}return(d?-1:1)*a*Math.pow(2,o-n)},write:function(t,e,r,n,i,o){var a,s,l,u=8*o-i-1,c=(1<<u)-1,p=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,f=n?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+p>=1?h/l:h*Math.pow(2,1-p))*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(e*l-1)*Math.pow(2,i),a+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;t[r+d]=255&s,d+=f,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;t[r+d]=255&a,d+=f,a/=256,u-=8);t[r+d-f]|=128*v}},nt={exports:{}};(function(t){(function(){var e=function(){"use strict";function e(t,e){return null!=e&&t instanceof e}var r,n,i;try{r=Map}catch(l){r=function(){}}try{n=Set}catch(l){n=function(){}}try{i=Promise}catch(l){i=function(){}}function o(a,l,u,c,p){"object"==typeof l&&(u=l.depth,c=l.prototype,p=l.includeNonEnumerable,l=l.circular);var h=[],d=[],f=void 0!==t;return void 0===l&&(l=!0),void 0===u&&(u=1/0),function a(u,v){if(null===u)return null;if(0===v)return u;var m,b;if("object"!=typeof u)return u;if(e(u,r))m=new r;else if(e(u,n))m=new n;else if(e(u,i))m=new i((function(t,e){u.then((function(e){t(a(e,v-1))}),(function(t){e(a(t,v-1))}))}));else if(o.__isArray(u))m=[];else if(o.__isRegExp(u))m=new RegExp(u.source,s(u)),u.lastIndex&&(m.lastIndex=u.lastIndex);else if(o.__isDate(u))m=new Date(u.getTime());else{if(f&&t.isBuffer(u))return m=t.allocUnsafe?t.allocUnsafe(u.length):new t(u.length),u.copy(m),m;e(u,Error)?m=Object.create(u):void 0===c?(b=Object.getPrototypeOf(u),m=Object.create(b)):(m=Object.create(c),b=c)}if(l){var g=h.indexOf(u);if(-1!=g)return d[g];h.push(u),d.push(m)}for(var w in e(u,r)&&u.forEach((function(t,e){var r=a(e,v-1),n=a(t,v-1);m.set(r,n)})),e(u,n)&&u.forEach((function(t){var e=a(t,v-1);m.add(e)})),u){var y;b&&(y=Object.getOwnPropertyDescriptor(b,w)),y&&null==y.set||(m[w]=a(u[w],v-1))}if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(u);for(w=0;w<_.length;w++){var x=_[w];(!(k=Object.getOwnPropertyDescriptor(u,x))||k.enumerable||p)&&(m[x]=a(u[x],v-1),k.enumerable||Object.defineProperty(m,x,{enumerable:!1}))}}if(p){var C=Object.getOwnPropertyNames(u);for(w=0;w<C.length;w++){var k,E=C[w];(k=Object.getOwnPropertyDescriptor(u,E))&&k.enumerable||(m[E]=a(u[E],v-1),Object.defineProperty(m,E,{enumerable:!1}))}}return m}(a,u)}function a(t){return Object.prototype.toString.call(t)}function s(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return o.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},o.__objToStr=a,o.__isDate=function(t){return"object"==typeof t&&"[object Date]"===a(t)},o.__isArray=function(t){return"object"==typeof t&&"[object Array]"===a(t)},o.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===a(t)},o.__getRegExpFlags=s,o}();nt.exports&&(nt.exports=e)}).call(this)}).call(this,n({}).Buffer),nt=nt.exports;var it={};function ot(t,e,r,n,i){return(o=r-t)*o+(a=n-e)*a<=i*i;var o,a}function at(t,e,r,n){var i=t-r,o=e-n;return Math.sqrt(i*i+o*o)}function st(t,e,r,n,i){var o=i/at(t,e,r,n);return[t+o*(r-t),e+o*(n-e)]}it.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n};function lt(t){return t*t}var ut={},ct=it.squaredDistance;ut.arePointsCollinear=function(t,e,r){var n=t[0],i=t[1],o=e[0],a=e[1],s=r[0],l=r[1];return B((i-a)*(n-s),(i-l)*(n-o))},ut.removeDuplicatePoints=function(t){for(var e,r=[],n=0;n<t.length;n++){var i=t[n];e&&G(e,i)||(r.push(i),e=i)}return nt(r)},ut.removeCollinearPoints=function(t){for(var e=[],r=nt(t);r.length>=3;){var n=r[0],i=r[1],o=r[2],a=ut.arePointsCollinear(n,i,o);if(a&&ct(n,i)>ct(n,o)&&(a=!1),a)r.splice(1,1);else for(var s=0;s<1;s++)e.push(r.shift())}for(;r.length;)e.push(r.shift());return e},ut.clipSegmentToCircle=function(t,e,r,n,i){return function(t,e,r,n,i,o,a,s){null==s&&(s=[]);var l,u,c,p,h,d=ot(t,e,i,o,a),f=ot(r,n,i,o,a);if(d&&f)return s.push([t,e]),s.push([r,n]),!0;if(d||f){l=at(p=(c=function(t,e,r,n,i,o){var a=r-t,s=n-e,l=(a*(i-t)+s*(o-e))/(a*a+s*s);return[t+l*a,e+l*s]}(t,e,r,n,i,o))[0],h=c[1],i,o),u=Math.sqrt(a*a-l*l);var v=d?[t,e]:[r,n],m=d?st(p,h,r,n,u):st(p,h,t,e,u);return B(v[0],m[0])&&B(v[1],m[1])?(s.push(v),!0):(s.push(v),s.push(m),!0)}return p=(c=function(t,e,r,n,i,o){var a=r-t,s=n-e,l=a*(i-t)+s*(o-e);if(l<=0)return[t,e];var u=a*a+s*s;if(u<=l)return[r,n];var c=l/u;return[t+c*a,e+c*s]}(t,e,r,n,i,o))[0],h=c[1],!(B(t,p)&&B(e,h)||B(r,p)&&B(n,h)||(l=at(p,h,i,o))>a||(B(l,a)?(s.push([p,h]),0):B(l,0)?(s.push(st(i,o,t,e,a)),s.push(st(i,o,r,n,a)),0):(u=Math.sqrt(a*a-l*l),s.push(st(p,h,t,e,u)),s.push(st(p,h,r,n,u)),0)))}(t[0],t[1],e[0],e[1],r[0],r[1],n,i)},ut.clipLineToCircle=function(t,e,r,n,i){null==i&&(i=[]);var o,a=lt(e[0]-t[0])+lt(e[1]-t[1]),s=2*((e[0]-t[0])*(t[0]-r[0])+(e[1]-t[1])*(t[1]-r[1])),l=s*s-4*a*(lt(r[0])+lt(r[1])+lt(t[0])+lt(t[1])-2*(r[0]*t[0]+r[1]*t[1])-lt(n));if(l<0)return!1;if(B(l,0))return o=-s/(2*a),i.push([t[0]+o*(e[0]-t[0]),t[1]+o*(e[1]-t[1])]),!0;if(l>0){var u=Math.sqrt(l);return o=(-s+u)/(2*a),i.push([t[0]+o*(e[0]-t[0]),t[1]+o*(e[1]-t[1])]),o=(-s-u)/(2*a),i.push([t[0]+o*(e[0]-t[0]),t[1]+o*(e[1]-t[1])]),!0}return null},ut.clipPolylinesToBox=function(t,e,r,n){if(!Array.isArray(e)||2!==e.length&&4!==e.length)throw new Error("Expected box to either be format [ minPoint, maxPoint ] or [ minX, minY, maxX, maxY ]");if(2===e.length){var i=e[0],o=e[1];e=[i[0],i[1],o[0],o[1]]}return n=!1!==n,(r=Boolean(r))?t.map((function(t){var r=T.polygon(t,e);return n&&r.length>2&&r.push(r[0]),r})).filter((function(t){return t.length>0})):t.map((function(t){return T.polyline(t,e)})).reduce((function(t,e){return t.concat(e)}),[])},ut.createHatchLines=function(t,e,r,n){if(!Array.isArray(t)||2!==t.length&&4!==t.length)throw new Error("Expected box to either be format [ minPoint, maxPoint ] or [ minX, minY, maxX, maxY ]");if(2===t.length){var i=t[0],o=t[1];t=[i[0],i[1],o[0],o[1]]}if(null==e&&(e=-Math.PI/4),null==r&&(r=.5),null==n&&(n=[]),0===(r=Math.abs(r)))throw new Error("cannot use a spacing of zero as it will run an infinite loop!");var a=t[0],s=t[1],l=t[2],u=t[3],c=l-a,p=u-s;if(0===c||0===p)return n;for(var h=Math.sqrt(c*c+p*p)/2,d=Math.PI/2-e,f=Math.cos(d),v=Math.sin(d),m=a+c/2,b=s+p/2,g=-h;g<=h;){var w=m+g*f+h*v,y=b+g*v-h*f,_=m+g*f-h*v,x=b+g*v+h*f;g+=r,w<a&&_<a||w>l&&_>l||y<s&&x<s||y>u&&x>u||n.push([[w,y],[_,x]])}return n},ut.getBounds=function(t){var e=t.length;if(0===e)throw new Error("Expected points to be a non-empty array");for(var r=t[0].length,n=t[0].slice(),i=t[0].slice(),o=1;o<e;++o)for(var a=t[o],s=0;s<r;++s){var l=a[s];n[s]=Math.min(n[s],l),i[s]=Math.max(i[s],l)}return[n,i]};var pt,ht=["mm","cm","m","pc","pt","in","ft","px"],dt={m:{system:"metric",factor:1},cm:{system:"metric",factor:.01},mm:{system:"metric",factor:.001},pt:{system:"imperial",factor:1/72},pc:{system:"imperial",factor:1/6},in:{system:"imperial",factor:1},ft:{system:"imperial",factor:12}};const ft={metric:{unit:"m",ratio:1/.0254},imperial:{unit:"in",ratio:.0254}};(pt=function(t,e,r,n){if("number"!=typeof t||!isFinite(t))throw new Error("Value must be a finite number");if(!e||!r)throw new Error("Must specify from and to units");var i=a((n=n||{}).pixelsPerInch,96),o=n.precision,s=!1!==n.roundPixel;if(e=e.toLowerCase(),r=r.toLowerCase(),-1===ht.indexOf(e))throw new Error('Invalid from unit "'+e+'", must be one of: '+ht.join(", "));if(-1===ht.indexOf(r))throw new Error('Invalid from unit "'+r+'", must be one of: '+ht.join(", "));if(e===r)return t;var l=1,u=1,c=!1;"px"===e&&(u=1/i,e="in"),"px"===r&&(c=!0,l=i,r="in");var p=dt[e],h=dt[r],d=t*p.factor*u;p.system!==h.system&&(d*=ft[p.system].ratio);var f=d/h.factor*l;return c&&s?f=Math.round(f):"number"==typeof o&&isFinite(o)&&(f=function(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)}(f,o)),f}).units=ht;var vt={};Object.defineProperty(vt,"__esModule",{value:!0}),Object.defineProperty(vt,"path",{enumerable:!0,get:function(){return bt.default}});var mt,bt=(mt=require("./path.js"))&&mt.__esModule?mt:{default:mt};function gt(t){return[t[0],t[1]]}function wt(t,e){return[t,e]}var yt,_t,xt,Ct,kt,Et,Pt,At=(_t="number"==typeof(yt=yt||{}).recursion?yt.recursion:8,xt="number"==typeof yt.epsilon?yt.epsilon:1.1920929e-7,Ct="number"==typeof yt.pathEpsilon?yt.pathEpsilon:1,kt="number"==typeof yt.angleEpsilon?yt.angleEpsilon:.01,Et=yt.angleTolerance||0,Pt=yt.cuspLimit||0,function(t,e,r,n,i,o){o||(o=[]);var a=Ct/(i="number"==typeof i?i:1);return function(t,e,r,n,i,o){i.push(gt(t)),function t(e,r,n,i,o,a,s,l,u,c,p){if(!(p>_t)){var h=Math.PI,d=(e+n)/2,f=(r+i)/2,v=(n+o)/2,m=(i+a)/2,b=(o+s)/2,g=(a+l)/2,w=(d+v)/2,y=(f+m)/2,_=(v+b)/2,x=(m+g)/2,C=(w+_)/2,k=(y+x)/2;if(p>0){var E,P,A=s-e,M=l-r,V=Math.abs((n-s)*M-(i-l)*A),S=Math.abs((o-s)*M-(a-l)*A);if(V>xt&&S>xt){if((V+S)*(V+S)<=c*(A*A+M*M)){if(Et<kt)return void u.push(wt(C,k));var D=Math.atan2(a-i,o-n);if((E=Math.abs(D-Math.atan2(i-r,n-e)))>=h&&(E=2*h-E),(P=Math.abs(Math.atan2(l-a,s-o)-D))>=h&&(P=2*h-P),E+P<Et)return void u.push(wt(C,k));if(0!==Pt){if(E>Pt)return void u.push(wt(n,i));if(P>Pt)return void u.push(wt(o,a))}}}else if(V>xt){if(V*V<=c*(A*A+M*M)){if(Et<kt)return void u.push(wt(C,k));if((E=Math.abs(Math.atan2(a-i,o-n)-Math.atan2(i-r,n-e)))>=h&&(E=2*h-E),E<Et)return u.push(wt(n,i)),void u.push(wt(o,a));if(0!==Pt&&E>Pt)return void u.push(wt(n,i))}}else if(S>xt){if(S*S<=c*(A*A+M*M)){if(Et<kt)return void u.push(wt(C,k));if((E=Math.abs(Math.atan2(l-a,s-o)-Math.atan2(a-i,o-n)))>=h&&(E=2*h-E),E<Et)return u.push(wt(n,i)),void u.push(wt(o,a));if(0!==Pt&&E>Pt)return void u.push(wt(o,a))}}else if((A=C-(e+s)/2)*A+(M=k-(r+l)/2)*M<=c)return void u.push(wt(C,k))}t(e,r,d,f,w,y,C,k,u,c,p+1),t(C,k,_,x,b,g,s,l,u,c,p+1)}}(t[0],t[1],e[0],e[1],r[0],r[1],n[0],n[1],i,o,0),i.push(gt(n))}(t,e,r,n,o,a*=a),o}),Mt=function(t){var e=0,r=0,n=0,i=0;return t.map((function(t){var o=(t=t.slice())[0],a=o.toUpperCase();if(o!=a)switch(t[0]=a,o){case"a":t[6]+=n,t[7]+=i;break;case"v":t[1]+=i;break;case"h":t[1]+=n;break;default:for(var s=1;s<t.length;)t[s++]+=n,t[s++]+=i}switch(a){case"Z":n=e,i=r;break;case"H":n=t[1];break;case"V":i=t[1];break;case"M":n=e=t[1],i=r=t[2];break;default:n=t[t.length-2],i=t[t.length-1]}return t}))},Vt=Math.PI,St=jt(120);function Dt(t,e,r,n){return["C",t,e,r,n,r,n]}function Tt(t,e,r,n,i,o){return["C",t/3+2/3*r,e/3+2/3*n,i/3+2/3*r,o/3+2/3*n,i,o]}function Lt(t,e,r,n,i,o,a,s,l,u){if(u)w=u[0],y=u[1],b=u[2],g=u[3];else{var c=Ot(t,e,-i);t=c.x,e=c.y;var p=(t-(s=(c=Ot(s,l,-i)).x))/2,h=(e-(l=c.y))/2,d=p*p/(r*r)+h*h/(n*n);d>1&&(r*=d=Math.sqrt(d),n*=d);var f=r*r,v=n*n,m=(o==a?-1:1)*Math.sqrt(Math.abs((f*v-f*h*h-v*p*p)/(f*h*h+v*p*p)));m==1/0&&(m=1);var b=m*r*h/n+(t+s)/2,g=m*-n*p/r+(e+l)/2,w=Math.asin(((e-g)/n).toFixed(9)),y=Math.asin(((l-g)/n).toFixed(9));(w=t<b?Vt-w:w)<0&&(w=2*Vt+w),(y=s<b?Vt-y:y)<0&&(y=2*Vt+y),a&&w>y&&(w-=2*Vt),!a&&y>w&&(y-=2*Vt)}if(Math.abs(y-w)>St){var _=y,x=s,C=l;y=w+St*(a&&y>w?1:-1);var k=Lt(s=b+r*Math.cos(y),l=g+n*Math.sin(y),r,n,i,0,a,x,C,[y,_,b,g])}var E=Math.tan((y-w)/4),P=4/3*r*E,A=4/3*n*E,M=[2*t-(t+P*Math.sin(w)),2*e-(e-A*Math.cos(w)),s+P*Math.sin(y),l-A*Math.cos(y),s,l];if(u)return M;k&&(M=M.concat(k));for(var V=0;V<M.length;){var S=Ot(M[V],M[V+1],i);M[V++]=S.x,M[V++]=S.y}return M}function Ot(t,e,r){return{x:t*Math.cos(r)-e*Math.sin(r),y:t*Math.sin(r)+e*Math.cos(r)}}function jt(t){return t*(Vt/180)}function Bt(t,e,r){return t[0]=e,t[1]=r,t}var It=[0,0],Rt=[0,0],Ft=[0,0],Ut=function(t,e){var r=[],n=[],i=[0,0];return function(t){for(var e,r=[],n=0,i=0,o=0,a=0,s=null,l=null,u=0,c=0,p=0,h=t.length;p<h;p++){var d=t[p],f=d[0];switch(f){case"M":o=d[1],a=d[2];break;case"A":(d=Lt(u,c,d[1],d[2],jt(d[3]),d[4],d[5],d[6],d[7])).unshift("C"),d.length>7&&(r.push(d.splice(0,7)),d.unshift("C"));break;case"S":var v=u,m=c;"C"!=e&&"S"!=e||(v+=v-n,m+=m-i),d=["C",v,m,d[1],d[2],d[3],d[4]];break;case"T":"Q"==e||"T"==e?(s=2*u-s,l=2*c-l):(s=u,l=c),d=Tt(u,c,s,l,d[1],d[2]);break;case"Q":s=d[1],l=d[2],d=Tt(u,c,d[1],d[2],d[3],d[4]);break;case"L":d=Dt(u,c,d[1],d[2]);break;case"H":d=Dt(u,c,d[1],c);break;case"V":d=Dt(u,c,u,d[1]);break;case"Z":d=Dt(u,c,o,a)}e=f,u=d[d.length-2],c=d[d.length-1],d.length>4?(n=d[d.length-4],i=d[d.length-3]):(n=u,i=c),r.push(d)}return r}(Mt(t)).forEach((function(t,o,a){if("M"===t[0])s=i,l=t.slice(1),s[0]=l[0],s[1]=l[1],n.length>0&&(r.push(n),n=[]);else{if("C"!==t[0])throw new Error("illegal type in SVG: "+t[0]);!function(t,e,r,n){At(r,Bt(It,n[1],n[2]),Bt(Rt,n[3],n[4]),Bt(Ft,n[5],n[6]),e,t)}(n,e,i,t),Bt(i,t[5],t[6])}var s,l})),n.length>0&&r.push(n),r},zt=function(t){var e=[];return t.replace(Ht,(function(t,r,n){var i=r.toLowerCase();for(n=function(t){var e=t.match(qt);return e?e.map(Number):[]}(n),"m"==i&&n.length>2&&(e.push([r].concat(n.splice(0,2))),i="l",r="m"==r?"l":"L");;){if(n.length==Nt[i])return n.unshift(r),e.push(n);if(n.length<Nt[i])throw new Error("malformed path data");e.push([r].concat(n.splice(0,Nt[i])))}})),e},Nt={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Ht=/([astvzqmhlc])([^astvzqmhlc]*)/gi,qt=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi,Kt={};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.default=void 0;var Gt=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(l){i=!0,o=l}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},$t=2*Math.PI,Wt=function(t,e,r,n,i,o,a){var s=t.x,l=t.y;return{x:n*(s*=e)-i*(l*=r)+o,y:i*s+n*l+a}},Yt=function(t,e){var r=1.5707963267948966===e?.551915024494:-1.5707963267948966===e?-.551915024494:4/3*Math.tan(e/4),n=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:n-i*r,y:i+n*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]},Qt=function(t,e,r,n){var i=t*r+e*n;return i>1&&(i=1),i<-1&&(i=-1),(t*n-e*r<0?-1:1)*Math.acos(i)};Kt.default=function(t){var e=t.px,r=t.py,n=t.cx,i=t.cy,o=t.rx,a=t.ry,s=t.xAxisRotation,l=void 0===s?0:s,u=t.largeArcFlag,c=void 0===u?0:u,p=t.sweepFlag,h=void 0===p?0:p,d=[];if(0===o||0===a)return[];var f=Math.sin(l*$t/360),v=Math.cos(l*$t/360),m=v*(e-n)/2+f*(r-i)/2,b=-f*(e-n)/2+v*(r-i)/2;if(0===m&&0===b)return[];o=Math.abs(o),a=Math.abs(a);var g=Math.pow(m,2)/Math.pow(o,2)+Math.pow(b,2)/Math.pow(a,2);g>1&&(o*=Math.sqrt(g),a*=Math.sqrt(g));var w=function(t,e,r,n,i,o,a,s,l,u,c,p){var h=Math.pow(i,2),d=Math.pow(o,2),f=Math.pow(c,2),v=Math.pow(p,2),m=h*d-h*v-d*f;m<0&&(m=0),m/=h*v+d*f;var b=(m=Math.sqrt(m)*(a===s?-1:1))*i/o*p,g=m*-o/i*c,w=u*b-l*g+(t+r)/2,y=l*b+u*g+(e+n)/2,_=(c-b)/i,x=(p-g)/o,C=(-c-b)/i,k=(-p-g)/o,E=Qt(1,0,_,x),P=Qt(_,x,C,k);return 0===s&&P>0&&(P-=$t),1===s&&P<0&&(P+=$t),[w,y,E,P]}(e,r,n,i,o,a,c,h,f,v,m,b),y=Gt(w,4),_=y[0],x=y[1],C=y[2],k=y[3],E=Math.abs(k)/($t/4);Math.abs(1-E)<1e-7&&(E=1);var P=Math.max(Math.ceil(E),1);k/=P;for(var A=0;A<P;A++)d.push(Yt(C,k)),C+=k;return d.map((function(t){var e=Wt(t[0],o,a,v,f,_,x),r=e.x,n=e.y,i=Wt(t[1],o,a,v,f,_,x),s=i.x,l=i.y,u=Wt(t[2],o,a,v,f,_,x);return{x1:r,y1:n,x2:s,y2:l,x:u.x,y:u.y}}))};var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.default=function(t){for(var e,r=[],n=0,i=0,o=0,a=0,s=null,l=null,u=0,c=0,p=0,h=t.length;p<h;p++){var d=t[p],f=d[0];switch(f){case"M":o=d[1],a=d[2];break;case"A":var v=(0,Zt.default)({px:u,py:c,cx:d[6],cy:d[7],rx:d[1],ry:d[2],xAxisRotation:d[3],largeArcFlag:d[4],sweepFlag:d[5]});if(!v.length)continue;for(var m,b=0;b<v.length;b++)d=["C",(m=v[b]).x1,m.y1,m.x2,m.y2,m.x,m.y],b<v.length-1&&r.push(d);break;case"S":var g=u,w=c;"C"!=e&&"S"!=e||(g+=g-n,w+=w-i),d=["C",g,w,d[1],d[2],d[3],d[4]];break;case"T":"Q"==e||"T"==e?(s=2*u-s,l=2*c-l):(s=u,l=c),d=ee(u,c,s,l,d[1],d[2]);break;case"Q":s=d[1],l=d[2],d=ee(u,c,d[1],d[2],d[3],d[4]);break;case"L":d=te(u,c,d[1],d[2]);break;case"H":d=te(u,c,d[1],c);break;case"V":d=te(u,c,u,d[1]);break;case"Z":d=te(u,c,o,a)}e=f,u=d[d.length-2],c=d[d.length-1],d.length>4?(n=d[d.length-4],i=d[d.length-3]):(n=u,i=c),r.push(d)}return r};var Jt,Zt=(Jt=Kt)&&Jt.__esModule?Jt:{default:Jt};function te(t,e,r,n){return["C",t,e,r,n,r,n]}function ee(t,e,r,n,i,o){return["C",t/3+2/3*r,e/3+2/3*n,i/3+2/3*r,o/3+2/3*n,i,o]}var re={},ne=it.squaredDistance;function ie(t,e,r){var n=Math.min(e,r),i=Math.max(e,r),o=(t=t.slice())[n],a=t[i],s=o.concat(a.slice(1));return t.splice(i,1),t.splice(n,1,s),t}re.sort=function(t){if(!(t=nt(t)).length)return t;var e=[];for(e.push(t[0]),t=t.slice(1);t.length;){var r=e[e.length-1],n=r[r.length-1],i=t.reduce((function(t,e,r){var i=e[0],o=e[e.length-1],a=ne(n,i),s=ne(n,o);return t?a<t.distance?{idx:r,distance:a,reverse:!1}:s<t.distance?{idx:r,distance:s,reverse:!0}:t:{idx:r,distance:Math.min(a,s),reverse:s<a}}),null),o=i.idx,a=i.reverse,s=t.splice(o,1)[0].slice();a&&s.reverse(),e.push(s)}return e},re.merge=function(t,e){var r=(e=null!=e?e:.05)*e;t=nt(t);for(var n=1;n<t.length;n++){var i=t[n-1],o=t[n];ne(o[0],i[i.length-1])<r&&(t=ie(t,n-1,n),n-=1)}return t};var oe={};function ae(t,e){var r=pe(t,e=e||{});return(Array.isArray(r)?r:[r]).filter(Boolean)}function se(t,e){var r;if(null!=(e=e||{}).curveResolution&&isFinite(e.curveResolution)&&"number"==typeof e.curveResolution)r=e.curveResolution;else{var n=e.units||"px";r=Math.max(1,pt(4,n,"px"))}var i=[];return he(t,(function(t){if("string"==typeof t){var e=zt(t);Ut(e,r).forEach((function(t){i.push(t)}))}else{var n=t.map((function(t){return[t[0]||0,t[1]||0]}));i.push(n)}})),i}function le(t,e){var r=(e=e||{}).width,n=e.height;if(void 0===r||void 0===n)throw new Error('Must specify "width" and "height" options');var i=e.units||"px",o={units:i,viewUnits:"px",roundPixel:!1,precision:a(e.precision,5),pixelsPerInch:90};if(t=se(t,Object.assign({},o,{curveResolution:e.curveResolution||void 0})),e.optimize){var s="object"==typeof e.optimize?e.optimize:{sort:!0,merge:!0,removeDuplicates:!0,removeCollinear:!0},l=!1!==s.sort,u=!1!==s.merge,c=!1!==s.removeDuplicates,p=!1!==s.removeCollinear;if(c&&(t=t.map((function(t){return ut.removeDuplicatePoints(t)}))),p&&(t=t.map((function(t){return ut.removeCollinearPoints(t)}))),l&&(t=re.sort(t)),u){var h=null!=s.mergeThreshold?s.mergeThreshold:pt(.25,"mm",i,{pixelsPerInch:90});t=re.merge(t,h)}}var d=ae(t,o),f=pt(r,i,"px",o).toString(),v=pt(n,i,"px",o).toString(),m=e.fillStyle||"none",b=e.strokeStyle||"black",g=e.lineWidth,w=e.lineJoin,y=e.lineCap;void 0===g&&(g=pt(.03,"cm",i,o).toString());var _=d.map((function(t){return"    <path "+ue([["d",t]])+" />"})).join("\n");return['<?xml version="1.0" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','    "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">','<svg width="'+r+i+'" height="'+n+i+'"','    xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '+f+" "+v+'">',"  <g "+ue([["fill",m],["stroke",b],["stroke-width",g+""+i],!!w&&["stroke-linejoin",w],!!y&&["stroke-linecap",y]])+">",_,"  </g>","</svg>"].join("\n")}function ue(t){return t.filter(Boolean).map((function(t){return t[0]+'="'+t[1]+'"'})).join(" ")}function ce(t,e){var r=(e=e||{}).context;if(!r)throw new Error('Must specify "context" options');var n=e.units||"px",i=e.width,o=e.height;if(void 0===i||void 0===o)throw new Error('Must specify "width" and "height" options');var a=e.lineWidth;return void 0===a&&(a=pt(.03,"cm",n,{roundPixel:!1,pixelsPerInch:90})),r.clearRect(0,0,i,o),r.fillStyle=e.background||"white",r.fillRect(0,0,i,o),r.strokeStyle=e.foreground||e.strokeStyle||"black",r.lineWidth=a,r.lineJoin=e.lineJoin||"miter",r.lineCap=e.lineCap||"butt",he(t,(function(t){r.beginPath(),"string"==typeof t?de(r,t):t.forEach((function(t){r.lineTo(t[0],t[1])})),r.stroke()})),[r.canvas,{data:le(t,e),extension:".svg"}]}function pe(t,e){return ve(t)?"":"string"==typeof t?t:me(t)?t.toString():be(t)?fe(t,e):Array.isArray(t)?t.map((function(t){return pe(t,e)})).reduce((function(t,e){return t.concat(e)}),[]):""}function he(t,e){ve(t)||("string"==typeof t||me(t)?e(t.toString()):be(t)?e(t):Array.isArray(t)&&t.forEach((function(t){return he(t,e)})))}function de(t,e){for(var r=Xt(Mt(zt(e))),n=0;n<r.length;n++){var i=r[n],o=i[0];if("M"===o)t.moveTo(i[1],i[2]);else{if("C"!==o)throw new Error('Illegal type "'+o+'" in SVG commands');t.bezierCurveTo(i[1],i[2],i[3],i[4],i[5],i[6])}}}function fe(t,e){var r=(e=e||{}).units||"px",n=e.viewUnits||r,i=[],o={roundPixel:!1,precision:a(e.precision,5),pixelsPerInch:90};return t.forEach((function(t,e){var a=0===e?"M":"L",s=pt(t[0],r,n,o).toString(),l=pt(t[1],r,n,o).toString();i.push(a+s+" "+l)})),i.join(" ")}function ve(t){return!t||Array.isArray(t)&&0===t.length}function me(t){return"object"==typeof t&&t&&!Array.isArray(t)}function be(t){return!(!t||!Array.isArray(t)||0===t.length)&&(e=t[0],Array.isArray(e)&&e.length>=2&&e.every((function(t){return"number"==typeof t})));var e}oe.createPath=function(t){var e=vt.path();return"function"==typeof t&&t(e),e.lineTo=r(e.lineTo),e.quadraticCurveTo=r(e.quadraticCurveTo),e.bezierCurveTo=r(e.bezierCurveTo),e;function r(t){return function(){var r=Array.prototype.slice.call(arguments);return null==e._x1&&null==e._y1&&e.moveTo(r[0],r[1]),t.apply(e,r)}}},oe.pathsToSVGPaths=ae,oe.pathsToPolylines=se,oe.pathsToSVG=le,oe.renderPaths=ce,oe.convertToSVGPath=pe,oe.eachPath=he,oe.drawSVGPath=de,oe.polylineToSVGPath=fe,oe.polylinesToSVG=function(t,e){if(!Array.isArray(t))throw new Error("Expected array of arrays for polylines");return console.warn("polylinesToSVG is deprecated, use pathsToSVG instead which has the same functionality"),le(t,e)},oe.renderPolylines=function(t,e){if(!Array.isArray(t))throw new Error("Expected array of arrays for polylines");return console.warn("renderPolylines is deprecated, use renderPaths instead which has the same functionality"),ce(t,e)};var ge,we={exports:{}};ge=function(){function t(t,e){this.id=U++,this.type=t,this.data=e}function e(t){return"["+function t(e){if(0===e.length)return[];var r=e.charAt(0),n=e.charAt(e.length-1);if(1<e.length&&r===n&&('"'===r||"'"===r))return['"'+e.substr(1,e.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e))return t(e.substr(0,r.index)).concat(t(r[1])).concat(t(e.substr(r.index+r[0].length)));if(1===(r=e.split(".")).length)return['"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(e=[],n=0;n<r.length;++n)e=e.concat(t(r[n]));return e}(t).join("][")+"]"}function r(t){return"string"==typeof t?t.split():t}function n(t){return"string"==typeof t?document.querySelector(t):t}function i(t,e){for(var r=Array(t),n=0;n<t;++n)r[n]=e(n);return r}function o(t){var e,r;return e=(65535<t)<<4,e|=r=(255<(t>>>=e))<<3,(e|=r=(15<(t>>>=r))<<2)|(r=(3<(t>>>=r))<<1)|t>>>r>>1}function a(){function t(t){t:{for(var e=16;268435456>=e;e*=16)if(t<=e){t=e;break t}t=0}return 0<(e=r[o(t)>>2]).length?e.pop():new ArrayBuffer(t)}function e(t){r[o(t.byteLength)>>2].push(t)}var r=i(8,(function(){return[]}));return{alloc:t,free:e,allocType:function(e,r){var n=null;switch(e){case 5120:n=new Int8Array(t(r),0,r);break;case 5121:n=new Uint8Array(t(r),0,r);break;case 5122:n=new Int16Array(t(2*r),0,r);break;case 5123:n=new Uint16Array(t(2*r),0,r);break;case 5124:n=new Int32Array(t(4*r),0,r);break;case 5125:n=new Uint32Array(t(4*r),0,r);break;case 5126:n=new Float32Array(t(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n},freeType:function(t){e(t.buffer)}}}function s(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||G(t.data))}function l(t,e,r,n,i,o){for(var a=0;a<e;++a)for(var s=t[a],l=0;l<r;++l)for(var u=s[l],c=0;c<n;++c)i[o++]=u[c]}function u(t){return 0|Y[Object.prototype.toString.call(t)]}function c(t,e){for(var r=0;r<e.length;++r)t[r]=e[r]}function p(t,e,r,n,i,o,a){for(var s=0,l=0;l<r;++l)for(var u=0;u<n;++u)t[s++]=e[i*l+o*u+a]}function h(t,e,r,n){function i(e){this.id=h++,this.buffer=t.createBuffer(),this.type=e,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,r.profile&&(this.stats={size:0})}function o(e,r,n){e.byteLength=r.byteLength,t.bufferData(e.type,r,n)}function a(t,e,r,n,i,a){if(t.usage=r,Array.isArray(e)){if(t.dtype=n||5126,0<e.length)if(Array.isArray(e[0])){i=Z(e);for(var l=n=1;l<i.length;++l)n*=i[l];t.dimension=n,o(t,e=J(e,i,t.dtype),r),a?t.persistentData=e:q.freeType(e)}else"number"==typeof e[0]?(t.dimension=i,c(i=q.allocType(t.dtype,e.length),e),o(t,i,r),a?t.persistentData=i:q.freeType(i)):G(e[0])&&(t.dimension=e[0].length,t.dtype=n||u(e[0])||5126,o(t,e=J(e,[e.length,e[0].length],t.dtype),r),a?t.persistentData=e:q.freeType(e))}else if(G(e))t.dtype=n||u(e),t.dimension=i,o(t,e,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(e.buffer)));else if(s(e)){i=e.shape;var h=e.stride,d=(l=e.offset,0),f=0,v=0,m=0;1===i.length?(d=i[0],f=1,v=h[0],m=0):2===i.length&&(d=i[0],f=i[1],v=h[0],m=h[1]),t.dtype=n||u(e.data)||5126,t.dimension=f,p(i=q.allocType(t.dtype,d*f),e.data,d,f,v,m,l),o(t,i,r),a?t.persistentData=i:q.freeType(i)}else e instanceof ArrayBuffer&&(t.dtype=5121,t.dimension=i,o(t,e,r),a&&(t.persistentData=new Uint8Array(new Uint8Array(e))))}function l(r){e.bufferCount--,n(r),t.deleteBuffer(r.buffer),r.buffer=null,delete d[r.id]}var h=0,d={};i.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},i.prototype.destroy=function(){l(this)};var f=[];return r.profile&&(e.getTotalBufferSize=function(){var t=0;return Object.keys(d).forEach((function(e){t+=d[e].stats.size})),t}),{create:function(n,o,h,f){function v(e){var n=35044,i=null,o=0,l=0,u=1;return Array.isArray(e)||G(e)||s(e)||e instanceof ArrayBuffer?i=e:"number"==typeof e?o=0|e:e&&("data"in e&&(i=e.data),"usage"in e&&(n=X[e.usage]),"type"in e&&(l=Q[e.type]),"dimension"in e&&(u=0|e.dimension),"length"in e&&(o=0|e.length)),m.bind(),i?a(m,i,n,l,u,f):(o&&t.bufferData(m.type,o,n),m.dtype=l||5121,m.usage=n,m.dimension=u,m.byteLength=o),r.profile&&(m.stats.size=m.byteLength*tt[m.dtype]),v}e.bufferCount++;var m=new i(o);return d[m.id]=m,h||v(n),v._reglType="buffer",v._buffer=m,v.subdata=function(e,r){var n,i=0|(r||0);if(m.bind(),G(e)||e instanceof ArrayBuffer)t.bufferSubData(m.type,i,e);else if(Array.isArray(e)){if(0<e.length)if("number"==typeof e[0]){var o=q.allocType(m.dtype,e.length);c(o,e),t.bufferSubData(m.type,i,o),q.freeType(o)}else(Array.isArray(e[0])||G(e[0]))&&(n=Z(e),o=J(e,n,m.dtype),t.bufferSubData(m.type,i,o),q.freeType(o))}else if(s(e)){n=e.shape;var a=e.stride,l=o=0,h=0,d=0;1===n.length?(o=n[0],l=1,h=a[0],d=0):2===n.length&&(o=n[0],l=n[1],h=a[0],d=a[1]),n=Array.isArray(e.data)?m.dtype:u(e.data),p(n=q.allocType(n,o*l),e.data,o,l,h,d,e.offset),t.bufferSubData(m.type,i,n),q.freeType(n)}return v},r.profile&&(v.stats=m.stats),v.destroy=function(){l(m)},v},createStream:function(t,e){var r=f.pop();return r||(r=new i(t)),r.bind(),a(r,e,35040,0,1,!1),r},destroyStream:function(t){f.push(t)},clear:function(){$(d).forEach(l),f.forEach(l)},getBuffer:function(t){return t&&t._buffer instanceof i?t._buffer:null},restore:function(){$(d).forEach((function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)}))},_initBuffer:a}}function d(t,e,r,n){function i(t){this.id=u++,l[this.id]=this,this.buffer=t,this.primType=4,this.type=this.vertCount=0}function o(n,i,o,a,l,u,c){var p;if(n.buffer.bind(),i?((p=c)||G(i)&&(!s(i)||G(i.data))||(p=e.oes_element_index_uint?5125:5123),r._initBuffer(n.buffer,i,o,p,3)):(t.bufferData(34963,u,o),n.buffer.dtype=p||5121,n.buffer.usage=o,n.buffer.dimension=3,n.buffer.byteLength=u),p=c,!c){switch(n.buffer.dtype){case 5121:case 5120:p=5121;break;case 5123:case 5122:p=5123;break;case 5125:case 5124:p=5125}n.buffer.dtype=p}n.type=p,0>(i=l)&&(i=n.buffer.byteLength,5123===p?i>>=1:5125===p&&(i>>=2)),n.vertCount=i,i=a,0>a&&(i=4,1===(a=n.buffer.dimension)&&(i=0),2===a&&(i=1),3===a&&(i=4)),n.primType=i}function a(t){n.elementsCount--,delete l[t.id],t.buffer.destroy(),t.buffer=null}var l={},u=0,c={uint8:5121,uint16:5123};e.oes_element_index_uint&&(c.uint32=5125),i.prototype.bind=function(){this.buffer.bind()};var p=[];return{create:function(t,e){function l(t){if(t)if("number"==typeof t)u(t),p.primType=4,p.vertCount=0|t,p.type=5121;else{var e=null,r=35044,n=-1,i=-1,a=0,h=0;Array.isArray(t)||G(t)||s(t)?e=t:("data"in t&&(e=t.data),"usage"in t&&(r=X[t.usage]),"primitive"in t&&(n=et[t.primitive]),"count"in t&&(i=0|t.count),"type"in t&&(h=c[t.type]),"length"in t?a=0|t.length:(a=i,5123===h||5122===h?a*=2:5125!==h&&5124!==h||(a*=4))),o(p,e,r,n,i,a,h)}else u(),p.primType=4,p.vertCount=0,p.type=5121;return l}var u=r.create(null,34963,!0),p=new i(u._buffer);return n.elementsCount++,l(t),l._reglType="elements",l._elements=p,l.subdata=function(t,e){return u.subdata(t,e),l},l.destroy=function(){a(p)},l},createStream:function(t){var e=p.pop();return e||(e=new i(r.create(null,34963,!0,!1)._buffer)),o(e,t,35040,-1,-1,0,0),e},destroyStream:function(t){p.push(t)},getElements:function(t){return"function"==typeof t&&t._elements instanceof i?t._elements:null},clear:function(){$(l).forEach(a)}}}function f(t){for(var e=q.allocType(5123,t.length),r=0;r<t.length;++r)if(isNaN(t[r]))e[r]=65535;else if(1/0===t[r])e[r]=31744;else if(-1/0===t[r])e[r]=64512;else{rt[0]=t[r];var n=(o=nt[0])>>>31<<15,i=(o<<1>>>24)-127,o=o>>13&1023;e[r]=-24>i?n:-14>i?n+(o+1024>>-14-i):15<i?n+31744:n+(i+15<<10)+o}return e}function v(t){return Array.isArray(t)||G(t)}function m(t){return"[object "+t+"]"}function b(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function g(t){return!(!Array.isArray(t)||0===t.length||!v(t[0]))}function w(t){return Object.prototype.toString.call(t)}function y(t){if(!t)return!1;var e=w(t);return 0<=dt.indexOf(e)||b(t)||g(t)||s(t)}function _(t,e){36193===t.type?(t.data=f(e),q.freeType(e)):t.data=e}function x(t,e,r,n,i,o){if(t=void 0!==vt[t]?vt[t]:at[t]*ft[e],o&&(t*=6),i){for(n=0;1<=r;)n+=t*r*r,r/=2;return n}return t*r*n}function C(t,e,r,n,i,o,a){function l(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function u(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function c(t,e){if("object"==typeof e&&e){"premultiplyAlpha"in e&&(t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(t.flipY=e.flipY),"alignment"in e&&(t.unpackAlignment=e.alignment),"colorSpace"in e&&(t.colorSpace=H[e.colorSpace]),"type"in e&&(t.type=K[e.type]);var r=t.width,n=t.height,i=t.channels,o=!1;"shape"in e?(r=e.shape[0],n=e.shape[1],3===e.shape.length&&(i=e.shape[2],o=!0)):("radius"in e&&(r=n=e.radius),"width"in e&&(r=e.width),"height"in e&&(n=e.height),"channels"in e&&(i=e.channels,o=!0)),t.width=0|r,t.height=0|n,t.channels=0|i,r=!1,"format"in e&&(r=e.format,n=t.internalformat=Q[r],t.format=ft[n],r in K&&!("type"in e)&&(t.type=K[r]),r in X&&(t.compressed=!0),r=!0),!o&&r?t.channels=at[t.format]:o&&!r&&t.channels!==ot[t.format]&&(t.format=t.internalformat=ot[t.channels])}}function p(e){t.pixelStorei(37440,e.flipY),t.pixelStorei(37441,e.premultiplyAlpha),t.pixelStorei(37443,e.colorSpace),t.pixelStorei(3317,e.unpackAlignment)}function h(){l.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function d(t,e){var r=null;if(y(e)?r=e:e&&(c(t,e),"x"in e&&(t.xOffset=0|e.x),"y"in e&&(t.yOffset=0|e.y),y(e.data)&&(r=e.data)),e.copy){var n=i.viewportWidth,o=i.viewportHeight;t.width=t.width||n-t.xOffset,t.height=t.height||o-t.yOffset,t.needsCopy=!0}else if(r){if(G(r))t.channels=t.channels||4,t.data=r,"type"in e||5121!==t.type||(t.type=0|Y[Object.prototype.toString.call(r)]);else if(b(r)){switch(t.channels=t.channels||4,o=(n=r).length,t.type){case 5121:case 5123:case 5125:case 5126:(o=q.allocType(t.type,o)).set(n),t.data=o;break;case 36193:t.data=f(n)}t.alignment=1,t.needsFree=!0}else if(s(r)){n=r.data,Array.isArray(n)||5121!==t.type||(t.type=0|Y[Object.prototype.toString.call(n)]),o=r.shape;var a,l,u,p,h=r.stride;3===o.length?(u=o[2],p=h[2]):p=u=1,a=o[0],l=o[1],o=h[0],h=h[1],t.alignment=1,t.width=a,t.height=l,t.channels=u,t.format=t.internalformat=ot[u],t.needsFree=!0,a=p,r=r.offset,u=t.width,p=t.height,l=t.channels;for(var d=q.allocType(36193===t.type?5126:t.type,u*p*l),m=0,x=0;x<p;++x)for(var C=0;C<u;++C)for(var k=0;k<l;++k)d[m++]=n[o*C+h*x+a*k+r];_(t,d)}else if(w(r)===st||w(r)===lt||w(r)===ut)w(r)===st||w(r)===lt?t.element=r:t.element=r.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(w(r)===ct)t.element=r,t.width=r.width,t.height=r.height,t.channels=4;else if(w(r)===pt)t.element=r,t.width=r.naturalWidth,t.height=r.naturalHeight,t.channels=4;else if(w(r)===ht)t.element=r,t.width=r.videoWidth,t.height=r.videoHeight,t.channels=4;else if(g(r)){for(n=t.width||r[0].length,o=t.height||r.length,h=t.channels,h=v(r[0][0])?h||r[0][0].length:h||1,a=W.shape(r),u=1,p=0;p<a.length;++p)u*=a[p];u=q.allocType(36193===t.type?5126:t.type,u),W.flatten(r,a,"",u),_(t,u),t.alignment=1,t.width=n,t.height=o,t.channels=h,t.format=t.internalformat=ot[h],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4}function m(e,r,i,o,a){var s=e.element,l=e.data,u=e.internalformat,c=e.format,h=e.type,d=e.width,f=e.height;p(e),s?t.texSubImage2D(r,a,i,o,c,h,s):e.compressed?t.compressedTexSubImage2D(r,a,i,o,u,d,f,l):e.needsCopy?(n(),t.copyTexSubImage2D(r,a,i,o,e.xOffset,e.yOffset,d,f)):t.texSubImage2D(r,a,i,o,d,f,c,h,l)}function C(){return vt.pop()||new h}function k(t){t.needsFree&&q.freeType(t.data),h.call(t),vt.push(t)}function E(){l.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function P(t,e,r){var n=t.images[0]=C();t.mipmask=1,n.width=t.width=e,n.height=t.height=r,n.channels=t.channels=4}function A(t,e){var r=null;if(y(e))u(r=t.images[0]=C(),t),d(r,e),t.mipmask=1;else if(c(t,e),Array.isArray(e.mipmap))for(var n=e.mipmap,i=0;i<n.length;++i)u(r=t.images[i]=C(),t),r.width>>=i,r.height>>=i,d(r,n[i]),t.mipmask|=1<<i;else u(r=t.images[0]=C(),t),d(r,e),t.mipmask=1;u(t,t.images[0])}function M(e,r){for(var i=e.images,o=0;o<i.length&&i[o];++o){var a=i[o],s=r,l=o,u=a.element,c=a.data,h=a.internalformat,d=a.format,f=a.type,v=a.width,m=a.height;p(a),u?t.texImage2D(s,l,d,d,f,u):a.compressed?t.compressedTexImage2D(s,l,h,v,m,0,c):a.needsCopy?(n(),t.copyTexImage2D(s,l,d,a.xOffset,a.yOffset,v,m,0)):t.texImage2D(s,l,d,v,m,0,d,f,c||null)}}function V(){var t=mt.pop()||new E;l.call(t);for(var e=t.mipmask=0;16>e;++e)t.images[e]=null;return t}function S(t){for(var e=t.images,r=0;r<e.length;++r)e[r]&&k(e[r]),e[r]=null;mt.push(t)}function D(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function T(t,e){"min"in e&&(t.minFilter=N[e.min],0<=it.indexOf(t.minFilter)&&!("faces"in e)&&(t.genMipmaps=!0)),"mag"in e&&(t.magFilter=z[e.mag]);var r=t.wrapS,n=t.wrapT;if("wrap"in e){var i=e.wrap;"string"==typeof i?r=n=U[i]:Array.isArray(i)&&(r=U[i[0]],n=U[i[1]])}else"wrapS"in e&&(r=U[e.wrapS]),"wrapT"in e&&(n=U[e.wrapT]);if(t.wrapS=r,t.wrapT=n,"anisotropic"in e&&(t.anisotropic=e.anisotropic),"mipmap"in e){switch(r=!1,typeof e.mipmap){case"string":t.mipmapHint=R[e.mipmap],r=t.genMipmaps=!0;break;case"boolean":r=t.genMipmaps=e.mipmap;break;case"object":t.genMipmaps=!1,r=!0}!r||"min"in e||(t.minFilter=9984)}}function L(r,n){t.texParameteri(n,10241,r.minFilter),t.texParameteri(n,10240,r.magFilter),t.texParameteri(n,10242,r.wrapS),t.texParameteri(n,10243,r.wrapT),e.ext_texture_filter_anisotropic&&t.texParameteri(n,34046,r.anisotropic),r.genMipmaps&&(t.hint(33170,r.mipmapHint),t.generateMipmap(n))}function O(e){l.call(this),this.mipmask=0,this.internalformat=6408,this.id=bt++,this.refCount=1,this.target=e,this.texture=t.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new D,a.profile&&(this.stats={size:0})}function j(e){t.activeTexture(33984),t.bindTexture(e.target,e.texture)}function B(){var e=yt[0];e?t.bindTexture(e.target,e.texture):t.bindTexture(3553,null)}function I(e){var r=e.texture,n=e.unit,i=e.target;0<=n&&(t.activeTexture(33984+n),t.bindTexture(i,null),yt[n]=null),t.deleteTexture(r),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete gt[e.id],o.textureCount--}var R={"don't care":4352,"dont care":4352,nice:4354,fast:4353},U={repeat:10497,clamp:33071,mirror:33648},z={nearest:9728,linear:9729},N=F({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},z),H={none:0,browser:37444},K={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Q={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},X={};e.ext_srgb&&(Q.srgb=35904,Q.srgba=35906),e.oes_texture_float&&(K.float32=K.float=5126),e.oes_texture_half_float&&(K.float16=K["half float"]=36193),e.webgl_depth_texture&&(F(Q,{depth:6402,"depth stencil":34041}),F(K,{uint16:5123,uint32:5125,"depth stencil":34042})),e.webgl_compressed_texture_s3tc&&F(X,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),e.webgl_compressed_texture_atc&&F(X,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),e.webgl_compressed_texture_pvrtc&&F(X,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),e.webgl_compressed_texture_etc1&&(X["rgb etc1"]=36196);var J=Array.prototype.slice.call(t.getParameter(34467));Object.keys(X).forEach((function(t){var e=X[t];0<=J.indexOf(e)&&(Q[t]=e)}));var Z=Object.keys(Q);r.textureFormats=Z;var tt=[];Object.keys(Q).forEach((function(t){tt[Q[t]]=t}));var et=[];Object.keys(K).forEach((function(t){et[K[t]]=t}));var rt=[];Object.keys(z).forEach((function(t){rt[z[t]]=t}));var nt=[];Object.keys(N).forEach((function(t){nt[N[t]]=t}));var dt=[];Object.keys(U).forEach((function(t){dt[U[t]]=t}));var ft=Z.reduce((function(t,r){var n=Q[r];return 6409===n||6406===n||6409===n||6410===n||6402===n||34041===n||e.ext_srgb&&(35904===n||35906===n)?t[n]=n:32855===n||0<=r.indexOf("rgba")?t[n]=6408:t[n]=6407,t}),{}),vt=[],mt=[],bt=0,gt={},wt=r.maxTextureUnits,yt=Array(wt).map((function(){return null}));return F(O.prototype,{bind:function(){this.bindCount+=1;var e=this.unit;if(0>e){for(var r=0;r<wt;++r){var n=yt[r];if(n){if(0<n.bindCount)continue;n.unit=-1}yt[r]=this,e=r;break}a.profile&&o.maxTextureUnits<e+1&&(o.maxTextureUnits=e+1),this.unit=e,t.activeTexture(33984+e),t.bindTexture(this.target,this.texture)}return e},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&I(this)}}),a.profile&&(o.getTotalTextureSize=function(){var t=0;return Object.keys(gt).forEach((function(e){t+=gt[e].stats.size})),t}),{create2D:function(e,r){function n(t,e){var r=i.texInfo;D.call(r);var o=V();return"number"==typeof t?P(o,0|t,"number"==typeof e?0|e:0|t):t?(T(r,t),A(o,t)):P(o,1,1),r.genMipmaps&&(o.mipmask=(o.width<<1)-1),i.mipmask=o.mipmask,u(i,o),i.internalformat=o.internalformat,n.width=o.width,n.height=o.height,j(i),M(o,3553),L(r,3553),B(),S(o),a.profile&&(i.stats.size=x(i.internalformat,i.type,o.width,o.height,r.genMipmaps,!1)),n.format=tt[i.internalformat],n.type=et[i.type],n.mag=rt[r.magFilter],n.min=nt[r.minFilter],n.wrapS=dt[r.wrapS],n.wrapT=dt[r.wrapT],n}var i=new O(3553);return gt[i.id]=i,o.textureCount++,n(e,r),n.subimage=function(t,e,r,o){e|=0,r|=0,o|=0;var a=C();return u(a,i),a.width=0,a.height=0,d(a,t),a.width=a.width||(i.width>>o)-e,a.height=a.height||(i.height>>o)-r,j(i),m(a,3553,e,r,o),B(),k(a),n},n.resize=function(e,r){var o=0|e,s=0|r||o;if(o===i.width&&s===i.height)return n;n.width=i.width=o,n.height=i.height=s,j(i);for(var l=0;i.mipmask>>l;++l){var u=o>>l,c=s>>l;if(!u||!c)break;t.texImage2D(3553,l,i.format,u,c,0,i.format,i.type,null)}return B(),a.profile&&(i.stats.size=x(i.internalformat,i.type,o,s,!1,!1)),n},n._reglType="texture2d",n._texture=i,a.profile&&(n.stats=i.stats),n.destroy=function(){i.decRef()},n},createCube:function(e,r,n,i,s,l){function p(t,e,r,n,i,o){var s,l=h.texInfo;for(D.call(l),s=0;6>s;++s)f[s]=V();if("number"!=typeof t&&t){if("object"==typeof t)if(e)A(f[0],t),A(f[1],e),A(f[2],r),A(f[3],n),A(f[4],i),A(f[5],o);else if(T(l,t),c(h,t),"faces"in t)for(t=t.faces,s=0;6>s;++s)u(f[s],h),A(f[s],t[s]);else for(s=0;6>s;++s)A(f[s],t)}else for(t=0|t||1,s=0;6>s;++s)P(f[s],t,t);for(u(h,f[0]),h.mipmask=l.genMipmaps?(f[0].width<<1)-1:f[0].mipmask,h.internalformat=f[0].internalformat,p.width=f[0].width,p.height=f[0].height,j(h),s=0;6>s;++s)M(f[s],34069+s);for(L(l,34067),B(),a.profile&&(h.stats.size=x(h.internalformat,h.type,p.width,p.height,l.genMipmaps,!0)),p.format=tt[h.internalformat],p.type=et[h.type],p.mag=rt[l.magFilter],p.min=nt[l.minFilter],p.wrapS=dt[l.wrapS],p.wrapT=dt[l.wrapT],s=0;6>s;++s)S(f[s]);return p}var h=new O(34067);gt[h.id]=h,o.cubeCount++;var f=Array(6);return p(e,r,n,i,s,l),p.subimage=function(t,e,r,n,i){r|=0,n|=0,i|=0;var o=C();return u(o,h),o.width=0,o.height=0,d(o,e),o.width=o.width||(h.width>>i)-r,o.height=o.height||(h.height>>i)-n,j(h),m(o,34069+t,r,n,i),B(),k(o),p},p.resize=function(e){if((e|=0)!==h.width){p.width=h.width=e,p.height=h.height=e,j(h);for(var r=0;6>r;++r)for(var n=0;h.mipmask>>n;++n)t.texImage2D(34069+r,n,h.format,e>>n,e>>n,0,h.format,h.type,null);return B(),a.profile&&(h.stats.size=x(h.internalformat,h.type,p.width,p.height,!1,!0)),p}},p._reglType="textureCube",p._texture=h,a.profile&&(p.stats=h.stats),p.destroy=function(){h.decRef()},p},clear:function(){for(var e=0;e<wt;++e)t.activeTexture(33984+e),t.bindTexture(3553,null),yt[e]=null;$(gt).forEach(I),o.cubeCount=0,o.textureCount=0},getTexture:function(t){return null},restore:function(){for(var e=0;e<wt;++e){var r=yt[e];r&&(r.bindCount=0,r.unit=-1,yt[e]=null)}$(gt).forEach((function(e){e.texture=t.createTexture(),t.bindTexture(e.target,e.texture);for(var r=0;32>r;++r)if(0!=(e.mipmask&1<<r))if(3553===e.target)t.texImage2D(3553,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);else for(var n=0;6>n;++n)t.texImage2D(34069+n,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);L(e.texInfo,e.target)}))},refresh:function(){for(var e=0;e<wt;++e){var r=yt[e];r&&(r.bindCount=0,r.unit=-1,yt[e]=null),t.activeTexture(33984+e),t.bindTexture(3553,null),t.bindTexture(34067,null)}}}}function k(t,e,r,n,i,o){function a(t,e,r){this.target=t,this.texture=e,this.renderbuffer=r;var n=t=0;e?(t=e.width,n=e.height):r&&(t=r.width,n=r.height),this.width=t,this.height=n}function s(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function l(t,e,r){t&&(t.texture?t.texture._texture.refCount+=1:t.renderbuffer._renderbuffer.refCount+=1)}function u(e,r){r&&(r.texture?t.framebufferTexture2D(36160,e,r.target,r.texture._texture.texture,0):t.framebufferRenderbuffer(36160,e,36161,r.renderbuffer._renderbuffer.renderbuffer))}function c(t){var e=3553,r=null,n=null,i=t;return"object"==typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),"texture2d"===(t=i._reglType)||"textureCube"===t?r=i:"renderbuffer"===t&&(n=i,e=36161),new a(e,r,n)}function p(t,e,r,o,s){return r?((t=n.create2D({width:t,height:e,format:o,type:s}))._texture.refCount=0,new a(3553,t,null)):((t=i.create({width:t,height:e,format:o}))._renderbuffer.refCount=0,new a(36161,null,t))}function h(t){return t&&(t.texture||t.renderbuffer)}function d(t,e,r){t&&(t.texture?t.texture.resize(e,r):t.renderbuffer&&t.renderbuffer.resize(e,r),t.width=e,t.height=r)}function f(){this.id=C++,k[this.id]=this,this.framebuffer=t.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(t){t.colorAttachments.forEach(s),s(t.depthAttachment),s(t.stencilAttachment),s(t.depthStencilAttachment)}function m(e){t.deleteFramebuffer(e.framebuffer),e.framebuffer=null,o.framebufferCount--,delete k[e.id]}function b(e){var n;t.bindFramebuffer(36160,e.framebuffer);var i=e.colorAttachments;for(n=0;n<i.length;++n)u(36064+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)t.framebufferTexture2D(36160,36064+n,3553,null,0);t.framebufferTexture2D(36160,33306,3553,null,0),t.framebufferTexture2D(36160,36096,3553,null,0),t.framebufferTexture2D(36160,36128,3553,null,0),u(36096,e.depthAttachment),u(36128,e.stencilAttachment),u(33306,e.depthStencilAttachment),t.checkFramebufferStatus(36160),t.isContextLost(),t.bindFramebuffer(36160,w.next?w.next.framebuffer:null),w.cur=w.next,t.getError()}function g(t,e){function r(t,e){var i,o=0,a=0,s=!0,u=!0;i=null;var d=!0,f="rgba",m="uint8",g=1,w=null,x=null,C=null,k=!1;"number"==typeof t?(o=0|t,a=0|e||o):t?("shape"in t?(o=(a=t.shape)[0],a=a[1]):("radius"in t&&(o=a=t.radius),"width"in t&&(o=t.width),"height"in t&&(a=t.height)),("color"in t||"colors"in t)&&(i=t.color||t.colors,Array.isArray(i)),i||("colorCount"in t&&(g=0|t.colorCount),"colorTexture"in t&&(d=!!t.colorTexture,f="rgba4"),"colorType"in t&&(m=t.colorType,!d)&&("half float"===m||"float16"===m?f="rgba16f":"float"!==m&&"float32"!==m||(f="rgba32f")),"colorFormat"in t&&(f=t.colorFormat,0<=y.indexOf(f)?d=!0:0<=_.indexOf(f)&&(d=!1))),("depthTexture"in t||"depthStencilTexture"in t)&&(k=!(!t.depthTexture&&!t.depthStencilTexture)),"depth"in t&&("boolean"==typeof t.depth?s=t.depth:(w=t.depth,u=!1)),"stencil"in t&&("boolean"==typeof t.stencil?u=t.stencil:(x=t.stencil,s=!1)),"depthStencil"in t&&("boolean"==typeof t.depthStencil?s=u=t.depthStencil:(C=t.depthStencil,u=s=!1))):o=a=1;var E=null,P=null,A=null,M=null;if(Array.isArray(i))E=i.map(c);else if(i)E=[c(i)];else for(E=Array(g),i=0;i<g;++i)E[i]=p(o,a,d,f,m);for(o=o||E[0].width,a=a||E[0].height,w?P=c(w):s&&!u&&(P=p(o,a,k,"depth","uint32")),x?A=c(x):u&&!s&&(A=p(o,a,!1,"stencil","uint8")),C?M=c(C):!w&&!x&&u&&s&&(M=p(o,a,k,"depth stencil","depth stencil")),s=null,i=0;i<E.length;++i)l(E[i]),E[i]&&E[i].texture&&(u=gt[E[i].texture._texture.format]*wt[E[i].texture._texture.type],null===s&&(s=u));return l(P),l(A),l(M),v(n),n.width=o,n.height=a,n.colorAttachments=E,n.depthAttachment=P,n.stencilAttachment=A,n.depthStencilAttachment=M,r.color=E.map(h),r.depth=h(P),r.stencil=h(A),r.depthStencil=h(M),r.width=n.width,r.height=n.height,b(n),r}var n=new f;return o.framebufferCount++,r(t,e),F(r,{resize:function(t,e){var i=Math.max(0|t,1),o=Math.max(0|e||i,1);if(i===n.width&&o===n.height)return r;for(var a=n.colorAttachments,s=0;s<a.length;++s)d(a[s],i,o);return d(n.depthAttachment,i,o),d(n.stencilAttachment,i,o),d(n.depthStencilAttachment,i,o),n.width=r.width=i,n.height=r.height=o,b(n),r},_reglType:"framebuffer",_framebuffer:n,destroy:function(){m(n),v(n)},use:function(t){w.setFBO({framebuffer:r},t)}})}var w={cur:null,next:null,dirty:!1,setFBO:null},y=["rgba"],_=["rgba4","rgb565","rgb5 a1"];e.ext_srgb&&_.push("srgba"),e.ext_color_buffer_half_float&&_.push("rgba16f","rgb16f"),e.webgl_color_buffer_float&&_.push("rgba32f");var x=["uint8"];e.oes_texture_half_float&&x.push("half float","float16"),e.oes_texture_float&&x.push("float","float32");var C=0,k={};return F(w,{getFramebuffer:function(t){return"function"==typeof t&&"framebuffer"===t._reglType&&(t=t._framebuffer)instanceof f?t:null},create:g,createCube:function(t){function e(t){var i,o={color:null},a=0,s=null;i="rgba";var l="uint8",u=1;if("number"==typeof t?a=0|t:t?("shape"in t?a=t.shape[0]:("radius"in t&&(a=0|t.radius),"width"in t?a=0|t.width:"height"in t&&(a=0|t.height)),("color"in t||"colors"in t)&&(s=t.color||t.colors,Array.isArray(s)),s||("colorCount"in t&&(u=0|t.colorCount),"colorType"in t&&(l=t.colorType),"colorFormat"in t&&(i=t.colorFormat)),"depth"in t&&(o.depth=t.depth),"stencil"in t&&(o.stencil=t.stencil),"depthStencil"in t&&(o.depthStencil=t.depthStencil)):a=1,s)if(Array.isArray(s))for(t=[],i=0;i<s.length;++i)t[i]=s[i];else t=[s];else for(t=Array(u),s={radius:a,format:i,type:l},i=0;i<u;++i)t[i]=n.createCube(s);for(o.color=Array(t.length),i=0;i<t.length;++i)u=t[i],a=a||u.width,o.color[i]={target:34069,data:t[i]};for(i=0;6>i;++i){for(u=0;u<t.length;++u)o.color[u].target=34069+i;0<i&&(o.depth=r[0].depth,o.stencil=r[0].stencil,o.depthStencil=r[0].depthStencil),r[i]?r[i](o):r[i]=g(o)}return F(e,{width:a,height:a,color:t})}var r=Array(6);return e(t),F(e,{faces:r,resize:function(t){var n=0|t;if(n===e.width)return e;var i=e.color;for(t=0;t<i.length;++t)i[t].resize(n);for(t=0;6>t;++t)r[t].resize(n);return e.width=e.height=n,e},_reglType:"framebufferCube",destroy:function(){r.forEach((function(t){t.destroy()}))}})},clear:function(){$(k).forEach(m)},restore:function(){w.cur=null,w.next=null,w.dirty=!0,$(k).forEach((function(e){e.framebuffer=t.createFramebuffer(),b(e)}))}})}function E(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function P(t,e,r,n,i){function o(){this.id=++u,this.attributes=[];var t=e.oes_vertex_array_object;this.vao=t?t.createVertexArrayOES():null,c[this.id]=this,this.buffers=[]}var a=r.maxAttributes,l=Array(a);for(r=0;r<a;++r)l[r]=new E;var u=0,c={},p={Record:E,scope:{},state:l,currentVAO:null,targetVAO:null,restore:e.oes_vertex_array_object?function(){e.oes_vertex_array_object&&$(c).forEach((function(t){t.refresh()}))}:function(){},createVAO:function(t){function e(t){var n={},o=r.attributes;o.length=t.length;for(var a=0;a<t.length;++a){var l,u=t[a],c=o[a]=new E,p=u.data||u;Array.isArray(p)||G(p)||s(p)?(r.buffers[a]&&(l=r.buffers[a],G(p)&&l._buffer.byteLength>=p.byteLength?l.subdata(p):(l.destroy(),r.buffers[a]=null)),r.buffers[a]||(l=r.buffers[a]=i.create(u,34962,!1,!0)),c.buffer=i.getBuffer(l),c.size=0|c.buffer.dimension,c.normalized=!1,c.type=c.buffer.dtype,c.offset=0,c.stride=0,c.divisor=0,c.state=1,n[a]=1):i.getBuffer(u)?(c.buffer=i.getBuffer(u),c.size=0|c.buffer.dimension,c.normalized=!1,c.type=c.buffer.dtype,c.offset=0,c.stride=0,c.divisor=0,c.state=1):i.getBuffer(u.buffer)?(c.buffer=i.getBuffer(u.buffer),c.size=0|(+u.size||c.buffer.dimension),c.normalized=!!u.normalized||!1,c.type="type"in u?Q[u.type]:c.buffer.dtype,c.offset=0|(u.offset||0),c.stride=0|(u.stride||0),c.divisor=0|(u.divisor||0),c.state=1):"x"in u&&(c.x=+u.x||0,c.y=+u.y||0,c.z=+u.z||0,c.w=+u.w||0,c.state=2)}for(t=0;t<r.buffers.length;++t)!n[t]&&r.buffers[t]&&(r.buffers[t].destroy(),r.buffers[t]=null);return r.refresh(),e}var r=new o;return n.vaoCount+=1,e.destroy=function(){for(var t=0;t<r.buffers.length;++t)r.buffers[t]&&r.buffers[t].destroy();r.buffers.length=0,r.destroy()},e._vao=r,e._reglType="vao",e(t)},getVAO:function(t){return"function"==typeof t&&t._vao?t._vao:null},destroyBuffer:function(e){for(var r=0;r<l.length;++r){var n=l[r];n.buffer===e&&(t.disableVertexAttribArray(r),n.buffer=null)}},setVAO:e.oes_vertex_array_object?function(t){if(t!==p.currentVAO){var r=e.oes_vertex_array_object;t?r.bindVertexArrayOES(t.vao):r.bindVertexArrayOES(null),p.currentVAO=t}}:function(r){if(r!==p.currentVAO){if(r)r.bindAttrs();else for(var n=e.angle_instanced_arrays,i=0;i<l.length;++i){var o=l[i];o.buffer?(t.enableVertexAttribArray(i),t.vertexAttribPointer(i,o.size,o.type,o.normalized,o.stride,o.offfset),n&&o.divisor&&n.vertexAttribDivisorANGLE(i,o.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,o.x,o.y,o.z,o.w))}p.currentVAO=r}},clear:e.oes_vertex_array_object?function(){$(c).forEach((function(t){t.destroy()}))}:function(){}};return o.prototype.bindAttrs=function(){for(var r=e.angle_instanced_arrays,n=this.attributes,i=0;i<n.length;++i){var o=n[i];o.buffer?(t.enableVertexAttribArray(i),t.bindBuffer(34962,o.buffer.buffer),t.vertexAttribPointer(i,o.size,o.type,o.normalized,o.stride,o.offset),r&&o.divisor&&r.vertexAttribDivisorANGLE(i,o.divisor)):(t.disableVertexAttribArray(i),t.vertexAttrib4f(i,o.x,o.y,o.z,o.w))}for(r=n.length;r<a;++r)t.disableVertexAttribArray(r)},o.prototype.refresh=function(){var t=e.oes_vertex_array_object;t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),p.currentVAO=this)},o.prototype.destroy=function(){if(this.vao){var t=e.oes_vertex_array_object;this===p.currentVAO&&(p.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}c[this.id]&&(delete c[this.id],--n.vaoCount)},p}function A(t,e,r,n){function i(t,e,r,n){this.name=t,this.id=e,this.location=r,this.info=n}function o(t,e){for(var r=0;r<t.length;++r)if(t[r].id===e.id)return void(t[r].location=e.location);t.push(e)}function a(r,n,i){if(!(a=(i=35632===r?u:c)[n])){var o=e.str(n),a=t.createShader(r);t.shaderSource(a,o),t.compileShader(a),i[n]=a}return a}function s(t,e){this.id=d++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,n.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function l(r,s,l){var u;u=a(35632,r.fragId);var c=a(35633,r.vertId);if(s=r.program=t.createProgram(),t.attachShader(s,u),t.attachShader(s,c),l)for(u=0;u<l.length;++u)c=l[u],t.bindAttribLocation(s,c[0],c[1]);t.linkProgram(s),c=t.getProgramParameter(s,35718),n.profile&&(r.stats.uniformsCount=c);var p=r.uniforms;for(u=0;u<c;++u)if(l=t.getActiveUniform(s,u))if(1<l.size)for(var h=0;h<l.size;++h){var d=l.name.replace("[0]","["+h+"]");o(p,new i(d,e.id(d),t.getUniformLocation(s,d),l))}else o(p,new i(l.name,e.id(l.name),t.getUniformLocation(s,l.name),l));for(c=t.getProgramParameter(s,35721),n.profile&&(r.stats.attributesCount=c),r=r.attributes,u=0;u<c;++u)(l=t.getActiveAttrib(s,u))&&o(r,new i(l.name,e.id(l.name),t.getAttribLocation(s,l.name),l))}var u={},c={},p={},h=[],d=0;return n.profile&&(r.getMaxUniformsCount=function(){var t=0;return h.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},r.getMaxAttributesCount=function(){var t=0;return h.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);$(u).forEach(e),u={},$(c).forEach(e),c={},h.forEach((function(e){t.deleteProgram(e.program)})),h.length=0,p={},r.shaderCount=0},program:function(e,n,i,o){var a=p[n];a||(a=p[n]={});var d=a[e];if(d&&(d.refCount++,!o))return d;var f=new s(n,e);return r.shaderCount++,l(f,i,o),d||(a[e]=f),h.push(f),F(f,{destroy:function(){if(f.refCount--,0>=f.refCount){t.deleteProgram(f.program);var e=h.indexOf(f);h.splice(e,1),r.shaderCount--}0>=a[f.vertId].refCount&&(t.deleteShader(c[f.vertId]),delete c[f.vertId],delete p[f.fragId][f.vertId]),Object.keys(p[f.fragId]).length||(t.deleteShader(u[f.fragId]),delete u[f.fragId],delete p[f.fragId])}})},restore:function(){u={},c={};for(var t=0;t<h.length;++t)l(h[t],null,h[t].attributes.map((function(t){return[t.location,t.name]})))},shader:a,frag:-1,vert:-1}}function M(t,e,r,n,i,o,a){function s(i){var o;o=null===e.next?5121:e.next.colorAttachments[0].texture._texture.type;var a=0,s=0,l=n.framebufferWidth,u=n.framebufferHeight,c=null;return G(i)?c=i:i&&(a=0|i.x,s=0|i.y,l=0|(i.width||n.framebufferWidth-a),u=0|(i.height||n.framebufferHeight-s),c=i.data||null),r(),i=l*u*4,c||(5121===o?c=new Uint8Array(i):5126===o&&(c=c||new Float32Array(i))),t.pixelStorei(3333,4),t.readPixels(a,s,l,u,6408,o,c),c}return function(t){return t&&"framebuffer"in t?function(t){var r;return e.setFBO({framebuffer:t.framebuffer},(function(){r=s(t)})),r}(t):s(t)}}function V(t){return Array.prototype.slice.call(t)}function S(t){return V(t).join("")}function D(t){return Array.isArray(t)||G(t)||s(t)}function T(t){return t.sort((function(t,e){return"viewport"===t?-1:"viewport"===e?1:t<e?-1:1}))}function L(t,e,r,n){this.thisDep=t,this.contextDep=e,this.propDep=r,this.append=n}function O(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function j(t){return new L(!1,!1,!1,t)}function B(t,e){var r=t.type;if(0===r)return new L(!0,1<=(r=t.data.length),2<=r,e);if(4===r)return new L((r=t.data).thisDep,r.contextDep,r.propDep,e);if(5===r)return new L(!1,!1,!1,e);if(6===r){for(var n=r=!1,i=!1,o=0;o<t.data.length;++o){var a=t.data[o];1===a.type?i=!0:2===a.type?n=!0:3===a.type?r=!0:0===a.type?(r=!0,1<=(a=a.data)&&(n=!0),2<=a&&(i=!0)):4===a.type&&(r=r||a.data.thisDep,n=n||a.data.contextDep,i=i||a.data.propDep)}return new L(r,n,i,e)}return new L(3===r,2===r,1===r,e)}function I(t,e,r,n,o,a,s,l,u,c,p,h,d,f,m){function b(t){return t.replace(".","_")}function g(t,e,r){var n=b(t);ot.push(t),it[n]=nt[n]=!!r,at[n]=e}function w(t,e,r){var n=b(t);ot.push(t),Array.isArray(r)?(nt[n]=r.slice(),it[n]=r.slice()):nt[n]=it[n]=r,st[n]=e}function y(){var t=function(){function t(){var t=[],e=[];return F((function(){t.push.apply(t,V(arguments))}),{def:function(){var n="v"+r++;return e.push(n),0<arguments.length&&(t.push(n,"="),t.push.apply(t,V(arguments)),t.push(";")),n},toString:function(){return S([0<e.length?"var "+e.join(",")+";":"",S(t)])}})}function e(){function e(t,e){n(t,e,"=",r.def(t,e),";")}var r=t(),n=t(),i=r.toString,o=n.toString;return F((function(){r.apply(r,V(arguments))}),{def:r.def,entry:r,exit:n,save:e,set:function(t,n,i){e(t,n),r(t,n,"=",i,";")},toString:function(){return i()+o()}})}var r=0,n=[],i=[],o=t(),a={};return{global:o,link:function(t){for(var e=0;e<i.length;++e)if(i[e]===t)return n[e];return e="g"+r++,n.push(e),i.push(t),e},block:t,proc:function(t,r){function n(){var t="a"+i.length;return i.push(t),t}var i=[];r=r||0;for(var o=0;o<r;++o)n();var s=(o=e()).toString;return a[t]=F(o,{arg:n,toString:function(){return S(["function(",i.join(),"){",s(),"}"])}})},scope:e,cond:function(){var t=S(arguments),r=e(),n=e(),i=r.toString,o=n.toString;return F(r,{then:function(){return r.apply(r,V(arguments)),this},else:function(){return n.apply(n,V(arguments)),this},toString:function(){var e=o();return e&&(e="else{"+e+"}"),S(["if(",t,"){",i(),"}",e])}})},compile:function(){var t=['"use strict";',o,"return {"];Object.keys(a).forEach((function(e){t.push('"',e,'":',a[e].toString(),",")})),t.push("}");var e=S(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,i)}}}(),r=t.link,n=t.global;t.id=ct++,t.batchId="0";var i=r(lt),o=t.shared={props:"a0"};Object.keys(lt).forEach((function(t){o[t]=n.def(i,".",t)}));var a=t.next={},s=t.current={};Object.keys(st).forEach((function(t){Array.isArray(nt[t])&&(a[t]=n.def(o.next,".",t),s[t]=n.def(o.current,".",t))}));var l=t.constants={};Object.keys(ut).forEach((function(t){l[t]=n.def(JSON.stringify(ut[t]))})),t.invoke=function(e,n){switch(n.type){case 0:var i=["this",o.context,o.props,t.batchId];return e.def(r(n.data),".call(",i.slice(0,Math.max(n.data.length+1,4)),")");case 1:return e.def(o.props,n.data);case 2:return e.def(o.context,n.data);case 3:return e.def("this",n.data);case 4:return n.data.append(t,e),n.data.ref;case 5:return n.data.toString();case 6:return n.data.map((function(r){return t.invoke(e,r)}))}},t.attribCache={};var u={};return t.scopeAttrib=function(t){if((t=e.id(t))in u)return u[t];var n=c.scope[t];return n||(n=c.scope[t]=new J),u[t]=r(n)},t}function _(t,e){var r=t.static,n=t.dynamic;if("framebuffer"in r){var i=r.framebuffer;return i?(i=l.getFramebuffer(i),j((function(t,e){var r=t.link(i),n=t.shared;return e.set(n.framebuffer,".next",r),n=n.context,e.set(n,".framebufferWidth",r+".width"),e.set(n,".framebufferHeight",r+".height"),r}))):j((function(t,e){var r=t.shared;return e.set(r.framebuffer,".next","null"),r=r.context,e.set(r,".framebufferWidth",r+".drawingBufferWidth"),e.set(r,".framebufferHeight",r+".drawingBufferHeight"),"null"}))}if("framebuffer"in n){var o=n.framebuffer;return B(o,(function(t,e){var r=t.invoke(e,o),n=t.shared,i=n.framebuffer;return r=e.def(i,".getFramebuffer(",r,")"),e.set(i,".next",r),n=n.context,e.set(n,".framebufferWidth",r+"?"+r+".width:"+n+".drawingBufferWidth"),e.set(n,".framebufferHeight",r+"?"+r+".height:"+n+".drawingBufferHeight"),r}))}return null}function x(t,r,n){function i(t){if(t in o){var r=e.id(o[t]);return(t=j((function(){return r}))).id=r,t}if(t in a){var n=a[t];return B(n,(function(t,e){var r=t.invoke(e,n);return e.def(t.shared.strings,".id(",r,")")}))}return null}var o=t.static,a=t.dynamic,s=i("frag"),l=i("vert"),u=null;return O(s)&&O(l)?(u=p.program(l.id,s.id,null,n),t=j((function(t,e){return t.link(u)}))):t=new L(s&&s.thisDep||l&&l.thisDep,s&&s.contextDep||l&&l.contextDep,s&&s.propDep||l&&l.propDep,(function(t,e){var r,n,i=t.shared.shader;return r=s?s.append(t,e):e.def(i,".","frag"),n=l?l.append(t,e):e.def(i,".","vert"),e.def(i+".program("+n+","+r+")")})),{frag:s,vert:l,progVar:t,program:u}}function C(t,e){function r(t,e){if(t in n){var r=0|n[t];return j((function(t,n){return e&&(t.OFFSET=r),r}))}if(t in i){var a=i[t];return B(a,(function(t,r){var n=t.invoke(r,a);return e&&(t.OFFSET=n),n}))}return e&&o?j((function(t,e){return t.OFFSET="0",0})):null}var n=t.static,i=t.dynamic,o=function(){if("elements"in n){var t=n.elements;D(t)?t=a.getElements(a.create(t,!0)):t&&(t=a.getElements(t));var e=j((function(e,r){if(t){var n=e.link(t);return e.ELEMENTS=n}return e.ELEMENTS=null}));return e.value=t,e}if("elements"in i){var r=i.elements;return B(r,(function(t,e){var n=(i=t.shared).isBufferArgs,i=i.elements,o=t.invoke(e,r),a=e.def("null");return n=e.def(n,"(",o,")"),o=t.cond(n).then(a,"=",i,".createStream(",o,");").else(a,"=",i,".getElements(",o,");"),e.entry(o),e.exit(t.cond(n).then(i,".destroyStream(",a,");")),t.ELEMENTS=a}))}return null}(),s=r("offset",!0);return{elements:o,primitive:function(){if("primitive"in n){var t=n.primitive;return j((function(e,r){return et[t]}))}if("primitive"in i){var e=i.primitive;return B(e,(function(t,r){var n=t.constants.primTypes,i=t.invoke(r,e);return r.def(n,"[",i,"]")}))}return o?O(o)?o.value?j((function(t,e){return e.def(t.ELEMENTS,".primType")})):j((function(){return 4})):new L(o.thisDep,o.contextDep,o.propDep,(function(t,e){var r=t.ELEMENTS;return e.def(r,"?",r,".primType:",4)})):null}(),count:function(){if("count"in n){var t=0|n.count;return j((function(){return t}))}if("count"in i){var e=i.count;return B(e,(function(t,r){return t.invoke(r,e)}))}return o?O(o)?o?s?new L(s.thisDep,s.contextDep,s.propDep,(function(t,e){return e.def(t.ELEMENTS,".vertCount-",t.OFFSET)})):j((function(t,e){return e.def(t.ELEMENTS,".vertCount")})):j((function(){return-1})):new L(o.thisDep||s.thisDep,o.contextDep||s.contextDep,o.propDep||s.propDep,(function(t,e){var r=t.ELEMENTS;return t.OFFSET?e.def(r,"?",r,".vertCount-",t.OFFSET,":-1"):e.def(r,"?",r,".vertCount:-1")})):null}(),instances:r("instances",!1),offset:s}}function k(t,r){var n=t.static,i=t.dynamic,a={};return Object.keys(n).forEach((function(t){var r=n[t],i=e.id(t),s=new J;if(D(r))s.state=1,s.buffer=o.getBuffer(o.create(r,34962,!1,!0)),s.type=0;else if(u=o.getBuffer(r))s.state=1,s.buffer=u,s.type=0;else if("constant"in r){var l=r.constant;s.buffer="null",s.state=2,"number"==typeof l?s.x=l:yt.forEach((function(t,e){e<l.length&&(s[t]=l[e])}))}else{var u=D(r.buffer)?o.getBuffer(o.create(r.buffer,34962,!1,!0)):o.getBuffer(r.buffer),c=0|r.offset,p=0|r.stride,h=0|r.size,d=!!r.normalized,f=0;"type"in r&&(f=Q[r.type]),r=0|r.divisor,s.buffer=u,s.state=1,s.size=h,s.normalized=d,s.type=f||u.dtype,s.offset=c,s.stride=p,s.divisor=r}a[t]=j((function(t,e){var r=t.attribCache;if(i in r)return r[i];var n={isStream:!1};return Object.keys(s).forEach((function(t){n[t]=s[t]})),s.buffer&&(n.buffer=t.link(s.buffer),n.type=n.type||n.buffer+".dtype"),r[i]=n}))})),Object.keys(i).forEach((function(t){var e=i[t];a[t]=B(e,(function(t,r){function n(t){r(l[t],"=",i,".",t,"|0;")}var i=t.invoke(r,e),o=t.shared,a=t.constants,s=o.isBufferArgs,l=(o=o.buffer,{isStream:r.def(!1)}),u=new J;u.state=1,Object.keys(u).forEach((function(t){l[t]=r.def(""+u[t])}));var c=l.buffer,p=l.type;return r("if(",s,"(",i,")){",l.isStream,"=true;",c,"=",o,".createStream(",34962,",",i,");",p,"=",c,".dtype;","}else{",c,"=",o,".getBuffer(",i,");","if(",c,"){",p,"=",c,".dtype;",'}else if("constant" in ',i,"){",l.state,"=",2,";","if(typeof "+i+'.constant === "number"){',l[yt[0]],"=",i,".constant;",yt.slice(1).map((function(t){return l[t]})).join("="),"=0;","}else{",yt.map((function(t,e){return l[t]+"="+i+".constant.length>"+e+"?"+i+".constant["+e+"]:0;"})).join(""),"}}else{","if(",s,"(",i,".buffer)){",c,"=",o,".createStream(",34962,",",i,".buffer);","}else{",c,"=",o,".getBuffer(",i,".buffer);","}",p,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",c,".dtype;",l.normalized,"=!!",i,".normalized;"),n("size"),n("offset"),n("stride"),n("divisor"),r("}}"),r.exit("if(",l.isStream,"){",o,".destroyStream(",c,");","}"),l}))})),a}function E(t,e,n,o,a){function s(t){var e=u[t];e&&(h[t]=e)}var l=function(t,e){if("string"==typeof(r=t.static).frag&&"string"==typeof r.vert){if(0<Object.keys(e.dynamic).length)return null;var r=e.static,n=Object.keys(r);if(0<n.length&&"number"==typeof r[n[0]]){for(var i=[],o=0;o<n.length;++o)i.push([0|r[n[o]],n[o]]);return i}}return null}(t,e),u=function(t,e,r){function n(t){if(t in i){var r=i[t];t=!0;var n,a,s=0|r.x,l=0|r.y;return"width"in r?n=0|r.width:t=!1,"height"in r?a=0|r.height:t=!1,new L(!t&&e&&e.thisDep,!t&&e&&e.contextDep,!t&&e&&e.propDep,(function(t,e){var i=t.shared.context,o=n;"width"in r||(o=e.def(i,".","framebufferWidth","-",s));var u=a;return"height"in r||(u=e.def(i,".","framebufferHeight","-",l)),[s,l,o,u]}))}if(t in o){var u=o[t];return t=B(u,(function(t,e){var r=t.invoke(e,u),n=t.shared.context,i=e.def(r,".x|0"),o=e.def(r,".y|0");return[i,o,e.def('"width" in ',r,"?",r,".width|0:","(",n,".","framebufferWidth","-",i,")"),r=e.def('"height" in ',r,"?",r,".height|0:","(",n,".","framebufferHeight","-",o,")")]})),e&&(t.thisDep=t.thisDep||e.thisDep,t.contextDep=t.contextDep||e.contextDep,t.propDep=t.propDep||e.propDep),t}return e?new L(e.thisDep,e.contextDep,e.propDep,(function(t,e){var r=t.shared.context;return[0,0,e.def(r,".","framebufferWidth"),e.def(r,".","framebufferHeight")]})):null}var i=t.static,o=t.dynamic;if(t=n("viewport")){var a=t;t=new L(t.thisDep,t.contextDep,t.propDep,(function(t,e){var r=a.append(t,e),n=t.shared.context;return e.set(n,".viewportWidth",r[2]),e.set(n,".viewportHeight",r[3]),r}))}return{viewport:t,scissor_box:n("scissor.box")}}(t,f=_(t)),p=C(t),h=function(t,e){var r=t.static,n=t.dynamic,o={};return ot.forEach((function(t){function e(e,i){if(t in r){var s=e(r[t]);o[a]=j((function(){return s}))}else if(t in n){var l=n[t];o[a]=B(l,(function(t,e){return i(t,e,t.invoke(e,l))}))}}var a=b(t);switch(t){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return e((function(t){return t}),(function(t,e,r){return r}));case"depth.func":return e((function(t){return Ct[t]}),(function(t,e,r){return e.def(t.constants.compareFuncs,"[",r,"]")}));case"depth.range":return e((function(t){return t}),(function(t,e,r){return[e.def("+",r,"[0]"),e=e.def("+",r,"[1]")]}));case"blend.func":return e((function(t){return[xt["srcRGB"in t?t.srcRGB:t.src],xt["dstRGB"in t?t.dstRGB:t.dst],xt["srcAlpha"in t?t.srcAlpha:t.src],xt["dstAlpha"in t?t.dstAlpha:t.dst]]}),(function(t,e,r){function n(t,n){return e.def('"',t,n,'" in ',r,"?",r,".",t,n,":",r,".",t)}t=t.constants.blendFuncs;var i=n("src","RGB"),o=n("dst","RGB"),a=(i=e.def(t,"[",i,"]"),e.def(t,"[",n("src","Alpha"),"]"));return[i,o=e.def(t,"[",o,"]"),a,t=e.def(t,"[",n("dst","Alpha"),"]")]}));case"blend.equation":return e((function(t){return"string"==typeof t?[Z[t],Z[t]]:"object"==typeof t?[Z[t.rgb],Z[t.alpha]]:void 0}),(function(t,e,r){var n=t.constants.blendEquations,i=e.def(),o=e.def();return(t=t.cond("typeof ",r,'==="string"')).then(i,"=",o,"=",n,"[",r,"];"),t.else(i,"=",n,"[",r,".rgb];",o,"=",n,"[",r,".alpha];"),e(t),[i,o]}));case"blend.color":return e((function(t){return i(4,(function(e){return+t[e]}))}),(function(t,e,r){return i(4,(function(t){return e.def("+",r,"[",t,"]")}))}));case"stencil.mask":return e((function(t){return 0|t}),(function(t,e,r){return e.def(r,"|0")}));case"stencil.func":return e((function(t){return[Ct[t.cmp||"keep"],t.ref||0,"mask"in t?t.mask:-1]}),(function(t,e,r){return[t=e.def('"cmp" in ',r,"?",t.constants.compareFuncs,"[",r,".cmp]",":",7680),e.def(r,".ref|0"),e=e.def('"mask" in ',r,"?",r,".mask|0:-1")]}));case"stencil.opFront":case"stencil.opBack":return e((function(e){return["stencil.opBack"===t?1029:1028,kt[e.fail||"keep"],kt[e.zfail||"keep"],kt[e.zpass||"keep"]]}),(function(e,r,n){function i(t){return r.def('"',t,'" in ',n,"?",o,"[",n,".",t,"]:",7680)}var o=e.constants.stencilOps;return["stencil.opBack"===t?1029:1028,i("fail"),i("zfail"),i("zpass")]}));case"polygonOffset.offset":return e((function(t){return[0|t.factor,0|t.units]}),(function(t,e,r){return[e.def(r,".factor|0"),e=e.def(r,".units|0")]}));case"cull.face":return e((function(t){var e=0;return"front"===t?e=1028:"back"===t&&(e=1029),e}),(function(t,e,r){return e.def(r,'==="front"?',1028,":",1029)}));case"lineWidth":return e((function(t){return t}),(function(t,e,r){return r}));case"frontFace":return e((function(t){return Et[t]}),(function(t,e,r){return e.def(r+'==="cw"?2304:2305')}));case"colorMask":return e((function(t){return t.map((function(t){return!!t}))}),(function(t,e,r){return i(4,(function(t){return"!!"+r+"["+t+"]"}))}));case"sample.coverage":return e((function(t){return["value"in t?t.value:1,!!t.invert]}),(function(t,e,r){return[e.def('"value" in ',r,"?+",r,".value:1"),e=e.def("!!",r,".invert")]}))}})),o}(t),d=x(t,0,l);s("viewport"),s(b("scissor.box"));var f,m=0<Object.keys(h).length;if((f={framebuffer:f,draw:p,shader:d,state:h,dirty:m,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(t){var e,r=t.static;if(t=t.dynamic,"profile"in r){var n=!!r.profile;(e=j((function(t,e){return n}))).enable=n}else if("profile"in t){var i=t.profile;e=B(i,(function(t,e){return t.invoke(e,i)}))}return e}(t),f.uniforms=function(t,e){var r=t.static,n=t.dynamic,o={};return Object.keys(r).forEach((function(t){var e,n=r[t];if("number"==typeof n||"boolean"==typeof n)e=j((function(){return n}));else if("function"==typeof n){var a=n._reglType;"texture2d"===a||"textureCube"===a?e=j((function(t){return t.link(n)})):"framebuffer"!==a&&"framebufferCube"!==a||(e=j((function(t){return t.link(n.color[0])})))}else v(n)&&(e=j((function(t){return t.global.def("[",i(n.length,(function(t){return n[t]})),"]")})));e.value=n,o[t]=e})),Object.keys(n).forEach((function(t){var e=n[t];o[t]=B(e,(function(t,r){return t.invoke(r,e)}))})),o}(n),f.drawVAO=f.scopeVAO=function(t,e){var r=t.static,n=t.dynamic;if("vao"in r){var i=r.vao;return null!==i&&null===c.getVAO(i)&&(i=c.createVAO(i)),j((function(t){return t.link(c.getVAO(i))}))}if("vao"in n){var o=n.vao;return B(o,(function(t,e){var r=t.invoke(e,o);return e.def(t.shared.vao+".getVAO("+r+")")}))}return null}(t),!f.drawVAO&&d.program&&!l&&r.angle_instanced_arrays){var g=!0;if(t=d.program.attributes.map((function(t){return t=e.static[t],g=g&&!!t,t})),g&&0<t.length){var w=c.getVAO(c.createVAO(t));f.drawVAO=new L(null,null,null,(function(t,e){return t.link(w)})),f.useVAO=!0}}return l?f.useVAO=!0:f.attributes=k(e),f.context=function(t){var e=t.static,r=t.dynamic,n={};return Object.keys(e).forEach((function(t){var r=e[t];n[t]=j((function(t,e){return"number"==typeof r||"boolean"==typeof r?""+r:t.link(r)}))})),Object.keys(r).forEach((function(t){var e=r[t];n[t]=B(e,(function(t,r){return t.invoke(r,e)}))})),n}(o),f}function P(t,e,r){var n=t.shared.context,i=t.scope();Object.keys(r).forEach((function(o){e.save(n,"."+o);var a=r[o].append(t,e);Array.isArray(a)?i(n,".",o,"=[",a.join(),"];"):i(n,".",o,"=",a,";")})),e(i)}function A(t,e,r,n){var i,o=(s=t.shared).gl,a=s.framebuffer;rt&&(i=e.def(s.extensions,".webgl_draw_buffers"));var s=(l=t.constants).drawBuffer,l=l.backBuffer;t=r?r.append(t,e):e.def(a,".next"),n||e("if(",t,"!==",a,".cur){"),e("if(",t,"){",o,".bindFramebuffer(",36160,",",t,".framebuffer);"),rt&&e(i,".drawBuffersWEBGL(",s,"[",t,".colorAttachments.length]);"),e("}else{",o,".bindFramebuffer(",36160,",null);"),rt&&e(i,".drawBuffersWEBGL(",l,");"),e("}",a,".cur=",t,";"),n||e("}")}function M(t,e,r){var n=t.shared,o=n.gl,a=t.current,s=t.next,l=n.current,u=n.next,c=t.cond(l,".dirty");ot.forEach((function(e){var n,p;if(!((e=b(e))in r.state))if(e in s){n=s[e],p=a[e];var h=i(nt[e].length,(function(t){return c.def(n,"[",t,"]")}));c(t.cond(h.map((function(t,e){return t+"!=="+p+"["+e+"]"})).join("||")).then(o,".",st[e],"(",h,");",h.map((function(t,e){return p+"["+e+"]="+t})).join(";"),";"))}else n=c.def(u,".",e),h=t.cond(n,"!==",l,".",e),c(h),e in at?h(t.cond(n).then(o,".enable(",at[e],");").else(o,".disable(",at[e],");"),l,".",e,"=",n,";"):h(o,".",st[e],"(",n,");",l,".",e,"=",n,";")})),0===Object.keys(r.state).length&&c(l,".dirty=false;"),e(c)}function I(t,e,r,n){var i=t.shared,o=t.current,a=i.current,s=i.gl;T(Object.keys(r)).forEach((function(i){var l=r[i];if(!n||n(l)){var u=l.append(t,e);if(at[i]){var c=at[i];O(l)?e(s,u?".enable(":".disable(",c,");"):e(t.cond(u).then(s,".enable(",c,");").else(s,".disable(",c,");")),e(a,".",i,"=",u,";")}else if(v(u)){var p=o[i];e(s,".",st[i],"(",u,");",u.map((function(t,e){return p+"["+e+"]="+t})).join(";"),";")}else e(s,".",st[i],"(",u,");",a,".",i,"=",u,";")}}))}function R(t,e){tt&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function U(t,e,r,n,i){function o(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function a(t){t(u=e.def(),"=",o(),";"),"string"==typeof i?t(h,".count+=",i,";"):t(h,".count++;"),f&&(n?t(c=e.def(),"=",v,".getNumPendingQueries();"):t(v,".beginQuery(",h,");"))}function s(t){t(h,".cpuTime+=",o(),"-",u,";"),f&&(n?t(v,".pushScopeStats(",c,",",v,".getNumPendingQueries(),",h,");"):t(v,".endQuery();"))}function l(t){var r=e.def(d,".profile");e(d,".profile=",t,";"),e.exit(d,".profile=",r,";")}var u,c,p=t.shared,h=t.stats,d=p.current,v=p.timer;if(r=r.profile){if(O(r))return void(r.enable?(a(e),s(e.exit),l("true")):l("false"));l(r=r.append(t,e))}else r=e.def(d,".profile");a(p=t.block()),e("if(",r,"){",p,"}"),s(t=t.block()),e.exit("if(",r,"){",t,"}")}function N(t,e,r,n,i){function o(r,n,i){function o(){e("if(!",c,".buffer){",l,".enableVertexAttribArray(",u,");}");var r,o=i.type;r=i.size?e.def(i.size,"||",n):n,e("if(",c,".type!==",o,"||",c,".size!==",r,"||",d.map((function(t){return c+"."+t+"!=="+i[t]})).join("||"),"){",l,".bindBuffer(",34962,",",p,".buffer);",l,".vertexAttribPointer(",[u,r,o,i.normalized,i.stride,i.offset],");",c,".type=",o,";",c,".size=",r,";",d.map((function(t){return c+"."+t+"="+i[t]+";"})).join(""),"}"),tt&&(o=i.divisor,e("if(",c,".divisor!==",o,"){",t.instancing,".vertexAttribDivisorANGLE(",[u,o],");",c,".divisor=",o,";}"))}function s(){e("if(",c,".buffer){",l,".disableVertexAttribArray(",u,");",c,".buffer=null;","}if(",yt.map((function(t,e){return c+"."+t+"!=="+h[e]})).join("||"),"){",l,".vertexAttrib4f(",u,",",h,");",yt.map((function(t,e){return c+"."+t+"="+h[e]+";"})).join(""),"}")}var l=a.gl,u=e.def(r,".location"),c=e.def(a.attributes,"[",u,"]");r=i.state;var p=i.buffer,h=[i.x,i.y,i.z,i.w],d=["buffer","normalized","offset","stride"];1===r?o():2===r?s():(e("if(",r,"===",1,"){"),o(),e("}else{"),s(),e("}"))}var a=t.shared;n.forEach((function(n){var a,s=n.name,l=r.attributes[s];if(l){if(!i(l))return;a=l.append(t,e)}else{if(!i(Pt))return;var u=t.scopeAttrib(s);a={},Object.keys(new J).forEach((function(t){a[t]=e.def(u,".",t)}))}o(t.link(n),function(t){switch(t){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(n.info.type),a)}))}function H(t,r,n,o,a){for(var s,l=t.shared,u=l.gl,c=0;c<o.length;++c){var p,h=(m=o[c]).name,d=m.info.type,f=n.uniforms[h],m=t.link(m)+".location";if(f){if(!a(f))continue;if(O(f)){if(h=f.value,35678===d||35680===d)r(u,".uniform1i(",m,",",(d=t.link(h._texture||h.color[0]._texture))+".bind());"),r.exit(d,".unbind();");else if(35674===d||35675===d||35676===d)f=2,35675===d?f=3:35676===d&&(f=4),r(u,".uniformMatrix",f,"fv(",m,",false,",h=t.global.def("new Float32Array(["+Array.prototype.slice.call(h)+"])"),");");else{switch(d){case 5126:s="1f";break;case 35664:s="2f";break;case 35665:s="3f";break;case 35666:s="4f";break;case 35670:case 5124:s="1i";break;case 35671:case 35667:s="2i";break;case 35672:case 35668:s="3i";break;case 35673:s="4i";break;case 35669:s="4i"}r(u,".uniform",s,"(",m,",",v(h)?Array.prototype.slice.call(h):h,");")}continue}p=f.append(t,r)}else{if(!a(Pt))continue;p=r.def(l.uniforms,"[",e.id(h),"]")}switch(35678===d?r("if(",p,"&&",p,'._reglType==="framebuffer"){',p,"=",p,".color[0];","}"):35680===d&&r("if(",p,"&&",p,'._reglType==="framebufferCube"){',p,"=",p,".color[0];","}"),h=1,d){case 35678:case 35680:d=r.def(p,"._texture"),r(u,".uniform1i(",m,",",d,".bind());"),r.exit(d,".unbind();");continue;case 5124:case 35670:s="1i";break;case 35667:case 35671:s="2i",h=2;break;case 35668:case 35672:s="3i",h=3;break;case 35669:case 35673:s="4i",h=4;break;case 5126:s="1f";break;case 35664:s="2f",h=2;break;case 35665:s="3f",h=3;break;case 35666:s="4f",h=4;break;case 35674:s="Matrix2fv";break;case 35675:s="Matrix3fv";break;case 35676:s="Matrix4fv"}if(r(u,".uniform",s,"(",m,","),"M"===s.charAt(0)){m=Math.pow(d-35674+2,2);var b=t.global.def("new Float32Array(",m,")");Array.isArray(p)?r("false,(",i(m,(function(t){return b+"["+t+"]="+p[t]})),",",b,")"):r("false,(Array.isArray(",p,")||",p," instanceof Float32Array)?",p,":(",i(m,(function(t){return b+"["+t+"]="+p+"["+t+"]"})),",",b,")")}else r(1<h?i(h,(function(t){return Array.isArray(p)?p[t]:p+"["+t+"]"})):p);r(");")}}function q(t,e,r,n){function i(i){var o=h[i];return o?o.contextDep&&n.contextDynamic||o.propDep?o.append(t,r):o.append(t,e):e.def(p,".",i)}function o(){function t(){r(l,".drawElementsInstancedANGLE(",[f,m,b,v+"<<(("+b+"-5121)>>1)",s],");")}function e(){r(l,".drawArraysInstancedANGLE(",[f,v,m,s],");")}d?g?t():(r("if(",d,"){"),t(),r("}else{"),e(),r("}")):e()}function a(){function t(){r(c+".drawElements("+[f,m,b,v+"<<(("+b+"-5121)>>1)"]+");")}function e(){r(c+".drawArrays("+[f,v,m]+");")}d?g?t():(r("if(",d,"){"),t(),r("}else{"),e(),r("}")):e()}var s,l,u=t.shared,c=u.gl,p=u.draw,h=n.draw,d=function(){var i=h.elements,o=e;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(o=r),i=i.append(t,o)):i=o.def(p,".","elements"),i&&o("if("+i+")"+c+".bindBuffer(34963,"+i+".buffer.buffer);"),i}(),f=i("primitive"),v=i("offset"),m=function(){var i=h.count,o=e;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(o=r),i=i.append(t,o)):i=o.def(p,".","count"),i}();if("number"==typeof m){if(0===m)return}else r("if(",m,"){"),r.exit("}");tt&&(s=i("instances"),l=t.instancing);var b=d+".type",g=h.elements&&O(h.elements);tt&&("number"!=typeof s||0<=s)?"string"==typeof s?(r("if(",s,">0){"),o(),r("}else if(",s,"<0){"),a(),r("}")):o():a()}function K(t,e,r,n,i){return i=(e=y()).proc("body",i),tt&&(e.instancing=i.def(e.shared.extensions,".angle_instanced_arrays")),t(e,i,r,n),e.compile().body}function G(t,e,r,n){R(t,e),r.useVAO?r.drawVAO?e(t.shared.vao,".setVAO(",r.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),N(t,e,r,n.attributes,(function(){return!0}))),H(t,e,r,n.uniforms,(function(){return!0})),q(t,e,e,r)}function $(t,e,r,n){function i(){return!0}t.batchId="a1",R(t,e),N(t,e,r,n.attributes,i),H(t,e,r,n.uniforms,i),q(t,e,e,r)}function W(t,e,r,n){function i(t){return t.contextDep&&a||t.propDep}function o(t){return!i(t)}R(t,e);var a=r.contextDep,s=e.def(),l=e.def();t.shared.props=l,t.batchId=s;var u=t.scope(),c=t.scope();e(u.entry,"for(",s,"=0;",s,"<","a1",";++",s,"){",l,"=","a0","[",s,"];",c,"}",u.exit),r.needsContext&&P(t,c,r.context),r.needsFramebuffer&&A(t,c,r.framebuffer),I(t,c,r.state,i),r.profile&&i(r.profile)&&U(t,c,r,!1,!0),n?(r.useVAO?r.drawVAO?i(r.drawVAO)?c(t.shared.vao,".setVAO(",r.drawVAO.append(t,c),");"):u(t.shared.vao,".setVAO(",r.drawVAO.append(t,u),");"):u(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(u(t.shared.vao,".setVAO(null);"),N(t,u,r,n.attributes,o),N(t,c,r,n.attributes,i)),H(t,u,r,n.uniforms,o),H(t,c,r,n.uniforms,i),q(t,u,c,r)):(e=t.global.def("{}"),n=r.shader.progVar.append(t,c),l=c.def(n,".id"),u=c.def(e,"[",l,"]"),c(t.shared.gl,".useProgram(",n,".program);","if(!",u,"){",u,"=",e,"[",l,"]=",t.link((function(e){return K($,t,r,e,2)})),"(",n,");}",u,".call(this,a0[",s,"],",s,");"))}function Y(t,r){function n(e){var n=r.shader[e];n&&i.set(o.shader,"."+e,n.append(t,i))}var i=t.proc("scope",3);t.batchId="a2";var o=t.shared,a=o.current;P(t,i,r.context),r.framebuffer&&r.framebuffer.append(t,i),T(Object.keys(r.state)).forEach((function(e){var n=r.state[e].append(t,i);v(n)?n.forEach((function(r,n){i.set(t.next[e],"["+n+"]",r)})):i.set(o.next,"."+e,n)})),U(t,i,r,!0,!0),["elements","offset","count","instances","primitive"].forEach((function(e){var n=r.draw[e];n&&i.set(o.draw,"."+e,""+n.append(t,i))})),Object.keys(r.uniforms).forEach((function(n){var a=r.uniforms[n].append(t,i);Array.isArray(a)&&(a="["+a.join()+"]"),i.set(o.uniforms,"["+e.id(n)+"]",a)})),Object.keys(r.attributes).forEach((function(e){var n=r.attributes[e].append(t,i),o=t.scopeAttrib(e);Object.keys(new J).forEach((function(t){i.set(o,"."+t,n[t])}))})),r.scopeVAO&&i.set(o.vao,".targetVAO",r.scopeVAO.append(t,i)),n("vert"),n("frag"),0<Object.keys(r.state).length&&(i(a,".dirty=true;"),i.exit(a,".dirty=true;")),i("a1(",t.shared.context,",a0,",t.batchId,");")}function X(t,e,r){var n=e.static[r];if(n&&function(t){if("object"==typeof t&&!v(t)){for(var e=Object.keys(t),r=0;r<e.length;++r)if(z.isDynamic(t[e[r]]))return!0;return!1}}(n)){var i=t.global,o=Object.keys(n),a=!1,s=!1,l=!1,u=t.global.def("{}");o.forEach((function(e){var r=n[e];if(z.isDynamic(r))"function"==typeof r&&(r=n[e]=z.unbox(r)),e=B(r,null),a=a||e.thisDep,l=l||e.propDep,s=s||e.contextDep;else{switch(i(u,".",e,"="),typeof r){case"number":i(r);break;case"string":i('"',r,'"');break;case"object":Array.isArray(r)&&i("[",r.join(),"]");break;default:i(t.link(r))}i(";")}})),e.dynamic[r]=new z.DynamicVariable(4,{thisDep:a,contextDep:s,propDep:l,ref:u,append:function(t,e){o.forEach((function(r){var i=n[r];z.isDynamic(i)&&(i=t.invoke(e,i),e(u,".",r,"=",i,";"))}))}}),delete e.static[r]}}var J=c.Record,Z={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(Z.min=32775,Z.max=32776);var tt=r.angle_instanced_arrays,rt=r.webgl_draw_buffers,nt={dirty:!0,profile:m.profile},it={},ot=[],at={},st={};g("dither",3024),g("blend.enable",3042),w("blend.color","blendColor",[0,0,0,0]),w("blend.equation","blendEquationSeparate",[32774,32774]),w("blend.func","blendFuncSeparate",[1,0,1,0]),g("depth.enable",2929,!0),w("depth.func","depthFunc",513),w("depth.range","depthRange",[0,1]),w("depth.mask","depthMask",!0),w("colorMask","colorMask",[!0,!0,!0,!0]),g("cull.enable",2884),w("cull.face","cullFace",1029),w("frontFace","frontFace",2305),w("lineWidth","lineWidth",1),g("polygonOffset.enable",32823),w("polygonOffset.offset","polygonOffset",[0,0]),g("sample.alpha",32926),g("sample.enable",32928),w("sample.coverage","sampleCoverage",[1,!1]),g("stencil.enable",2960),w("stencil.mask","stencilMask",-1),w("stencil.func","stencilFunc",[519,0,-1]),w("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),w("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),g("scissor.enable",3089),w("scissor.box","scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),w("viewport","viewport",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var lt={gl:t,context:d,strings:e,next:it,current:nt,draw:h,elements:a,buffer:o,shader:p,attributes:c.state,vao:c,uniforms:u,framebuffer:l,extensions:r,timer:f,isBufferArgs:D},ut={primTypes:et,compareFuncs:Ct,blendFuncs:xt,blendEquations:Z,stencilOps:kt,glTypes:Q,orientationType:Et};rt&&(ut.backBuffer=[1029],ut.drawBuffer=i(n.maxDrawbuffers,(function(t){return 0===t?[0]:i(t,(function(t){return 36064+t}))})));var ct=0;return{next:it,current:nt,procs:function(){var t=y(),e=t.proc("poll"),o=t.proc("refresh"),a=t.block();e(a),o(a);var s,l=t.shared,u=l.gl,c=l.next,p=l.current;a(p,".dirty=false;"),A(t,e),A(t,o,null,!0),tt&&(s=t.link(tt)),r.oes_vertex_array_object&&o(t.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<n.maxAttributes;++h){var d=o.def(l.attributes,"[",h,"]"),f=t.cond(d,".buffer");f.then(u,".enableVertexAttribArray(",h,");",u,".bindBuffer(",34962,",",d,".buffer.buffer);",u,".vertexAttribPointer(",h,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(u,".disableVertexAttribArray(",h,");",u,".vertexAttrib4f(",h,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),o(f),tt&&o(s,".vertexAttribDivisorANGLE(",h,",",d,".divisor);")}return o(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(at).forEach((function(r){var n=at[r],i=a.def(c,".",r),s=t.block();s("if(",i,"){",u,".enable(",n,")}else{",u,".disable(",n,")}",p,".",r,"=",i,";"),o(s),e("if(",i,"!==",p,".",r,"){",s,"}")})),Object.keys(st).forEach((function(r){var n,s,l=st[r],h=nt[r],d=t.block();d(u,".",l,"("),v(h)?(l=h.length,n=t.global.def(c,".",r),s=t.global.def(p,".",r),d(i(l,(function(t){return n+"["+t+"]"})),");",i(l,(function(t){return s+"["+t+"]="+n+"["+t+"];"})).join("")),e("if(",i(l,(function(t){return n+"["+t+"]!=="+s+"["+t+"]"})).join("||"),"){",d,"}")):(n=a.def(c,".",r),s=a.def(p,".",r),d(n,");",p,".",r,"=",n,";"),e("if(",n,"!==",s,"){",d,"}")),o(d)})),t.compile()}(),compile:function(t,e,r,n,i){var o=y();o.stats=o.link(i),Object.keys(e.static).forEach((function(t){X(o,e,t)})),_t.forEach((function(e){X(o,t,e)}));var a=E(t,e,r,n);return function(t,e){var r=t.proc("draw",1);R(t,r),P(t,r,e.context),A(t,r,e.framebuffer),M(t,r,e),I(t,r,e.state),U(t,r,e,!1,!0);var n=e.shader.progVar.append(t,r);if(r(t.shared.gl,".useProgram(",n,".program);"),e.shader.program)G(t,r,e,e.shader.program);else{r(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),o=r.def(n,".id"),a=r.def(i,"[",o,"]");r(t.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",t.link((function(r){return K(G,t,e,r,1)})),"(",n,");",a,".call(this,a0);"))}0<Object.keys(e.state).length&&r(t.shared.current,".dirty=true;")}(o,a),Y(o,a),function(t,e){function r(t){return t.contextDep&&i||t.propDep}var n=t.proc("batch",2);t.batchId="0",R(t,n);var i=!1,o=!0;Object.keys(e.context).forEach((function(t){i=i||e.context[t].propDep})),i||(P(t,n,e.context),o=!1);var a=!1;if((s=e.framebuffer)?(s.propDep?i=a=!0:s.contextDep&&i&&(a=!0),a||A(t,n,s)):A(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(i=!0),M(t,n,e),I(t,n,e.state,(function(t){return!r(t)})),e.profile&&r(e.profile)||U(t,n,e,!1,"a1"),e.contextDep=i,e.needsContext=o,e.needsFramebuffer=a,(o=e.shader.progVar).contextDep&&i||o.propDep)W(t,n,e,null);else if(o=o.append(t,n),n(t.shared.gl,".useProgram(",o,".program);"),e.shader.program)W(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var s=t.global.def("{}"),l=(a=n.def(o,".id"),n.def(s,"[",a,"]"));n(t.cond(l).then(l,".call(this,a0,a1);").else(l,"=",s,"[",a,"]=",t.link((function(r){return K(W,t,e,r,2)})),"(",o,");",l,".call(this,a0,a1);"))}0<Object.keys(e.state).length&&n(t.shared.current,".dirty=true;")}(o,a),F(o.compile(),{destroy:function(){a.shader.program.destroy()}})}}}function R(t,e){for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}var F=function(t,e){for(var r=Object.keys(e),n=0;n<r.length;++n)t[r[n]]=e[r[n]];return t},U=0,z={DynamicVariable:t,define:function(r,n){return new t(r,e(n+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof t},unbox:function e(r,n){return"function"==typeof r?new t(0,r):"number"==typeof r||"boolean"==typeof r?new t(5,r):Array.isArray(r)?new t(6,r.map((function(t,r){return e(t,n+"["+r+"]")}))):r instanceof t?r:void 0},accessor:e},N={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},H="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},q=a();q.zero=a();var K=function(t,e){var r=1;e.ext_texture_filter_anisotropic&&(r=t.getParameter(34047));var n=1,i=1;e.webgl_draw_buffers&&(n=t.getParameter(34852),i=t.getParameter(36063));var o=!!e.oes_texture_float;if(o){o=t.createTexture(),t.bindTexture(3553,o),t.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var a=t.createFramebuffer();if(t.bindFramebuffer(36160,a),t.framebufferTexture2D(36160,36064,3553,o,0),t.bindTexture(3553,null),36053!==t.checkFramebufferStatus(36160))o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(16384);var s=q.allocType(5126,4);t.readPixels(0,0,1,1,6408,5126,s),t.getError()?o=!1:(t.deleteFramebuffer(a),t.deleteTexture(o),o=1===s[0]),q.freeType(s)}}return s=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(s=t.createTexture(),a=q.allocType(5121,36),t.activeTexture(33984),t.bindTexture(34067,s),t.texImage2D(34069,0,6408,3,3,0,6408,5121,a),q.freeType(a),t.bindTexture(34067,null),t.deleteTexture(s),s=!t.getError()),{colorBits:[t.getParameter(3410),t.getParameter(3411),t.getParameter(3412),t.getParameter(3413)],depthBits:t.getParameter(3414),stencilBits:t.getParameter(3415),subpixelBits:t.getParameter(3408),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:i,pointSizeDims:t.getParameter(33901),lineWidthDims:t.getParameter(33902),maxViewportDims:t.getParameter(3386),maxCombinedTextureUnits:t.getParameter(35661),maxCubeMapSize:t.getParameter(34076),maxRenderbufferSize:t.getParameter(34024),maxTextureUnits:t.getParameter(34930),maxTextureSize:t.getParameter(3379),maxAttributes:t.getParameter(34921),maxVertexUniforms:t.getParameter(36347),maxVertexTextureUnits:t.getParameter(35660),maxVaryingVectors:t.getParameter(36348),maxFragmentUniforms:t.getParameter(36349),glsl:t.getParameter(35724),renderer:t.getParameter(7937),vendor:t.getParameter(7936),version:t.getParameter(7938),readFloat:o,npotTextureCube:s}},G=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},$=function(t){return Object.keys(t).map((function(e){return t[e]}))},W={shape:function(t){for(var e=[];t.length;t=t[0])e.push(t.length);return e},flatten:function(t,e,r,n){var i=1;if(e.length)for(var o=0;o<e.length;++o)i*=e[o];else i=0;switch(r=n||q.allocType(r,i),e.length){case 0:break;case 1:for(n=e[0],e=0;e<n;++e)r[e]=t[e];break;case 2:for(n=e[0],e=e[1],o=i=0;o<n;++o)for(var a=t[o],s=0;s<e;++s)r[i++]=a[s];break;case 3:l(t,e[0],e[1],e[2],r,0);break;default:!function t(e,r,n,i,o){for(var a=1,s=n+1;s<r.length;++s)a*=r[s];var u=r[n];if(4==r.length-n){var c=r[n+1],p=r[n+2];for(r=r[n+3],s=0;s<u;++s)l(e[s],c,p,r,i,o),o+=a}else for(s=0;s<u;++s)t(e[s],r,n+1,i,o),o+=a}(t,e,0,r,0)}return r}},Y={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Q={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},X={dynamic:35048,stream:35040,static:35044},J=W.flatten,Z=W.shape,tt=[];tt[5120]=1,tt[5122]=2,tt[5124]=4,tt[5121]=1,tt[5123]=2,tt[5125]=4,tt[5126]=4;var et={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},rt=new Float32Array(1),nt=new Uint32Array(rt.buffer),it=[9984,9986,9985,9987],ot=[0,6409,6410,6407,6408],at={};at[6409]=at[6406]=at[6402]=1,at[34041]=at[6410]=2,at[6407]=at[35904]=3,at[6408]=at[35906]=4;var st=m("HTMLCanvasElement"),lt=m("OffscreenCanvas"),ut=m("CanvasRenderingContext2D"),ct=m("ImageBitmap"),pt=m("HTMLImageElement"),ht=m("HTMLVideoElement"),dt=Object.keys(Y).concat([st,lt,ut,ct,pt,ht]),ft=[];ft[5121]=1,ft[5126]=4,ft[36193]=2,ft[5123]=2,ft[5125]=4;var vt=[];vt[32854]=2,vt[32855]=2,vt[36194]=2,vt[34041]=4,vt[33776]=.5,vt[33777]=.5,vt[33778]=1,vt[33779]=1,vt[35986]=.5,vt[35987]=1,vt[34798]=1,vt[35840]=.5,vt[35841]=.25,vt[35842]=.5,vt[35843]=.25,vt[36196]=.5;var mt=[];mt[32854]=2,mt[32855]=2,mt[36194]=2,mt[33189]=2,mt[36168]=1,mt[34041]=4,mt[35907]=4,mt[34836]=16,mt[34842]=8,mt[34843]=6;var bt=function(t,e,r,n,i){function o(t){this.id=u++,this.refCount=1,this.renderbuffer=t,this.format=32854,this.height=this.width=0,i.profile&&(this.stats={size:0})}function a(e){var r=e.renderbuffer;t.bindRenderbuffer(36161,null),t.deleteRenderbuffer(r),e.renderbuffer=null,e.refCount=0,delete c[e.id],n.renderbufferCount--}var s={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};e.ext_srgb&&(s.srgba=35907),e.ext_color_buffer_half_float&&(s.rgba16f=34842,s.rgb16f=34843),e.webgl_color_buffer_float&&(s.rgba32f=34836);var l=[];Object.keys(s).forEach((function(t){l[s[t]]=t}));var u=0,c={};return o.prototype.decRef=function(){0>=--this.refCount&&a(this)},i.profile&&(n.getTotalRenderbufferSize=function(){var t=0;return Object.keys(c).forEach((function(e){t+=c[e].stats.size})),t}),{create:function(e,r){function a(e,r){var n=0,o=0,c=32854;if("object"==typeof e&&e?("shape"in e?(n=0|(o=e.shape)[0],o=0|o[1]):("radius"in e&&(n=o=0|e.radius),"width"in e&&(n=0|e.width),"height"in e&&(o=0|e.height)),"format"in e&&(c=s[e.format])):"number"==typeof e?(n=0|e,o="number"==typeof r?0|r:n):e||(n=o=1),n!==u.width||o!==u.height||c!==u.format)return a.width=u.width=n,a.height=u.height=o,u.format=c,t.bindRenderbuffer(36161,u.renderbuffer),t.renderbufferStorage(36161,c,n,o),i.profile&&(u.stats.size=mt[u.format]*u.width*u.height),a.format=l[u.format],a}var u=new o(t.createRenderbuffer());return c[u.id]=u,n.renderbufferCount++,a(e,r),a.resize=function(e,r){var n=0|e,o=0|r||n;return n===u.width&&o===u.height||(a.width=u.width=n,a.height=u.height=o,t.bindRenderbuffer(36161,u.renderbuffer),t.renderbufferStorage(36161,u.format,n,o),i.profile&&(u.stats.size=mt[u.format]*u.width*u.height)),a},a._reglType="renderbuffer",a._renderbuffer=u,i.profile&&(a.stats=u.stats),a.destroy=function(){u.decRef()},a},clear:function(){$(c).forEach(a)},restore:function(){$(c).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,e.renderbuffer),t.renderbufferStorage(36161,e.format,e.width,e.height)})),t.bindRenderbuffer(36161,null)}}},gt=[];gt[6408]=4,gt[6407]=3;var wt=[];wt[5121]=1,wt[5126]=4,wt[36193]=2;var yt=["x","y","z","w"],_t="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),xt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ct={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},kt={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Et={cw:2304,ccw:2305},Pt=new L(!1,!1,!1,(function(){}));return function(t){function e(){if(0===X.length)E&&E.update(),et=null;else{et=N.next(e),f();for(var t=X.length-1;0<=t;--t){var r=X[t];r&&r(T,null,0)}b.flush(),E&&E.update()}}function i(){!et&&0<X.length&&(et=N.next(e))}function o(){et&&(N.cancel(e),et=null)}function a(t){t.preventDefault(),o(),J.forEach((function(t){t()}))}function s(t){b.getError(),w.restore(),U.restore(),O.restore(),q.restore(),G.restore(),$.restore(),j.restore(),E&&E.restore(),W.procs.refresh(),i(),Z.forEach((function(t){t()}))}function l(t){function e(t,e){var r={},n={};return Object.keys(t).forEach((function(i){var o=t[i];if(z.isDynamic(o))n[i]=z.unbox(o,i);else{if(e&&Array.isArray(o))for(var a=0;a<o.length;++a)if(z.isDynamic(o[a]))return void(n[i]=z.unbox(o,i));r[i]=o}})),{dynamic:n,static:r}}var r=e(t.context||{},!0),n=e(t.uniforms||{},!0),i=e(t.attributes||{},!1);t=e(function(t){function e(t){if(t in r){var e=r[t];delete r[t],Object.keys(e).forEach((function(n){r[t+"."+n]=e[n]}))}}var r=F({},t);return delete r.uniforms,delete r.attributes,delete r.context,delete r.vao,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),e("blend"),e("depth"),e("cull"),e("stencil"),e("polygonOffset"),e("scissor"),e("sample"),"vao"in t&&(r.vao=t.vao),r}(t),!1);var o={gpuTime:0,cpuTime:0,count:0},a=W.compile(t,i,n,r,o),s=a.draw,l=a.batch,u=a.scope,c=[];return F((function(t,e){var r;if("function"==typeof t)return u.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(r=0;r<t;++r)u.call(this,null,e,r);else{if(!Array.isArray(t))return u.call(this,t,e,0);for(r=0;r<t.length;++r)u.call(this,t[r],e,r)}else if("number"==typeof t){if(0<t)return l.call(this,function(t){for(;c.length<t;)c.push(null);return c}(0|t),0|t)}else{if(!Array.isArray(t))return s.call(this,t);if(t.length)return l.call(this,t,t.length)}}),{stats:o,destroy:function(){a.destroy()}})}function u(t,e){var r=0;W.procs.poll();var n=e.color;n&&(b.clearColor(+n[0]||0,+n[1]||0,+n[2]||0,+n[3]||0),r|=16384),"depth"in e&&(b.clearDepth(+e.depth),r|=256),"stencil"in e&&(b.clearStencil(0|e.stencil),r|=1024),b.clear(r)}function c(t){return X.push(t),i(),{cancel:function(){var e=R(X,t);X[e]=function t(){var e=R(X,t);X[e]=X[X.length-1],--X.length,0>=X.length&&o()}}}}function p(){var t=Y.viewport,e=Y.scissor_box;t[0]=t[1]=e[0]=e[1]=0,T.viewportWidth=T.framebufferWidth=T.drawingBufferWidth=t[2]=e[2]=b.drawingBufferWidth,T.viewportHeight=T.framebufferHeight=T.drawingBufferHeight=t[3]=e[3]=b.drawingBufferHeight}function f(){T.tick+=1,T.time=m(),p(),W.procs.poll()}function v(){q.refresh(),p(),W.procs.refresh(),E&&E.update()}function m(){return(H()-V)/1e3}if(!(t=function(t){var e,i,o,a,s=t||{};t={};var l=[],u=[],c="undefined"==typeof window?1:window.devicePixelRatio,p=!1,h=function(t){},d=function(){};if("string"==typeof s?e=document.querySelector(s):"object"==typeof s&&("string"==typeof s.nodeName&&"function"==typeof s.appendChild&&"function"==typeof s.getBoundingClientRect?e=s:"function"==typeof s.drawArrays||"function"==typeof s.drawElements?o=(a=s).canvas:("gl"in s?a=s.gl:"canvas"in s?o=n(s.canvas):"container"in s&&(i=n(s.container)),"attributes"in s&&(t=s.attributes),"extensions"in s&&(l=r(s.extensions)),"optionalExtensions"in s&&(u=r(s.optionalExtensions)),"onDone"in s&&(h=s.onDone),"profile"in s&&(p=!!s.profile),"pixelRatio"in s&&(c=+s.pixelRatio))),e&&("canvas"===e.nodeName.toLowerCase()?o=e:i=e),!a){if(!o){if(!(e=function(t,e,r){function n(){var e=window.innerWidth,n=window.innerHeight;t!==document.body&&(e=(n=t.getBoundingClientRect()).right-n.left,n=n.bottom-n.top),o.width=r*e,o.height=r*n,F(o.style,{width:e+"px",height:n+"px"})}var i,o=document.createElement("canvas");return F(o.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(o),t===document.body&&(o.style.position="absolute",F(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(n)}))).observe(t):window.addEventListener("resize",n,!1),n(),{canvas:o,onDestroy:function(){i?i.disconnect():window.removeEventListener("resize",n),t.removeChild(o)}}}(i||document.body,0,c)))return null;o=e.canvas,d=e.onDestroy}void 0===t.premultipliedAlpha&&(t.premultipliedAlpha=!0),a=function(t,e){function r(r){try{return t.getContext(r,e)}catch(o){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}(o,t)}return a?{gl:a,canvas:o,container:i,extensions:l,optionalExtensions:u,pixelRatio:c,profile:p,onDone:h,onDestroy:d}:(d(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(t)))return null;var b=t.gl,g=b.getContextAttributes();b.isContextLost();var w=function(t,e){function r(e){var r;e=e.toLowerCase();try{r=n[e]=t.getExtension(e)}catch(i){}return!!r}for(var n={},i=0;i<e.extensions.length;++i){var o=e.extensions[i];if(!r(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!r(t))throw Error("(regl): error restoring extension "+t)}))}}}(b,t);if(!w)return null;var y=function(){var t={"":0},e=[""];return{id:function(r){var n=t[r];return n||(n=t[r]=e.length,e.push(r),n)},str:function(t){return e[t]}}}(),_={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},x=w.extensions,E=function(t,e){function r(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function n(t,e,n){var i=a.pop()||new r;i.startQueryIndex=t,i.endQueryIndex=e,i.sum=0,i.stats=n,s.push(i)}if(!e.ext_disjoint_timer_query)return null;var i=[],o=[],a=[],s=[],l=[],u=[];return{beginQuery:function(t){var r=i.pop()||e.ext_disjoint_timer_query.createQueryEXT();e.ext_disjoint_timer_query.beginQueryEXT(35007,r),o.push(r),n(o.length-1,o.length,t)},endQuery:function(){e.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:n,update:function(){var t,r;if(0!==(t=o.length)){u.length=Math.max(u.length,t+1),l.length=Math.max(l.length,t+1),l[0]=0;var n=u[0]=0;for(r=t=0;r<o.length;++r){var c=o[r];e.ext_disjoint_timer_query.getQueryObjectEXT(c,34919)?(n+=e.ext_disjoint_timer_query.getQueryObjectEXT(c,34918),i.push(c)):o[t++]=c,l[r+1]=n,u[r+1]=t}for(o.length=t,r=t=0;r<s.length;++r){var p=(n=s[r]).startQueryIndex;c=n.endQueryIndex,n.sum+=l[c]-l[p],p=u[p],(c=u[c])===p?(n.stats.gpuTime+=n.sum/1e6,a.push(n)):(n.startQueryIndex=p,n.endQueryIndex=c,s[t++]=n)}s.length=t}},getNumPendingQueries:function(){return o.length},clear:function(){i.push.apply(i,o);for(var t=0;t<i.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(i[t]);o.length=0,i.length=0},restore:function(){o.length=0,i.length=0}}}(0,x),V=H(),S=b.drawingBufferWidth,D=b.drawingBufferHeight,T={tick:0,time:0,viewportWidth:S,viewportHeight:D,framebufferWidth:S,framebufferHeight:D,drawingBufferWidth:S,drawingBufferHeight:D,pixelRatio:t.pixelRatio},L=K(b,x),O=h(b,_,t,(function(t){return j.destroyBuffer(t)})),j=P(b,x,L,_,O),B=d(b,x,O,_),U=A(b,y,_,t),q=C(b,x,L,(function(){W.procs.poll()}),T,_,t),G=bt(b,x,0,_,t),$=k(b,x,L,q,G,_),W=I(b,y,x,L,O,B,0,$,{},j,U,{elements:null,primitive:4,count:-1,offset:0,instances:-1},T,E,t),Y=(y=M(b,$,W.procs.poll,T),W.next),Q=b.canvas,X=[],J=[],Z=[],tt=[t.onDestroy],et=null;Q&&(Q.addEventListener("webglcontextlost",a,!1),Q.addEventListener("webglcontextrestored",s,!1));var rt=$.setFBO=l({framebuffer:z.define.call(null,1,"framebuffer")});return v(),g=F(l,{clear:function(t){if("framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var e=0;6>e;++e)rt(F({framebuffer:t.framebuffer.faces[e]},t),u);else rt(t,u);else u(0,t)},prop:z.define.bind(null,1),context:z.define.bind(null,2),this:z.define.bind(null,3),draw:l({}),buffer:function(t){return O.create(t,34962,!1,!1)},elements:function(t){return B.create(t,!1)},texture:q.create2D,cube:q.createCube,renderbuffer:G.create,framebuffer:$.create,framebufferCube:$.createCube,vao:j.createVAO,attributes:g,frame:c,on:function(t,e){var r;switch(t){case"frame":return c(e);case"lost":r=J;break;case"restore":r=Z;break;case"destroy":r=tt}return r.push(e),{cancel:function(){for(var t=0;t<r.length;++t)if(r[t]===e){r[t]=r[r.length-1],r.pop();break}}}},limits:L,hasExtension:function(t){return 0<=L.extensions.indexOf(t.toLowerCase())},read:y,destroy:function(){X.length=0,o(),Q&&(Q.removeEventListener("webglcontextlost",a),Q.removeEventListener("webglcontextrestored",s)),U.clear(),$.clear(),G.clear(),q.clear(),B.clear(),O.clear(),j.clear(),E&&E.clear(),tt.forEach((function(t){t()}))},_gl:b,_refresh:v,poll:function(){f(),E&&E.update()},now:m,stats:_}),t.onDone(null,g),g}},"object"==typeof we.exports?we.exports=ge():"function"==typeof define&&define.amd?define(ge):this.createREGL=ge(),we=we.exports;function ye(t){var e,r,n=t[0]/255,i=t[1]/255,o=t[2]/255,a=Math.min(n,i,o),s=Math.max(n,i,o),l=s-a;return s==a?e=0:n==s?e=(i-o)/l:i==s?e=2+(o-n)/l:o==s&&(e=4+(n-i)/l),(e=Math.min(60*e,360))<0&&(e+=360),r=(a+s)/2,[e,100*(s==a?0:r<=.5?l/(s+a):l/(2-s-a)),100*r]}function _e(t){var e,r,n=t[0],i=t[1],o=t[2],a=Math.min(n,i,o),s=Math.max(n,i,o),l=s-a;return r=0==s?0:l/s*1e3/10,s==a?e=0:n==s?e=(i-o)/l:i==s?e=2+(o-n)/l:o==s&&(e=4+(n-i)/l),(e=Math.min(60*e,360))<0&&(e+=360),[e,r,s/255*1e3/10]}function xe(t){var e=t[0],r=t[1],n=t[2];return[ye(t)[0],1/255*Math.min(e,Math.min(r,n))*100,100*(n=1-1/255*Math.max(e,Math.max(r,n)))]}function Ce(t){var e,r=t[0]/255,n=t[1]/255,i=t[2]/255;return[100*((1-r-(e=Math.min(1-r,1-n,1-i)))/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-i-e)/(1-e)||0),100*e]}function ke(t){return Ue[JSON.stringify(t)]}function Ee(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*e+.7152*r+.0722*n),100*(.0193*e+.1192*r+.9505*n)]}function Pe(t){var e=Ee(t),r=e[0],n=e[1],i=e[2];return n/=100,i/=108.883,r=(r/=95.047)>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(r-n),200*(n-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]}function Ae(t){var e,r,n,i,o,a=t[0]/360,s=t[1]/100,l=t[2]/100;if(0==s)return[o=255*l,o,o];e=2*l-(r=l<.5?l*(1+s):l+s-l*s),i=[0,0,0];for(var u=0;u<3;u++)(n=a+1/3*-(u-1))<0&&n++,n>1&&n--,o=6*n<1?e+6*(r-e)*n:2*n<1?r:3*n<2?e+(r-e)*(2/3-n)*6:e,i[u]=255*o;return i}function Me(t){var e=t[0]/60,r=t[1]/100,n=t[2]/100,i=Math.floor(e)%6,o=e-Math.floor(e),a=255*n*(1-r),s=255*n*(1-r*o),l=255*n*(1-r*(1-o));switch(n*=255,i){case 0:return[n,l,a];case 1:return[s,n,a];case 2:return[a,n,l];case 3:return[a,s,n];case 4:return[l,a,n];case 5:return[n,a,s]}}function Ve(t){var e,n,i,o,a=t[0]/360,s=t[1]/100,l=t[2]/100,u=s+l;switch(u>1&&(s/=u,l/=u),i=6*a-(e=Math.floor(6*a)),0!=(1&e)&&(i=1-i),o=s+i*((n=1-l)-s),e){default:case 6:case 0:r=n,g=o,b=s;break;case 1:r=o,g=n,b=s;break;case 2:r=s,g=n,b=o;break;case 3:r=s,g=o,b=n;break;case 4:r=o,g=s,b=n;break;case 5:r=n,g=s,b=o}return[255*r,255*g,255*b]}function Se(t){var e=t[0]/100,r=t[1]/100,n=t[2]/100,i=t[3]/100;return[255*(1-Math.min(1,e*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i))]}function De(t){var e,r,n,i=t[0]/100,o=t[1]/100,a=t[2]/100;return r=-.9689*i+1.8758*o+.0415*a,n=.0557*i+-.204*o+1.057*a,e=(e=3.2406*i+-1.5372*o+-.4986*a)>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(e=Math.min(Math.max(0,e),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]}function Te(t){var e=t[0],r=t[1],n=t[2];return r/=100,n/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(e-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]}function Le(t){var e,r,n,i,o=t[0],a=t[1],s=t[2];return o<=8?i=(r=100*o/903.3)/100*7.787+16/116:(r=100*Math.pow((o+16)/116,3),i=Math.pow(r/100,1/3)),[e=e/95.047<=.008856?e=95.047*(a/500+i-16/116)/7.787:95.047*Math.pow(a/500+i,3),r,n=n/108.883<=.008859?n=108.883*(i-s/200-16/116)/7.787:108.883*Math.pow(i-s/200,3)]}function Oe(t){var e,r=t[0],n=t[1],i=t[2];return(e=360*Math.atan2(i,n)/2/Math.PI)<0&&(e+=360),[r,Math.sqrt(n*n+i*i),e]}function je(t){return De(Le(t))}function Be(t){var e,r=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[r,n*Math.cos(e),n*Math.sin(e)]}function Ie(t){return Fe[t]}var Re={rgb2hsl:ye,rgb2hsv:_e,rgb2hwb:xe,rgb2cmyk:Ce,rgb2keyword:ke,rgb2xyz:Ee,rgb2lab:Pe,rgb2lch:function(t){return Oe(Pe(t))},hsl2rgb:Ae,hsl2hsv:function(t){var e=t[0],r=t[1]/100,n=t[2]/100;return 0===n?[0,0,0]:[e,2*(r*=(n*=2)<=1?n:2-n)/(n+r)*100,(n+r)/2*100]},hsl2hwb:function(t){return xe(Ae(t))},hsl2cmyk:function(t){return Ce(Ae(t))},hsl2keyword:function(t){return ke(Ae(t))},hsv2rgb:Me,hsv2hsl:function(t){var e,r,n=t[0],i=t[1]/100,o=t[2]/100;return e=i*o,[n,100*(e=(e/=(r=(2-i)*o)<=1?r:2-r)||0),100*(r/=2)]},hsv2hwb:function(t){return xe(Me(t))},hsv2cmyk:function(t){return Ce(Me(t))},hsv2keyword:function(t){return ke(Me(t))},hwb2rgb:Ve,hwb2hsl:function(t){return ye(Ve(t))},hwb2hsv:function(t){return _e(Ve(t))},hwb2cmyk:function(t){return Ce(Ve(t))},hwb2keyword:function(t){return ke(Ve(t))},cmyk2rgb:Se,cmyk2hsl:function(t){return ye(Se(t))},cmyk2hsv:function(t){return _e(Se(t))},cmyk2hwb:function(t){return xe(Se(t))},cmyk2keyword:function(t){return ke(Se(t))},keyword2rgb:Ie,keyword2hsl:function(t){return ye(Ie(t))},keyword2hsv:function(t){return _e(Ie(t))},keyword2hwb:function(t){return xe(Ie(t))},keyword2cmyk:function(t){return Ce(Ie(t))},keyword2lab:function(t){return Pe(Ie(t))},keyword2xyz:function(t){return Ee(Ie(t))},xyz2rgb:De,xyz2lab:Te,xyz2lch:function(t){return Oe(Te(t))},lab2xyz:Le,lab2rgb:je,lab2lch:Oe,lch2lab:Be,lch2xyz:function(t){return Le(Be(t))},lch2rgb:function(t){return je(Be(t))}},Fe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Ue={};for(var ze in Fe)Ue[JSON.stringify(Fe[ze])]=ze;var Ne=function(){return new $e};for(var He in Re){Ne[He+"Raw"]=function(t){return function(e){return"number"==typeof e&&(e=Array.prototype.slice.call(arguments)),Re[t](e)}}(He);var qe=/(\w+)2(\w+)/.exec(He),Ke=qe[1],Ge=qe[2];(Ne[Ke]=Ne[Ke]||{})[Ge]=Ne[He]=function(t){return function(e){"number"==typeof e&&(e=Array.prototype.slice.call(arguments));var r=Re[t](e);if("string"==typeof r||void 0===r)return r;for(var n=0;n<r.length;n++)r[n]=Math.round(r[n]);return r}}(He)}var $e=function(){this.convs={}};$e.prototype.routeSpace=function(t,e){var r=e[0];return void 0===r?this.getValues(t):("number"==typeof r&&(r=Array.prototype.slice.call(e)),this.setValues(t,r))},$e.prototype.setValues=function(t,e){return this.space=t,this.convs={},this.convs[t]=e,this},$e.prototype.getValues=function(t){var e=this.convs[t];if(!e){var r=this.space,n=this.convs[r];e=Ne[r][t](n),this.convs[t]=e}return e},["rgb","hsl","hsv","cmyk","keyword"].forEach((function(t){$e.prototype[t]=function(e){return this.routeSpace(t,arguments)}}));var We={random:s,math:_},Ye=function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},Qe=function(t){return Math.pow(t-1,3)*(1-t)+1};const{math:Xe,random:Je}=We,Ze={RIGHT:"right",LEFT:"left",RANDOM:"random"},tr={SHOW:"show",HIDE:"hide",STAY:"stay"};var er,rr,nr={animations:tr,directions:Ze,shuffle:({text:t="",duration:e=1,delay:r=0,delayResolve:n=.2,fps:i=60,glyphs:o=" !#$&%()*+0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstu\xfcvwxyz{|}~",animation:a=tr.SHOW,direction:s=Ze.RIGHT,onUpdate:l=null,onComplete:u=null}={})=>{const c=o.split(""),p=t.split(""),h=1e3/i;let d,f,v,m,b,g,w,y,_,x=Date.now(),C=Date.now(),k=p.map((t,e)=>e);a==tr.HIDE&&(s==Ze.LEFT?s=Ze.RIGHT:s==Ze.RIGHT&&(s=Ze.LEFT)),s==Ze.LEFT&&k.reverse(),s==Ze.RANDOM&&(k=Je.shuffle(k));const E=()=>{if(Date.now()-x<h)requestAnimationFrame(E);else{x=Date.now(),m="",w=.001*(x-C)/e,a==tr.HIDE&&(w=1-w),y=Xe.clamp01(w-r),y=Qe(y),_=Xe.clamp01(w-r-n),_*=1/(1-n),_=Ye(_),d=Math.round(y*t.length),f=Math.round(_*t.length);for(let e=0;e<t.length;e++)g=k[e],v=p[e],g>=d&&a!=tr.STAY&&(v=" ")," "!=v&&g>=f&&(v=Je.pick(c)),m=`${m}${v}`;(b=a==tr.HIDE?y<=0:y>=1)?m=a==tr.HIDE?"":t:requestAnimationFrame(E),l&&l(m),b&&u&&u(m)}};E()},shuffleLCD:({text:t="",delay:e=0,fps:r=60,glyphs:n=" '\"\u201c\u201d\u2018\u2019\xb9\xb2\xb3!#$&%()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstu\xfcvwxyz{|}~\xbd\xbc\xa1\xab\xbb\xd7\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c",animation:i=tr.SHOW,stayFrames:o=25,onUpdate:a=null,onComplete:s=null}={})=>{const l=n.split(""),u=t.split(""),c=1e3/r;u.map((t,e)=>e),l.map((t,e)=>e);let p=u.map(t=>0),h=u.map(t=>l.findIndex(e=>e==t));i==tr.HIDE&&(p=h.concat()),i==tr.STAY&&(p=h.map(t=>Xe.mod(t-Je.rangeFloor(5,o),l.length)));let d,f,v,m,b=Date.now(),g=Date.now(),w=0;const y=()=>{if(Date.now()-b<c)requestAnimationFrame(y);else{(b=Date.now())-g>1e3*e&&w++,f="",v=0;for(let e=0;e<t.length;e++)m=p[e],ridx=h[e],i==tr.SHOW&&(m!=ridx?e<w&&m++:v++),i==tr.HIDE&&(m>0?e<w&&m--:v++),i==tr.STAY&&(m!=ridx?m++:v++),d=l[m%l.length],p[e]=m%l.length,f=`${f}${d}`;complete=v>=t.length,complete?f=i==tr.HIDE?"":t:requestAnimationFrame(y),a&&a(f),complete&&s&&s(f)}};y()}},ir={exports:{}};er=void 0,rr=function(t){class e{constructor(t){this.controller_=t}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(t){this.controller_.viewProps.set("hidden",t)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class r{constructor(t){this.target=t}}class n extends r{constructor(t,e,r,n){super(t),this.value=e,this.presetKey=r,this.last=null==n||n}}class i extends r{constructor(t,e,r){super(t),this.value=e,this.presetKey=r}}class o extends r{constructor(t,e){super(t),this.expanded=e}}class a extends r{constructor(t,e){super(t),this.index=e}}function s(t){return null==t}function l(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function u(t,e){let r=t;do{const t=Object.getOwnPropertyDescriptor(r,e);if(t&&(void 0!==t.set||!0===t.writable))return!0;r=Object.getPrototypeOf(r)}while(null!==r);return!1}const c={alreadydisposed:()=>"View has been already disposed",invalidparams:t=>`Invalid parameters for '${t.name}'`,nomatchingcontroller:t=>`No matching controller for '${t.key}'`,nomatchingview:t=>`No matching view for '${JSON.stringify(t.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:t=>`Property '${t.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class p{static alreadyDisposed(){return new p({type:"alreadydisposed"})}static notBindable(){return new p({type:"notbindable"})}static propertyNotFound(t){return new p({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new p({type:"shouldneverhappen"})}constructor(t){var e;this.message=null!==(e=c[t.type](t.context))&&void 0!==e?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}}class h{constructor(t,e,r){this.obj_=t,this.key_=e,this.presetKey_=null!=r?r:e}static isBindable(t){return null!==t&&"object"==typeof t}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(t){this.obj_[this.key_]=t}writeProperty(t,e){const r=this.read();if(!h.isBindable(r))throw p.notBindable();if(!(t in r))throw p.propertyNotFound(t);r[t]=e}}class d extends e{get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get title(){var t;return null!==(t=this.controller_.valueController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.valueController.props.set("title",t)}on(t,e){const n=e.bind(this);return this.controller_.valueController.emitter.on(t,()=>{n(new r(this))}),this}}class f{constructor(){this.observers_={}}on(t,e){let r=this.observers_[t];return r||(r=this.observers_[t]=[]),r.push({handler:e}),this}off(t,e){const r=this.observers_[t];return r&&(this.observers_[t]=r.filter(t=>t.handler!==e)),this}emit(t,e){const r=this.observers_[t];r&&r.forEach(t=>{t.handler(e)})}}const v="tp";function m(t){return(e,r)=>[v,"-",t,"v",e?"_"+e:"",r?"-"+r:""].join("")}function b(t){return t.rawValue}function g(t,e){var r,n;t.emitter.on("change",(r=b,n=e,t=>n(r(t)))),e(t.rawValue)}function w(t,e,r){g(t.value(e),r)}function y(t,e){return r=>{!function(t,e,r){r?t.classList.add(e):t.classList.remove(e)}(t,e,r)}}function _(t,e){g(t,t=>{e.textContent=null!=t?t:""})}const x=m("btn");class C{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(x()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("button");r.classList.add(x("b")),e.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const n=t.createElement("div");n.classList.add(x("t")),_(e.props.value("title"),n),this.buttonElement.appendChild(n)}}class k{constructor(t,e){this.emitter=new f,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new C(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class E{constructor(t,e){var r;this.constraint_=null==e?void 0:e.constraint,this.equals_=null!==(r=null==e?void 0:e.equals)&&void 0!==r?r:(t,e)=>t===e,this.emitter=new f,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const r=null!=e?e:{forceEmit:!1,last:!0},n=this.constraint_?this.constraint_.constrain(t):t,i=this.rawValue_;(!this.equals_(i,n)||r.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=n,this.emitter.emit("change",{options:r,previousRawValue:i,rawValue:n,sender:this}))}}class P{constructor(t){this.emitter=new f,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const r=null!=e?e:{forceEmit:!1,last:!0},n=this.value_;(n!==t||r.forceEmit)&&(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:r,previousRawValue:n,rawValue:this.value_,sender:this}))}}function A(t,e){const r=null==e?void 0:e.constraint,n=null==e?void 0:e.equals;return r||n?new E(t,e):new P(t)}class M{constructor(t){this.emitter=new f,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}static createCore(t){return Object.keys(t).reduce((e,r)=>Object.assign(e,{[r]:A(t[r])}),{})}static fromObject(t){const e=this.createCore(t);return new M(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}function V(t){return e=>r=>{if(!e&&void 0===r)return{succeeded:!1,value:void 0};if(e&&void 0===r)return{succeeded:!0,value:void 0};const n=t(r);return void 0!==n?{succeeded:!0,value:n}:{succeeded:!1,value:void 0}}}function S(t){return{custom:e=>V(e)(t),boolean:V(t=>"boolean"==typeof t?t:void 0)(t),number:V(t=>"number"==typeof t?t:void 0)(t),string:V(t=>"string"==typeof t?t:void 0)(t),function:V(t=>"function"==typeof t?t:void 0)(t),constant:e=>V(t=>t===e?e:void 0)(t),raw:V(t=>t)(t),object:e=>V(t=>{if(null!==(r=t)&&"object"==typeof r)return function(t,e){return Object.keys(e).reduce((r,n)=>{if(void 0===r)return;const i=(0,e[n])(t[n]);return i.succeeded?Object.assign(Object.assign({},r),{[n]:i.value}):void 0},{})}(t,e);var r})(t),array:e=>V(t=>{if(Array.isArray(t))return r=e,t.reduce((t,e)=>{if(void 0===t)return;const n=r(e);return n.succeeded&&void 0!==n.value?[...t,n.value]:void 0},[]);var r})(t)}}const D={optional:S(!0),required:S(!1)};function T(t,e){const r=D.required.object(e)(t);return r.succeeded?r.value:void 0}function L(t){console.warn([`Missing '${t.key}' of ${t.target} in ${t.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}class O{constructor(t){this.value_=t}static create(t){return[new O(t),(e,r)=>{t.setRawValue(e,r)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const j=m("");function B(t,e){return y(t,j(void 0,e))}class I extends M{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=O.create(A(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,r,n;const i=null!=t?t:{};return new I(M.createCore({disabled:null!==(e=i.disabled)&&void 0!==e&&e,disposed:!1,hidden:null!==(r=i.hidden)&&void 0!==r&&r,parent:null!==(n=i.parent)&&void 0!==n?n:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){g(this.globalDisabled_,B(t,"disabled")),w(this,"hidden",B(t,"hidden"))}bindDisabled(t){g(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){g(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}getGlobalDisabled_(){const t=this.get("parent");return!!t&&t.globalDisabled.rawValue||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const r=t.previousRawValue;null==r||r.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),null===(e=this.get("parent"))||void 0===e||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const R=m(""),F={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class U{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{["veryfirst","first","last","verylast"].forEach(t=>{e.classList.remove(R(void 0,F[t]))}),this.blade.get("positions").forEach(t=>{e.classList.add(R(void 0,F[t]))})}),this.viewProps.handleDispose(()=>{!function(t){t&&t.parentElement&&t.parentElement.removeChild(t)}(e)})}get parent(){return this.parent_}set parent(t){this.parent_=t,"parent"in this.viewProps.valMap_?this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null):L({key:"parent",target:I.name,place:"BladeController.parent"})}}const z="http://www.w3.org/2000/svg";function N(t){t.offsetHeight}function H(t){return void 0!==t.ontouchstart}const q={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function K(t,e){const r=t.createElementNS(z,"svg");return r.innerHTML=q[e],r}function G(t,e,r){t.insertBefore(e,t.children[r])}function $(t){t.parentElement&&t.parentElement.removeChild(t)}function W(t){for(;t.children.length>0;)t.removeChild(t.children[0])}function Y(t){return t.relatedTarget?t.relatedTarget:"explicitOriginalTarget"in t?t.explicitOriginalTarget:null}const Q=m("lbl");class X{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Q()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("div");r.classList.add(Q("l")),w(e.props,"label",e=>{s(e)?this.element.classList.add(Q(void 0,"nol")):(this.element.classList.remove(Q(void 0,"nol")),function(t){for(;t.childNodes.length>0;)t.removeChild(t.childNodes[0])}(r),r.appendChild(function(t,e){const r=t.createDocumentFragment();return e.split("\n").map(e=>t.createTextNode(e)).forEach((e,n)=>{n>0&&r.appendChild(t.createElement("br")),r.appendChild(e)}),r}(t,e)))}),this.element.appendChild(r),this.labelElement=r;const n=t.createElement("div");n.classList.add(Q("v")),this.element.appendChild(n),this.valueElement=n}}class J extends U{constructor(t,e){const r=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{view:new X(t,{props:e.props,viewProps:r}),viewProps:r})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const Z={id:"button",type:"blade",accept(t){const e=D,r=T(t,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return r?{params:r}:null},controller:t=>new J(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:new k(t.document,{props:M.fromObject({title:t.params.title}),viewProps:t.viewProps})}),api:t=>t.controller instanceof J&&t.controller.valueController instanceof k?new d(t.controller):null};class tt extends U{constructor(t){super(t),this.value=t.value}}function et(){return new M({positions:A([],{equals:l})})}class rt extends M{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},r=M.createCore(e);return new rt(r)}get styleExpanded(){var t;return null!==(t=this.get("temporaryExpanded"))&&void 0!==t?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!s(t)?t+"px":"auto"}bindExpandedClass(t,e){const r=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};w(this,"expanded",r),w(this,"temporaryExpanded",r)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function nt(t,e){e.style.height=t.styleHeight}function it(t,e){t.value("expanded").emitter.on("beforechange",()=>{if(t.set("completed",!1),s(t.get("expandedHeight"))){const r=function(t,e){let r=0;return function(n,i){const o=n.style.transition;n.style.transition="none",t.set("expandedHeight",null),t.set("temporaryExpanded",!0),N(e),r=e.clientHeight,t.set("temporaryExpanded",null),N(e),n.style.transition=o}(e),r}(t,e);r>0&&t.set("expandedHeight",r)}t.set("shouldFixHeight",!0),N(e)}),t.emitter.on("change",()=>{nt(t,e)}),nt(t,e),e.addEventListener("transitionend",e=>{"height"===e.propertyName&&t.cleanUpTransition()})}class ot extends e{constructor(t,e){super(t),this.rackApi_=e}}class at{constructor(t){this.emitter=new f,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw p.shouldNeverHappen();const r=void 0!==e?e:this.items_.length;this.items_.splice(r,0,t),this.cache_.add(t);const n=this.extract_(t);n&&(n.emitter.on("add",this.onSubListAdd_),n.emitter.on("remove",this.onSubListRemove_),n.allItems().forEach(t=>{this.cache_.add(t)})),this.emitter.emit("add",{index:r,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const r=this.extract_(t);r&&(r.emitter.off("add",this.onSubListAdd_),r.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}class st extends e{constructor(t){super(t),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new f,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(t){const e=t.sender.target.read();this.emitter_.emit("change",{event:new n(this,e,this.controller_.binding.target.presetKey,t.options.last)})}}class lt extends J{constructor(t,e){super(t,e),this.binding=e.binding}}class ut extends e{constructor(t){super(t),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new f,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(t){const e=t.sender.target.read();this.emitter_.emit("update",{event:new i(this,e,this.controller_.binding.target.presetKey)})}}class ct extends J{constructor(t,e){super(t,e),this.binding=e.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function pt(t){return t instanceof ft?t.apiSet_:t instanceof ot?t.rackApi_.apiSet_:null}function ht(t,e){const r=t.find(t=>t.controller_===e);if(!r)throw p.shouldNeverHappen();return r}function dt(t,e,r){if(!h.isBindable(t))throw p.notBindable();return new h(t,e,r)}class ft extends e{constructor(t,e){super(t),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new f,this.apiSet_=new at(pt),this.pool_=e;const r=this.controller_.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),r.emitter.on("inputchange",this.onRackInputChange_),r.emitter.on("monitorupdate",this.onRackMonitorUpdate_),r.children.forEach(t=>{this.setUpApi_(t)})}get children(){return this.controller_.rack.children.map(t=>ht(this.apiSet_,t))}addInput(t,e,r){const n=null!=r?r:{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createInput(i,dt(t,e,n.presetKey),n),a=new st(o);return this.add(a,n.index)}addMonitor(t,e,r){const n=null!=r?r:{},i=this.controller_.view.element.ownerDocument,o=this.pool_.createMonitor(i,dt(t,e),n),a=new ut(o);return this.add(a,n.index)}addFolder(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}(this,t)}addButton(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}(this,t)}addSeparator(t){return function(t,e){const r=null!=e?e:{};return t.addBlade(Object.assign(Object.assign({},r),{view:"separator"}))}(this,t)}addTab(t){return function(t,e){return t.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}(this,t)}add(t,e){this.controller_.rack.add(t.controller_,e);const r=this.apiSet_.find(e=>e.controller_===t.controller_);return r&&this.apiSet_.remove(r),this.apiSet_.add(t),t}remove(t){this.controller_.rack.remove(t.controller_)}addBlade(t){const e=this.controller_.view.element.ownerDocument,r=this.pool_.createBlade(e,t),n=this.pool_.createBladeApi(r);return this.add(n,t.index)}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}setUpApi_(t){this.apiSet_.find(e=>e.controller_===t)||this.apiSet_.add(this.pool_.createBladeApi(t))}onRackAdd_(t){this.setUpApi_(t.bladeController)}onRackRemove_(t){if(t.isRoot){const e=ht(this.apiSet_,t.bladeController);this.apiSet_.remove(e)}}onRackInputChange_(t){const e=t.bladeController;if(e instanceof lt){const r=ht(this.apiSet_,e),i=e.binding;this.emitter_.emit("change",{event:new n(r,i.target.read(),i.target.presetKey,t.options.last)})}else if(e instanceof tt){const r=ht(this.apiSet_,e);this.emitter_.emit("change",{event:new n(r,e.value.rawValue,void 0,t.options.last)})}}onRackMonitorUpdate_(t){if(!(t.bladeController instanceof ct))throw p.shouldNeverHappen();const e=ht(this.apiSet_,t.bladeController),r=t.bladeController.binding;this.emitter_.emit("update",{event:new i(e,r.target.read(),r.target.presetKey)})}}class vt extends ot{constructor(t,e){super(t,new ft(t.rackController,e)),this.emitter_=new f,this.controller_.foldable.value("expanded").emitter.on("change",t=>{this.emitter_.emit("fold",{event:new o(this,t.sender.rawValue)})}),this.rackApi_.on("change",t=>{this.emitter_.emit("change",{event:t})}),this.rackApi_.on("update",t=>{this.emitter_.emit("update",{event:t})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(t){this.controller_.foldable.set("expanded",t)}get title(){return this.controller_.props.get("title")}set title(t){this.controller_.props.set("title",t)}get children(){return this.rackApi_.children}addInput(t,e,r){return this.rackApi_.addInput(t,e,r)}addMonitor(t,e,r){return this.rackApi_.addMonitor(t,e,r)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}}class mt extends U{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}}class bt{constructor(t,e){const r=m(e.viewName);this.element=t.createElement("div"),this.element.classList.add(r()),e.viewProps.bindClassModifiers(this.element)}}function gt(t){return t instanceof _t?t.rack:t instanceof mt?t.rackController.rack:null}function wt(t){const e=gt(t);return e?e.bcSet_:null}class yt{constructor(t){var e,r;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new f,this.blade_=null!==(e=t.blade)&&void 0!==e?e:null,null===(r=this.blade_)||void 0===r||r.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new at(wt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var r;null===(r=t.parent)||void 0===r||r.remove(t),u(t,"parent")?t.parent=this:(t.parent_=this,L({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(t,e)}remove(t){u(t,"parent")?t.parent=null:(t.parent_=null,L({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter(e=>e instanceof t)}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,isRoot:e,sender:this}),!e)return;const r=t.item;if(r.viewProps.emitter.on("change",this.onChildViewPropsChange_),r.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),r.viewProps.handleDispose(this.onChildDispose_),r instanceof lt)r.binding.emitter.on("change",this.onChildInputChange_);else if(r instanceof ct)r.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(r instanceof tt)r.value.emitter.on("change",this.onChildValueChange_);else{const t=gt(r);if(t){const e=t.emitter;e.on("layout",this.onDescendantLayout_),e.on("inputchange",this.onDescendantInputChange_),e.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,isRoot:e,sender:this}),!e)return;const r=t.item;if(r instanceof lt)r.binding.emitter.off("change",this.onChildInputChange_);else if(r instanceof ct)r.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(r instanceof tt)r.value.emitter.off("change",this.onChildValueChange_);else{const t=gt(r);if(t){const e=t.emitter;e.off("layout",this.onDescendantLayout_),e.off("inputchange",this.onDescendantInputChange_),e.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const t=this.bcSet_.items.filter(t=>!t.viewProps.get("hidden")),e=t[0],r=t[t.length-1];this.bcSet_.items.forEach(t=>{const n=[];t===e&&(n.push("first"),this.blade_&&!this.blade_.get("positions").includes("veryfirst")||n.push("veryfirst")),t===r&&(n.push("last"),this.blade_&&!this.blade_.get("positions").includes("verylast")||n.push("verylast")),t.blade.set("positions",n)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildInputChange_(t){const e=function(t,e){for(let r=0;r<t.length;r++){const n=t[r];if(n instanceof lt&&n.binding===e)return n}return null}(this.find(lt),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onChildMonitorUpdate_(t){const e=function(t,e){for(let r=0;r<t.length;r++){const n=t[r];if(n instanceof ct&&n.binding===e)return n}return null}(this.find(ct),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:e,sender:this})}onChildValueChange_(t){const e=function(t,e){for(let r=0;r<t.length;r++){const n=t[r];if(n instanceof tt&&n.value===e)return n}return null}(this.find(tt),t.sender);if(!e)throw p.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:e,options:t.options,sender:this})}onDescendantLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(t){this.emitter.emit("inputchange",{bladeController:t.bladeController,options:t.options,sender:this})}onDescendantMonitorUpdate_(t){this.emitter.emit("monitorupdate",{bladeController:t.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class _t extends U{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new bt(t,{viewName:"brk",viewProps:e.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=new yt({blade:e.root?void 0:e.blade,viewProps:e.viewProps});r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.rack=r,this.viewProps.handleDispose(()=>{for(let t=this.rack.children.length-1;t>=0;t--)this.rack.children[t].viewProps.set("disposed",!0)})}onRackAdd_(t){t.isRoot&&G(this.view.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.isRoot&&$(t.bladeController.view.element)}}const xt=m("cnt");class Ct{constructor(t,e){var r;this.className_=m(null!==(r=e.viewName)&&void 0!==r?r:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),xt()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),w(this.foldable_,"completed",y(this.element,this.className_(void 0,"cpl")));const n=t.createElement("button");n.classList.add(this.className_("b")),w(e.props,"title",t=>{s(t)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n;const i=t.createElement("div");i.classList.add(this.className_("i")),this.element.appendChild(i);const o=t.createElement("div");o.classList.add(this.className_("t")),_(e.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const a=t.createElement("div");a.classList.add(this.className_("m")),this.buttonElement.appendChild(a);const l=e.containerElement;l.classList.add(this.className_("c")),this.element.appendChild(l),this.containerElement=l}}class kt extends mt{constructor(t,e){var r;const n=rt.create(null===(r=e.expanded)||void 0===r||r),i=new _t(t,{blade:e.blade,root:e.root,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:i,view:new Ct(t,{containerElement:i.view.element,foldable:n,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=n,it(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Et={id:"folder",type:"blade",accept(t){const e=D,r=T(t,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return r?{params:r}:null},controller:t=>new kt(t.document,{blade:t.blade,expanded:t.params.expanded,props:M.fromObject({title:t.params.title}),viewProps:t.viewProps}),api:t=>t.controller instanceof kt?new vt(t.controller,t.pool):null};class Pt extends tt{constructor(t,e){const r=e.valueController.viewProps;super(Object.assign(Object.assign({},e),{value:e.valueController.value,view:new X(t,{props:e.props,viewProps:r}),viewProps:r})),this.props=e.props,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class At extends e{}const Mt=m("spr");class Vt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Mt()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("hr");r.classList.add(Mt("r")),this.element.appendChild(r)}}class St extends U{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new Vt(t,{viewProps:e.viewProps})}))}}const Dt={id:"separator",type:"blade",accept(t){const e=T(t,{view:D.required.constant("separator")});return e?{params:e}:null},controller:t=>new St(t.document,{blade:t.blade,viewProps:t.viewProps}),api:t=>t.controller instanceof St?new At(t.controller):null},Tt=m("tbi");class Lt{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Tt()),e.viewProps.bindClassModifiers(this.element),w(e.props,"selected",t=>{t?this.element.classList.add(Tt(void 0,"sel")):this.element.classList.remove(Tt(void 0,"sel"))});const r=t.createElement("button");r.classList.add(Tt("b")),e.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const n=t.createElement("div");n.classList.add(Tt("t")),_(e.props.value("title"),n),this.buttonElement.appendChild(n),this.titleElement=n}}class Ot{constructor(t,e){this.emitter=new f,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Lt(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class jt{constructor(t,e){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Ot(t,{props:e.itemProps,viewProps:I.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new _t(t,{blade:et(),viewProps:I.create()}),this.props=e.props,w(this.props,"selected",t=>{this.itemController.props.set("selected",t),this.contentController.viewProps.set("hidden",!t)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Bt{constructor(t,e){this.controller_=t,this.rackApi_=e}get title(){var t;return null!==(t=this.controller_.itemController.props.get("title"))&&void 0!==t?t:""}set title(t){this.controller_.itemController.props.set("title",t)}get selected(){return this.controller_.props.get("selected")}set selected(t){this.controller_.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addSeparator(t){return this.rackApi_.addSeparator(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addInput(t,e,r){return this.rackApi_.addInput(t,e,r)}addMonitor(t,e,r){return this.rackApi_.addMonitor(t,e,r)}addBlade(t){return this.rackApi_.addBlade(t)}}class It extends ot{constructor(t,e){super(t,new ft(t.rackController,e)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new f,this.pageApiMap_=new Map,this.rackApi_.on("change",t=>{this.emitter_.emit("change",{event:t})}),this.rackApi_.on("update",t=>{this.emitter_.emit("update",{event:t})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(t=>{this.setUpPageApi_(t)})}get pages(){return this.controller_.pageSet.items.map(t=>{const e=this.pageApiMap_.get(t);if(!e)throw p.shouldNeverHappen();return e})}addPage(t){const e=this.controller_.view.element.ownerDocument,r=new jt(e,{itemProps:M.fromObject({selected:!1,title:t.title}),props:M.fromObject({selected:!1})});this.controller_.add(r,t.index);const n=this.pageApiMap_.get(r);if(!n)throw p.shouldNeverHappen();return n}removePage(t){this.controller_.remove(t)}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}setUpPageApi_(t){const e=this.rackApi_.apiSet_.find(e=>e.controller_===t.contentController);if(!e)throw p.shouldNeverHappen();const r=new Bt(t,e);this.pageApiMap_.set(t,r)}onPageAdd_(t){this.setUpPageApi_(t.item)}onPageRemove_(t){if(!this.pageApiMap_.get(t.item))throw p.shouldNeverHappen();this.pageApiMap_.delete(t.item)}onSelect_(t){this.emitter_.emit("select",{event:new a(this,t.rawValue)})}}class Rt{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=A(!0),this.selectedIndex=A(-1),this.items_=[]}add(t,e){const r=null!=e?e:this.items_.length;this.items_.splice(r,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(0===this.items_.length)return this.selectedIndex.rawValue=-1,void(this.empty.rawValue=!0);const t=this.items_.findIndex(t=>t.rawValue);t<0?(this.items_.forEach((t,e)=>{t.rawValue=0===e}),this.selectedIndex.rawValue=0):(this.items_.forEach((e,r)=>{e.rawValue=r===t}),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex(e=>e===t.sender);this.items_.forEach((t,r)=>{t.rawValue=r===e}),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const Ft=m("tab");class Ut{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ft(),xt()),e.viewProps.bindClassModifiers(this.element),g(e.empty,y(this.element,Ft(void 0,"nop")));const r=t.createElement("div");r.classList.add(Ft("t")),this.element.appendChild(r),this.itemsElement=r;const n=t.createElement("div");n.classList.add(Ft("i")),this.element.appendChild(n);const i=e.contentsElement;i.classList.add(Ft("c")),this.element.appendChild(i),this.contentsElement=i}}class zt extends mt{constructor(t,e){const r=new _t(t,{blade:e.blade,viewProps:e.viewProps}),n=new Rt;super({blade:e.blade,rackController:r,view:new Ut(t,{contentsElement:r.view.element,empty:n.empty,viewProps:e.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new at(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=n}get pageSet(){return this.pageSet_}add(t,e){this.pageSet_.add(t,e)}remove(t){this.pageSet_.remove(this.pageSet_.items[t])}onPageAdd_(t){const e=t.item;G(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(e.contentController,t.index),this.tab.add(e.props.value("selected"))}onPageRemove_(t){const e=t.item;$(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.rackController.rack.remove(e.contentController),this.tab.remove(e.props.value("selected"))}}const Nt={id:"tab",type:"blade",accept(t){const e=D,r=T(t,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return r&&0!==r.pages.length?{params:r}:null},controller(t){const e=new zt(t.document,{blade:t.blade,viewProps:t.viewProps});return t.params.pages.forEach(r=>{const n=new jt(t.document,{itemProps:M.fromObject({selected:!1,title:r.title}),props:M.fromObject({selected:!1})});e.add(n)}),e},api:t=>t.controller instanceof zt?new It(t.controller,t.pool):null};class Ht{constructor(){this.disabled=!1,this.emitter=new f}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class qt{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new f,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(null===this.timerId_)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Kt{constructor(t){this.onValueChange_=this.onValueChange_.bind(this),this.reader=t.reader,this.writer=t.writer,this.emitter=new f,this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.target=t.target,this.read()}read(){const t=this.target.read();void 0!==t&&(this.value.rawValue=this.reader(t))}write_(t){this.writer(this.target,t)}onValueChange_(t){this.write_(t.rawValue),this.emitter.emit("change",{options:t.options,rawValue:t.rawValue,sender:this})}}function Gt(t,e){for(;t.length<e;)t.push(void 0)}function $t(t){const e=[];return Gt(e,t),A(e)}function Wt(t){const e=t.indexOf(void 0);return e<0?t:t.slice(0,e)}class Yt{constructor(t){this.onTick_=this.onTick_.bind(this),this.reader_=t.reader,this.target=t.target,this.emitter=new f,this.value=t.value,this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const t=this.target.read();if(void 0===t)return;const e=this.value.rawValue,r=this.reader_(t);this.value.rawValue=function(t,e){const r=[...Wt(t),e];return r.length>t.length?r.splice(0,r.length-t.length):Gt(r,t.length),r}(e,r),this.emitter.emit("update",{rawValue:r,sender:this})}onTick_(t){this.read()}}class Qt{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((t,e)=>e.constrain(t),t)}}function Xt(t,e){if(t instanceof e)return t;if(t instanceof Qt){const r=t.constraints.reduce((t,r)=>t||(r instanceof e?r:null),null);if(r)return r}return null}class Jt{constructor(t){this.values=M.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),r=this.values.get("min");return Math.min(Math.max(t,r),e)}}class Zt{constructor(t){this.values=M.fromObject({options:t})}get options(){return this.values.get("options")}constrain(t){const e=this.values.get("options");return 0===e.length||e.filter(e=>e.value===t).length>0?t:e[0].value}}class te{constructor(t){this.values=M.fromObject({max:t.max,min:t.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(t){const e=this.values.get("max"),r=this.values.get("min");let n=t;return s(r)||(n=Math.max(n,r)),s(e)||(n=Math.min(n,e)),n}}class ee{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step;return e+Math.round((t-e)/this.step)*this.step}}const re=m("lst");class ne{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(re()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("select");r.classList.add(re("s")),w(this.props_,"options",e=>{W(r),e.forEach((e,n)=>{const i=t.createElement("option");i.dataset.index=String(n),i.textContent=e.text,i.value=String(e.value),r.appendChild(i)})}),e.viewProps.bindDisabled(r),this.element.appendChild(r),this.selectElement=r;const n=t.createElement("div");n.classList.add(re("m")),n.appendChild(K(t,"dropdown")),this.element.appendChild(n),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class ie{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ne(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget.selectedOptions.item(0);if(!e)return;const r=Number(e.dataset.index);this.value.rawValue=this.props.get("options")[r].value}}const oe=m("pop");class ae{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(oe()),e.viewProps.bindClassModifiers(this.element),g(e.shows,y(this.element,oe(void 0,"v")))}}class se{constructor(t,e){this.shows=A(!1),this.viewProps=e.viewProps,this.view=new ae(t,{shows:this.shows,viewProps:this.viewProps})}}const le=m("txt");class ue{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(le()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const r=t.createElement("input");r.classList.add(le("i")),r.type="text",e.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class ce{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ue(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget.value,r=this.parser_(e);s(r)||(this.value.rawValue=r),this.view.refresh()}}function pe(t){return"false"!==t&&!!t}function he(t){return function(t){return String(t)}(t)}class de{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const fe={"**":(t,e)=>Math.pow(t,e),"*":(t,e)=>t*e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e,"&":(t,e)=>t&e,"^":(t,e)=>t^e,"|":(t,e)=>t|e};class ve{constructor(t,e,r){this.left=e,this.operator=t,this.right=r}evaluate(){const t=fe[this.operator];if(!t)throw new Error("unexpected binary operator: '"+this.operator);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const me={"+":t=>t,"-":t=>-t,"~":t=>~t};class be{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=me[this.operator];if(!t)throw new Error("unexpected unary operator: '"+this.operator);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ge(t){return(e,r)=>{for(let n=0;n<t.length;n++){const i=t[n](e,r);if(""!==i)return i}return""}}function we(t,e){var r;const n=t.substr(e).match(/^\s+/);return null!==(r=n&&n[0])&&void 0!==r?r:""}function ye(t,e){var r;const n=t.substr(e).match(/^[0-9]+/);return null!==(r=n&&n[0])&&void 0!==r?r:""}function _e(t,e){const r=t.substr(e,1);if(e+=1,"e"!==r.toLowerCase())return"";const n=function(t,e){const r=ye(t,e);if(""!==r)return r;const n=t.substr(e,1);if("-"!==n&&"+"!==n)return"";const i=ye(t,e+=1);return""===i?"":n+i}(t,e);return""===n?"":r+n}function xe(t,e){const r=t.substr(e,1);if("0"===r)return r;const n=function(t,e){const r=t.substr(e,1);return r.match(/^[1-9]$/)?r:""}(t,e);return e+=n.length,""===n?"":n+ye(t,e)}const Ce=ge([function(t,e){const r=xe(t,e);if(e+=r.length,""===r)return"";const n=t.substr(e,1);if(e+=n.length,"."!==n)return"";const i=ye(t,e);return r+n+i+_e(t,e+=i.length)},function(t,e){const r=t.substr(e,1);if(e+=r.length,"."!==r)return"";const n=ye(t,e);return e+=n.length,""===n?"":r+n+_e(t,e)},function(t,e){const r=xe(t,e);return e+=r.length,""===r?"":r+_e(t,e)}]),ke=ge([function(t,e){const r=t.substr(e,2);if(e+=r.length,"0b"!==r.toLowerCase())return"";const n=function(t,e){var r;const n=t.substr(e).match(/^[01]+/);return null!==(r=n&&n[0])&&void 0!==r?r:""}(t,e);return""===n?"":r+n},function(t,e){const r=t.substr(e,2);if(e+=r.length,"0o"!==r.toLowerCase())return"";const n=function(t,e){var r;const n=t.substr(e).match(/^[0-7]+/);return null!==(r=n&&n[0])&&void 0!==r?r:""}(t,e);return""===n?"":r+n},function(t,e){const r=t.substr(e,2);if(e+=r.length,"0x"!==r.toLowerCase())return"";const n=function(t,e){var r;const n=t.substr(e).match(/^[0-9a-f]+/i);return null!==(r=n&&n[0])&&void 0!==r?r:""}(t,e);return""===n?"":r+n}]),Ee=ge([ke,Ce]);function Pe(t,e,r){r+=we(e,r).length;const n=t.filter(t=>e.startsWith(t,r))[0];return n?(r+=n.length,{cursor:r+=we(e,r).length,operator:n}):null}const Ae=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((t,e)=>function(t,e){return(r,n)=>{const i=t(r,n);if(!i)return null;n=i.cursor;let o=i.evaluable;for(;;){const i=Pe(e,r,n);if(!i)break;n=i.cursor;const a=t(r,n);if(!a)return null;n=a.cursor,o=new ve(i.operator,o,a.evaluable)}return o?{cursor:n,evaluable:o}:null}}(t,e),(function t(e,r){const n=function(t,e){var r;return null!==(r=function(t,e){const r=Ee(t,e);return e+=r.length,""===r?null:{evaluable:new de(r),cursor:e}}(t,e))&&void 0!==r?r:function(t,e){const r=t.substr(e,1);if(e+=r.length,"("!==r)return null;const n=Me(t,e);if(!n)return null;e=n.cursor,e+=we(t,e).length;const i=t.substr(e,1);return e+=i.length,")"!==i?null:{evaluable:n.evaluable,cursor:e}}(t,e)}(e,r);if(n)return n;const i=e.substr(r,1);if(r+=i.length,"+"!==i&&"-"!==i&&"~"!==i)return null;const o=t(e,r);return o?{cursor:r=o.cursor,evaluable:new be(i,o.evaluable)}:null}));function Me(t,e){return e+=we(t,e).length,Ae(t,e)}function Ve(t){var e;const r=function(t){const e=Me(t,0);return e?e.cursor+we(t,e.cursor).length!==t.length?null:e.evaluable:null}(t);return null!==(e=null==r?void 0:r.evaluate())&&void 0!==e?e:null}function Se(t){if("number"==typeof t)return t;if("string"==typeof t){const e=Ve(t);if(!s(e))return e}return 0}function De(t){return String(t)}function Te(t){return e=>e.toFixed(Math.max(Math.min(t,20),0))}const Le=Te(0);function Oe(t){return Le(t)+"%"}function je(t){return String(t)}function Be(t){return t}function Ie({primary:t,secondary:e,forward:r,backward:n}){let i=!1;function o(t){i||(i=!0,t(),i=!1)}t.emitter.on("change",n=>{o(()=>{e.setRawValue(r(t,e),n.options)})}),e.emitter.on("change",i=>{o(()=>{t.setRawValue(n(t,e),i.options)}),o(()=>{e.setRawValue(r(t,e),i.options)})}),o(()=>{e.setRawValue(r(t,e),{forceEmit:!1,last:!0})})}function Re(t,e){const r=t*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+r:e.downKey?-r:0}function Fe(t){return{altKey:t.altKey,downKey:"ArrowDown"===t.key,shiftKey:t.shiftKey,upKey:"ArrowUp"===t.key}}function Ue(t){return{altKey:t.altKey,downKey:"ArrowLeft"===t.key,shiftKey:t.shiftKey,upKey:"ArrowRight"===t.key}}function ze(t){return function(t){return"ArrowUp"===t||"ArrowDown"===t}(t)||"ArrowLeft"===t||"ArrowRight"===t}function Ne(t,e){var r,n;const i=e.ownerDocument.defaultView,o=e.getBoundingClientRect();return{x:t.pageX-((null!==(r=i&&i.scrollX)&&void 0!==r?r:0)+o.left),y:t.pageY-((null!==(n=i&&i.scrollY)&&void 0!==n?n:0)+o.top)}}class He{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new f,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),null===(e=t.currentTarget)||void 0===e||e.focus();const r=this.elem_.ownerDocument;r.addEventListener("mousemove",this.onDocumentMouseMove_),r.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Ne(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Ne(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Ne(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-r.left,y:e.clientY-r.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-r.left,y:e.clientY-r.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const r=null!==(e=t.targetTouches.item(0))&&void 0!==e?e:this.lastTouch_,n=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(r?{x:r.clientX-n.left,y:r.clientY-n.top}:void 0),sender:this,shiftKey:t.shiftKey})}}function qe(t,e,r,n,i){return n+(t-e)/(r-e)*(i-n)}function Ke(t){return String(t.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Ge(t,e,r){return Math.min(Math.max(t,e),r)}function $e(t,e){return(t%e+e)%e}const We=m("txt");class Ye{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(We(),We(void 0,"num")),e.arrayPosition&&this.element.classList.add(We(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("input");r.classList.add(We("i")),r.type="text",e.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(We()),this.inputElement.classList.add(We("i"));const n=t.createElement("div");n.classList.add(We("k")),this.element.appendChild(n),this.knobElement=n;const i=t.createElementNS(z,"svg");i.classList.add(We("g")),this.knobElement.appendChild(i);const o=t.createElementNS(z,"path");o.classList.add(We("gb")),i.appendChild(o),this.guideBodyElem_=o;const a=t.createElementNS(z,"path");a.classList.add(We("gh")),i.appendChild(a),this.guideHeadElem_=a;const s=t.createElement("div");s.classList.add(m("tt")()),this.knobElement.appendChild(s),this.tooltipElem_=s,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(null===t.rawValue)return void this.element.classList.remove(We(void 0,"drg"));this.element.classList.add(We(void 0,"drg"));const e=t.rawValue/this.props_.get("draggingScale"),r=e+(e>0?-1:e<0?1:0),n=Ge(-r,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${r+n},0 L${r},4 L${r+n},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const i=this.props_.get("formatter");this.tooltipElem_.textContent=i(this.value.rawValue),this.tooltipElem_.style.left=e+"px"}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Qe{constructor(t,e){var r;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.parser_=e.parser,this.props=e.props,this.sliderProps_=null!==(r=e.sliderProps)&&void 0!==r?r:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=A(null),this.view=new Ye(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const n=new He(this.view.knobElement);n.emitter.on("down",this.onPointerDown_),n.emitter.on("move",this.onPointerMove_),n.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,r;const n=null===(e=this.sliderProps_)||void 0===e?void 0:e.get("minValue"),i=null===(r=this.sliderProps_)||void 0===r?void 0:r.get("maxValue");let o=t;return void 0!==n&&(o=Math.max(o,n)),void 0!==i&&(o=Math.min(o,i)),o}onInputChange_(t){const e=t.currentTarget.value,r=this.parser_(e);s(r)||(this.value.rawValue=this.constrainValue_(r)),this.view.refresh()}onInputKeyDown_(t){const e=Re(this.baseStep_,Fe(t));0!==e&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){0!==Re(this.baseStep_,Fe(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("draggingScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);null!==e&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Xe=m("sld");class Je{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Xe()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("div");r.classList.add(Xe("t")),e.viewProps.bindTabIndex(r),this.element.appendChild(r),this.trackElement=r;const n=t.createElement("div");n.classList.add(Xe("k")),this.trackElement.appendChild(n),this.knobElement=n,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=Ge(qe(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=t+"%"}onChange_(){this.update_()}}class Ze{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=e.baseStep,this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new Je(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new He(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(qe(Ge(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Re(this.baseStep_,Ue(t));0!==e&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Re(this.baseStep_,Ue(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const tr=m("sldtxt");class er{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(tr());const r=t.createElement("div");r.classList.add(tr("s")),this.sliderView_=e.sliderView,r.appendChild(this.sliderView_.element),this.element.appendChild(r);const n=t.createElement("div");n.classList.add(tr("t")),this.textView_=e.textView,n.appendChild(this.textView_.element),this.element.appendChild(n)}}class rr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new Ze(t,{baseStep:e.baseStep,props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Qe(t,{baseStep:e.baseStep,parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new er(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function nr(t,e){t.write(e)}function ir(t){const e=D;return Array.isArray(t)?e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(t).value:"object"==typeof t?e.required.raw(t).value:void 0}function or(t){if("inline"===t||"popup"===t)return t}function ar(t){const e=D;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(t).value}function sr(t){if(Array.isArray(t))return t;const e=[];return Object.keys(t).forEach(r=>{e.push({text:r,value:t[r]})}),e}function lr(t){return s(t)?null:new Zt(sr(t))}function ur(t,e){const r=t&&Xt(t,ee);return r?Ke(r.step):Math.max(Ke(e),2)}function cr(t){const e=function(t){const e=t?Xt(t,ee):null;return e?e.step:null}(t);return null!=e?e:1}function pr(t,e){var r;const n=t&&Xt(t,ee),i=Math.abs(null!==(r=null==n?void 0:n.step)&&void 0!==r?r:e);return 0===i?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}const hr=m("ckb");class dr{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(hr()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("label");r.classList.add(hr("l")),this.element.appendChild(r);const n=t.createElement("input");n.classList.add(hr("i")),n.type="checkbox",r.appendChild(n),this.inputElement=n,e.viewProps.bindDisabled(this.inputElement);const i=t.createElement("div");i.classList.add(hr("w")),r.appendChild(i);const o=K(t,"check");i.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class fr{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new dr(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}}const vr={id:"input-bool",type:"input",accept:(t,e)=>{if("boolean"!=typeof t)return null;const r=T(e,{options:D.optional.custom(ir)});return r?{initialValue:t,params:r}:null},binding:{reader:t=>pe,constraint:t=>function(t){const e=[],r=lr(t.options);return r&&e.push(r),new Qt(e)}(t.params),writer:t=>nr},controller:t=>{const e=t.document,r=t.value,n=t.constraint,i=n&&Xt(n,Zt);return i?new ie(e,{props:new M({options:i.values.value("options")}),value:r,viewProps:t.viewProps}):new fr(e,{value:r,viewProps:t.viewProps})}},mr=m("col");class br{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(mr()),e.foldable.bindExpandedClass(this.element,mr(void 0,"expanded")),w(e.foldable,"completed",y(this.element,mr(void 0,"cpl")));const r=t.createElement("div");r.classList.add(mr("h")),this.element.appendChild(r);const n=t.createElement("div");n.classList.add(mr("s")),r.appendChild(n),this.swatchElement=n;const i=t.createElement("div");if(i.classList.add(mr("t")),r.appendChild(i),this.textElement=i,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(mr("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}function gr(t,e,r){const n=$e(t,360),i=Ge(e/100,0,1),o=Ge(r/100,0,1),a=o*i,s=a*(1-Math.abs(n/60%2-1)),l=o-a;let u,c,p;return[u,c,p]=n>=0&&n<60?[a,s,0]:n>=60&&n<120?[s,a,0]:n>=120&&n<180?[0,a,s]:n>=180&&n<240?[0,s,a]:n>=240&&n<300?[s,0,a]:[a,0,s],[255*(u+l),255*(c+l),255*(p+l)]}function wr(t){return[t[0],t[1],t[2]]}function yr(t,e){return[t[0],t[1],t[2],e]}const _r={hsl:{hsl:(t,e,r)=>[t,e,r],hsv:function(t,e,r){const n=r+e*(100-Math.abs(2*r-100))/200;return[t,0!==n?e*(100-Math.abs(2*r-100))/n:0,r+e*(100-Math.abs(2*r-100))/200]},rgb:function(t,e,r){const n=(t%360+360)%360,i=Ge(e/100,0,1),o=Ge(r/100,0,1),a=(1-Math.abs(2*o-1))*i,s=a*(1-Math.abs(n/60%2-1)),l=o-a/2;let u,c,p;return[u,c,p]=n>=0&&n<60?[a,s,0]:n>=60&&n<120?[s,a,0]:n>=120&&n<180?[0,a,s]:n>=180&&n<240?[0,s,a]:n>=240&&n<300?[s,0,a]:[a,0,s],[255*(u+l),255*(c+l),255*(p+l)]}},hsv:{hsl:function(t,e,r){const n=100-Math.abs(r*(200-e)/100-100);return[t,0!==n?e*r/n:0,r*(200-e)/200]},hsv:(t,e,r)=>[t,e,r],rgb:gr},rgb:{hsl:function(t,e,r){const n=Ge(t/255,0,1),i=Ge(e/255,0,1),o=Ge(r/255,0,1),a=Math.max(n,i,o),s=Math.min(n,i,o),l=a-s;let u=0,c=0;const p=(s+a)/2;return 0!==l&&(c=l/(1-Math.abs(a+s-1)),u=(u=n===a?(i-o)/l:i===a?2+(o-n)/l:4+(n-i)/l)/6+(u<0?1:0)),[360*u,100*c,100*p]},hsv:function(t,e,r){const n=Ge(t/255,0,1),i=Ge(e/255,0,1),o=Ge(r/255,0,1),a=Math.max(n,i,o),s=a-Math.min(n,i,o);let l;return[l=0===s?0:a===n?((i-o)/s%6+6)%6*60:a===i?60*((o-n)/s+2):60*((n-i)/s+4),100*(0===a?0:s/a),100*a]},rgb:(t,e,r)=>[t,e,r]}};function xr(t,e){return["float"===e?1:"rgb"===t?255:360,"float"===e?1:"rgb"===t?255:100,"float"===e?1:"rgb"===t?255:100]}function Cr(t,e,r,n){const i=xr(e,r),o=xr(e,n);return t.map((t,e)=>t/i[e]*o[e])}function kr(t,e){return"object"==typeof t&&!s(t)&&e in t&&"number"==typeof t[e]}class Er{static black(t="int"){return new Er([0,0,0],"rgb",t)}static fromObject(t,e="int"){const r="a"in t?[t.r,t.g,t.b,t.a]:[t.r,t.g,t.b];return new Er(r,"rgb",e)}static toRgbaObject(t,e="int"){return t.toRgbaObject(e)}static isRgbColorObject(t){return kr(t,"r")&&kr(t,"g")&&kr(t,"b")}static isRgbaColorObject(t){return this.isRgbColorObject(t)&&kr(t,"a")}static isColorObject(t){return this.isRgbColorObject(t)}static equals(t,e){if(t.mode!==e.mode)return!1;const r=t.comps_,n=e.comps_;for(let i=0;i<r.length;i++)if(r[i]!==n[i])return!1;return!0}constructor(t,e,r="int"){this.mode=e,this.type=r,this.comps_=function(t,e,r){var n;const i=xr(e,r);return["rgb"===e?Ge(t[0],0,i[0]):(o=t[0],a=i[0],o===a?a:$e(o,a)),Ge(t[1],0,i[1]),Ge(t[2],0,i[2]),Ge(null!==(n=t[3])&&void 0!==n?n:1,0,1)];var o,a}(t,e,r)}getComponents(t,e="int"){return yr(function(t,e,r){const n=Cr(t,e.mode,e.type,"int");return Cr(_r[e.mode][r.mode](...n),r.mode,"int",r.type)}(wr(this.comps_),{mode:this.mode,type:this.type},{mode:null!=t?t:this.mode,type:e}),this.comps_[3])}toRgbaObject(t="int"){const e=this.getComponents("rgb",t);return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Pr=m("colp");class Ar{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(Pr()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("div");r.classList.add(Pr("hsv"));const n=t.createElement("div");n.classList.add(Pr("sv")),this.svPaletteView_=e.svPaletteView,n.appendChild(this.svPaletteView_.element),r.appendChild(n);const i=t.createElement("div");i.classList.add(Pr("h")),this.hPaletteView_=e.hPaletteView,i.appendChild(this.hPaletteView_.element),r.appendChild(i),this.element.appendChild(r);const o=t.createElement("div");if(o.classList.add(Pr("rgb")),this.textView_=e.textView,o.appendChild(this.textView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const r=t.createElement("div");r.classList.add(Pr("a"));const n=t.createElement("div");n.classList.add(Pr("ap")),n.appendChild(this.alphaViews_.palette.element),r.appendChild(n);const i=t.createElement("div");i.classList.add(Pr("at")),i.appendChild(this.alphaViews_.text.element),r.appendChild(i),this.element.appendChild(r)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(t=>t.inputElement)];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Mr(t){return"int"===t?"int":"float"===t?"float":void 0}function Vr(t){const e=D;return T(t,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Mr)}),expanded:e.optional.boolean,picker:e.optional.custom(or)})}function Sr(t){return t?.1:1}function Dr(t){var e;return null===(e=t.color)||void 0===e?void 0:e.type}function Tr(t,e){const r=t.match(/^(.+)%$/);return r?Math.min(.01*parseFloat(r[1])*e,e):Math.min(parseFloat(t),e)}const Lr={deg:t=>t,grad:t=>360*t/400,rad:t=>360*t/(2*Math.PI),turn:t=>360*t};function Or(t){const e=t.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(t);const r=parseFloat(e[1]),n=e[2];return Lr[n](r)}function jr(t){const e=t.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const r=[Tr(e[1],255),Tr(e[2],255),Tr(e[3],255)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function Br(t){return e=>{const r=jr(e);return r?new Er(r,"rgb",t):null}}function Ir(t){const e=t.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const r=[Tr(e[1],255),Tr(e[2],255),Tr(e[3],255),Tr(e[4],1)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])?null:r}function Rr(t){return e=>{const r=Ir(e);return r?new Er(r,"rgb",t):null}}function Fr(t){const e=t.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const r=[Or(e[1]),Tr(e[2],100),Tr(e[3],100)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function Ur(t){return e=>{const r=Fr(e);return r?new Er(r,"hsl",t):null}}function zr(t){const e=t.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const r=[Or(e[1]),Tr(e[2],100),Tr(e[3],100),Tr(e[4],1)];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])?null:r}function Nr(t){return e=>{const r=zr(e);return r?new Er(r,"hsl",t):null}}function Hr(t){const e=t.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const r=t.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]:null}function qr(t){const e=t.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),qe(parseInt(e[4]+e[4],16),0,255,0,1)];const r=t.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16),qe(parseInt(r[4],16),0,255,0,1)]:null}function Kr(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const r=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function Gr(t){return e=>{const r=Kr(e);return r?new Er(r,"rgb",t):null}}function $r(t){const e=t.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const r=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])?null:r}function Wr(t){return e=>{const r=$r(e);return r?new Er(r,"rgb",t):null}}const Yr=[{parser:Hr,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:qr,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:jr,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Ir,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Fr,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:zr,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Kr,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:$r,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Qr(t,e="int"){const r=function(t){return Yr.reduce((e,{parser:r,result:n})=>e||(r(t)?n:null),null)}(t);return r?"hex"===r.notation&&"float"!==e?Object.assign(Object.assign({},r),{type:"int"}):"func"===r.notation?Object.assign(Object.assign({},r),{type:e}):null:null}const Xr={int:[function(t){const e=Hr(t);return e?new Er(e,"rgb","int"):null},function(t){const e=qr(t);return e?new Er(e,"rgb","int"):null},Br("int"),Rr("int"),Ur("int"),Nr("int"),Gr("int"),Wr("int")],float:[Br("float"),Rr("float"),Ur("float"),Nr("float"),Gr("float"),Wr("float")]};function Jr(t){const e=Xr[t];return t=>e.reduce((e,r)=>e||r(t),null)}function Zr(t){const e=Ge(Math.floor(t),0,255).toString(16);return 1===e.length?"0"+e:e}function tn(t,e="#"){return`${e}${wr(t.getComponents("rgb")).map(Zr).join("")}`}function en(t,e="#"){const r=t.getComponents("rgb");return`${e}${[r[0],r[1],r[2],255*r[3]].map(Zr).join("")}`}function rn(t,e){const r=Te("float"===e?2:0);return`rgb(${wr(t.getComponents("rgb",e)).map(t=>r(t)).join(", ")})`}function nn(t){return e=>rn(e,t)}function on(t,e){const r=Te(2),n=Te("float"===e?2:0);return`rgba(${t.getComponents("rgb",e).map((t,e)=>(3===e?r:n)(t)).join(", ")})`}function an(t){return e=>on(e,t)}function sn(t,e){const r=Te("float"===e?2:0),n=["r","g","b"];return`{${wr(t.getComponents("rgb",e)).map((t,e)=>`${n[e]}: ${r(t)}`).join(", ")}}`}function ln(t){return e=>sn(e,t)}function un(t,e){const r=Te(2),n=Te("float"===e?2:0),i=["r","g","b","a"];return`{${t.getComponents("rgb",e).map((t,e)=>`${i[e]}: ${(3===e?r:n)(t)}`).join(", ")}}`}function cn(t){return e=>un(e,t)}const pn=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:tn},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:en},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:function(t){const e=[Te(0),Oe,Oe];return`hsl(${wr(t.getComponents("hsl")).map((t,r)=>e[r](t)).join(", ")})`}},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:function(t){const e=[Te(0),Oe,Oe,Te(2)];return`hsla(${t.getComponents("hsl").map((t,r)=>e[r](t)).join(", ")})`}},...["int","float"].reduce((t,e)=>[...t,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:nn(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:an(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:ln(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:cn(e)}],[])];function hn(t){return pn.reduce((e,r)=>{return e||(n=r.format,i=t,n.alpha===i.alpha&&n.mode===i.mode&&n.notation===i.notation&&n.type===i.type?r.stringifier:null);var n,i},null)}const dn=m("apl");class fn{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(dn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const r=t.createElement("div");r.classList.add(dn("b")),this.element.appendChild(r);const n=t.createElement("div");n.classList.add(dn("c")),r.appendChild(n),this.colorElem_=n;const i=t.createElement("div");i.classList.add(dn("m")),this.element.appendChild(i),this.markerElem_=i;const o=t.createElement("div");o.classList.add(dn("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),r=new Er([e[0],e[1],e[2],0],"rgb"),n=new Er([e[0],e[1],e[2],255],"rgb"),i=["to right",on(r),on(n)];this.colorElem_.style.background=`linear-gradient(${i.join(",")})`,this.previewElem_.style.backgroundColor=on(t);const o=qe(e[3],0,1,0,100);this.markerElem_.style.left=o+"%"}onValueChange_(){this.update_()}}class vn{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new fn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new He(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const r=t.point.x/t.bounds.width,n=this.value.rawValue,[i,o,a]=n.getComponents("hsv");this.value.setRawValue(new Er([i,o,a,r],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Re(Sr(!0),Ue(t));if(0===e)return;const r=this.value.rawValue,[n,i,o,a]=r.getComponents("hsv");this.value.setRawValue(new Er([n,i,o,a+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Re(Sr(!0),Ue(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const mn=m("coltxt");class bn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(mn()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("div");r.classList.add(mn("m")),this.modeElem_=function(t){const e=t.createElement("select");return e.appendChild([{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}].reduce((e,r)=>{const n=t.createElement("option");return n.textContent=r.text,n.value=r.value,e.appendChild(n),e},t.createDocumentFragment())),e}(t),this.modeElem_.classList.add(mn("ms")),r.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const n=t.createElement("div");n.classList.add(mn("mm")),n.appendChild(K(t,"dropdown")),r.appendChild(n),this.element.appendChild(r);const i=t.createElement("div");i.classList.add(mn("w")),this.element.appendChild(i),this.textsElem_=i,this.textViews_=e.textViews,this.applyTextViews_(),g(e.colorMode,t=>{this.modeElem_.value=t})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(t){this.textViews_=t,this.applyTextViews_()}applyTextViews_(){W(this.textsElem_);const t=this.element.ownerDocument;this.textViews_.forEach(e=>{const r=t.createElement("div");r.classList.add(mn("c")),r.appendChild(e.element),this.textsElem_.appendChild(r)})}}function gn(t,e,r){const n=xr(t,e)[r];return new Jt({min:0,max:n})}function wn(t,e,r){return new Qe(t,{arrayPosition:0===r?"fst":2===r?"lst":"mid",baseStep:Sr(!1),parser:e.parser,props:M.fromObject({draggingScale:"float"===e.colorType?.01:1,formatter:(n=e.colorType,Te("float"===n?2:0))}),value:A(0,{constraint:gn(e.colorMode,e.colorType,r)}),viewProps:e.viewProps});var n}class yn{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.parser_=e.parser,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=A(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new bn(t,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},r=[wn(t,e,0),wn(t,e,1),wn(t,e,2)];return r.forEach((t,e)=>{Ie({primary:this.value,secondary:t.value,forward:t=>t.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[e],backward:(t,r)=>{const n=this.colorMode.rawValue,i=t.rawValue.getComponents(n,this.colorType_);return i[e]=r.rawValue,new Er(yr(wr(i),i[3]),n,this.colorType_)}})}),r}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const _n=m("hpl");class xn{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(_n()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const r=t.createElement("div");r.classList.add(_n("c")),this.element.appendChild(r);const n=t.createElement("div");n.classList.add(_n("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=rn(new Er([e,100,100],"hsv"));const r=qe(e,0,360,0,100);this.markerElem_.style.left=r+"%"}onValueChange_(){this.update_()}}class Cn{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new xn(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new He(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const r=qe(Ge(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),n=this.value.rawValue,[,i,o,a]=n.getComponents("hsv");this.value.setRawValue(new Er([r,i,o,a],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=Re(Sr(!1),Ue(t));if(0===e)return;const r=this.value.rawValue,[n,i,o,a]=r.getComponents("hsv");this.value.setRawValue(new Er([n+e,i,o,a],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){0!==Re(Sr(!1),Ue(t))&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const kn=m("svp");class En{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(kn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const r=t.createElement("canvas");r.height=64,r.width=64,r.classList.add(kn("c")),this.element.appendChild(r),this.canvasElement=r;const n=t.createElement("div");n.classList.add(kn("m")),this.element.appendChild(n),this.markerElem_=n,this.update_()}update_(){const t=function(t){const e=t.ownerDocument.defaultView;return e&&"document"in e?t.getContext("2d",{willReadFrequently:!0}):null}(this.canvasElement);if(!t)return;const e=this.value.rawValue.getComponents("hsv"),r=this.canvasElement.width,n=this.canvasElement.height,i=t.getImageData(0,0,r,n),o=i.data;for(let l=0;l<n;l++)for(let t=0;t<r;t++){const i=qe(t,0,r,0,100),a=qe(l,0,n,100,0),s=gr(e[0],i,a),u=4*(l*r+t);o[u]=s[0],o[u+1]=s[1],o[u+2]=s[2],o[u+3]=255}t.putImageData(i,0,0);const a=qe(e[1],0,100,0,100);this.markerElem_.style.left=a+"%";const s=qe(e[2],0,100,100,0);this.markerElem_.style.top=s+"%"}onValueChange_(){this.update_()}}class Pn{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new En(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new He(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const r=qe(t.point.x,0,t.bounds.width,0,100),n=qe(t.point.y,0,t.bounds.height,100,0),[i,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Er([i,r,n,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){ze(t.key)&&t.preventDefault();const[e,r,n,i]=this.value.rawValue.getComponents("hsv"),o=Sr(!1),a=Re(o,Ue(t)),s=Re(o,Fe(t));0===a&&0===s||this.value.setRawValue(new Er([e,r+a,n+s,i],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Sr(!1),r=Re(e,Ue(t)),n=Re(e,Fe(t));0===r&&0===n||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class An{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Cn(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Pn(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new vn(t,{value:this.value,viewProps:this.viewProps}),text:new Qe(t,{parser:Ve,baseStep:.1,props:M.fromObject({draggingScale:.01,formatter:Te(2)}),value:A(0,{constraint:new Jt({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ie({primary:this.value,secondary:this.alphaIcs_.text.value,forward:t=>t.rawValue.getComponents()[3],backward:(t,e)=>{const r=t.rawValue.getComponents();return r[3]=e.rawValue,new Er(r,t.rawValue.mode)}}),this.textC_=new yn(t,{colorType:e.colorType,parser:Ve,value:this.value,viewProps:this.viewProps}),this.view=new Ar(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const Mn=m("colsw");class Vn{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Mn()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("div");r.classList.add(Mn("sw")),this.element.appendChild(r),this.swatchElem_=r;const n=t.createElement("button");n.classList.add(Mn("b")),e.viewProps.bindDisabled(n),this.element.appendChild(n),this.buttonElement=n,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=en(t)}onValueChange_(){this.update_()}}class Sn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Vn(t,{value:this.value,viewProps:this.viewProps})}}class Dn{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=rt.create(e.expanded),this.swatchC_=new Sn(t,{value:this.value,viewProps:this.viewProps});const r=this.swatchC_.view.buttonElement;r.addEventListener("blur",this.onButtonBlur_),r.addEventListener("click",this.onButtonClick_),this.textC_=new ce(t,{parser:e.parser,props:M.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new br(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_="popup"===e.pickerLayout?new se(t,{viewProps:this.viewProps}):null;const n=new An(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});n.view.allFocusableElements.forEach(t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=n,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(n.view.element),Ie({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),it(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,r=t.relatedTarget;r&&e.contains(r)||(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,r=Y(t);r&&e.contains(r)||r&&r===this.swatchC_.view.buttonElement&&!H(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.swatchC_.view.buttonElement.focus()}}function Tn(t){return wr(t.getComponents("rgb")).reduce((t,e)=>t<<8|255&Math.floor(e),0)}function Ln(t){return t.getComponents("rgb").reduce((t,e,r)=>t<<8|255&Math.floor(3===r?255*e:e),0)>>>0}function On(t){return"number"!=typeof t?Er.black():new Er([(e=t)>>16&255,e>>8&255,255&e],"rgb");var e}function jn(t){return"number"!=typeof t?Er.black():new Er([(e=t)>>24&255,e>>16&255,e>>8&255,qe(255&e,0,255,0,1)],"rgb");var e}function Bn(t){var e;return!(!(null==t?void 0:t.alpha)&&!(null===(e=null==t?void 0:t.color)||void 0===e?void 0:e.alpha))}function In(t){return t?t=>en(t,"0x"):t=>tn(t,"0x")}const Rn={id:"input-color-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;if(!function(t){return"color"in t||"view"in t&&"color"===t.view}(e))return null;const r=Vr(e);return r?{initialValue:t,params:r}:null},binding:{reader:t=>Bn(t.params)?jn:On,equals:Er.equals,writer:t=>function(t){const e=t?Ln:Tn;return(t,r)=>{nr(t,e(r))}}(Bn(t.params))},controller:t=>{const e=Bn(t.params),r="expanded"in t.params?t.params.expanded:void 0,n="picker"in t.params?t.params.picker:void 0;return new Dn(t.document,{colorType:"int",expanded:null!=r&&r,formatter:In(e),parser:Jr("int"),pickerLayout:null!=n?n:"popup",supportsAlpha:e,value:t.value,viewProps:t.viewProps})}};function Fn(t,e){return r=>t?un(r,e):sn(r,e)}const Un={id:"input-color-object",type:"input",accept:(t,e)=>{if(!Er.isColorObject(t))return null;const r=Vr(e);return r?{initialValue:t,params:r}:null},binding:{reader:t=>{return e=Dr(t.params),t=>function(t,e){return Er.isColorObject(t)?Er.fromObject(t,e):Er.black(e)}(t,e);var e},equals:Er.equals,writer:t=>{return n=t.initialValue,e=Er.isRgbaColorObject(n),r=Dr(t.params),(t,n)=>{e?function(t,e,r){const n=e.toRgbaObject(r);t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b),t.writeProperty("a",n.a)}(t,n,r):function(t,e,r){const n=e.toRgbaObject(r);t.writeProperty("r",n.r),t.writeProperty("g",n.g),t.writeProperty("b",n.b)}(t,n,r)};var e,r,n}},controller:t=>{var e;const r=Er.isRgbaColorObject(t.initialValue),n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0,o=null!==(e=Dr(t.params))&&void 0!==e?e:"int";return new Dn(t.document,{colorType:o,expanded:null!=n&&n,formatter:Fn(r,o),parser:Jr(o),pickerLayout:null!=i?i:"popup",supportsAlpha:r,value:t.value,viewProps:t.viewProps})}},zn={id:"input-color-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;if("view"in e&&"text"===e.view)return null;const r=Qr(t,Dr(e));if(!r)return null;if(!hn(r))return null;const n=Vr(e);return n?{initialValue:t,params:n}:null},binding:{reader:t=>{var e;return function(t){const e=Xr[t];return r=>{if("string"!=typeof r)return Er.black(t);const n=e.reduce((t,e)=>t||e(r),null);return null!=n?n:Er.black(t)}}(null!==(e=Dr(t.params))&&void 0!==e?e:"int")},equals:Er.equals,writer:t=>{const e=Qr(t.initialValue,Dr(t.params));if(!e)throw p.shouldNeverHappen();const r=function(t){const e=hn(t);return e?(t,r)=>{nr(t,e(r))}:null}(e);if(!r)throw p.notBindable();return r}},controller:t=>{const e=Qr(t.initialValue,Dr(t.params));if(!e)throw p.shouldNeverHappen();const r=hn(e);if(!r)throw p.shouldNeverHappen();const n="expanded"in t.params?t.params.expanded:void 0,i="picker"in t.params?t.params.picker:void 0;return new Dn(t.document,{colorType:e.type,expanded:null!=n&&n,formatter:r,parser:Jr(e.type),pickerLayout:null!=i?i:"popup",supportsAlpha:e.alpha,value:t.value,viewProps:t.viewProps})}};class Nn{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((t,e)=>{var r,n;return null!==(n=null===(r=this.components[e])||void 0===r?void 0:r.constrain(t))&&void 0!==n?n:t});return this.asm_.fromComponents(e)}}const Hn=m("pndtxt");class qn{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Hn()),this.textViews.forEach(e=>{const r=t.createElement("div");r.classList.add(Hn("a")),r.appendChild(e.element),this.element.appendChild(r)})}}class Kn{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((r,n)=>function(t,e,r){return new Qe(t,{arrayPosition:0===r?"fst":r===e.axes.length-1?"lst":"mid",baseStep:e.axes[r].baseStep,parser:e.parser,props:e.axes[r].textProps,value:A(0,{constraint:e.axes[r].constraint}),viewProps:e.viewProps})}(t,e,n)),this.acs_.forEach((t,r)=>{Ie({primary:this.value,secondary:t.value,forward:t=>e.assembly.toComponents(t.rawValue)[r],backward:(t,n)=>{const i=e.assembly.toComponents(t.rawValue);return i[r]=n.rawValue,e.assembly.fromComponents(i)}})}),this.view=new qn(t,{textViews:this.acs_.map(t=>t.view)})}}function Gn(t,e){return"step"in t&&!s(t.step)?new ee(t.step,e):null}function $n(t){return s(t.max)||s(t.min)?s(t.max)&&s(t.min)?null:new te({max:t.max,min:t.min}):new Jt({max:t.max,min:t.min})}const Wn={id:"input-number",type:"input",accept:(t,e)=>{if("number"!=typeof t)return null;const r=D,n=T(e,{format:r.optional.function,max:r.optional.number,min:r.optional.number,options:r.optional.custom(ir),step:r.optional.number});return n?{initialValue:t,params:n}:null},binding:{reader:t=>Se,constraint:t=>function(t,e){const r=[],n=Gn(t,e);n&&r.push(n);const i=$n(t);i&&r.push(i);const o=lr(t.options);return o&&r.push(o),new Qt(r)}(t.params,t.initialValue),writer:t=>nr},controller:t=>{var e;const r=t.value,n=t.constraint,i=n&&Xt(n,Zt);if(i)return new ie(t.document,{props:new M({options:i.values.value("options")}),value:r,viewProps:t.viewProps});const o=null!==(e="format"in t.params?t.params.format:void 0)&&void 0!==e?e:Te(ur(n,r.rawValue)),a=n&&Xt(n,Jt);return a?new rr(t.document,{baseStep:cr(n),parser:Ve,sliderProps:new M({maxValue:a.values.value("max"),minValue:a.values.value("min")}),textProps:M.fromObject({draggingScale:pr(n,r.rawValue),formatter:o}),value:r,viewProps:t.viewProps}):new Qe(t.document,{baseStep:cr(n),parser:Ve,props:M.fromObject({draggingScale:pr(n,r.rawValue),formatter:o}),value:r,viewProps:t.viewProps})}};class Yn{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(s(t))return!1;const e=t.x,r=t.y;return"number"==typeof e&&"number"==typeof r}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const Qn={toComponents:t=>t.getComponents(),fromComponents:t=>new Yn(...t)},Xn=m("p2d");class Jn{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Xn()),e.viewProps.bindClassModifiers(this.element),g(e.expanded,y(this.element,Xn(void 0,"expanded")));const r=t.createElement("div");r.classList.add(Xn("h")),this.element.appendChild(r);const n=t.createElement("button");n.classList.add(Xn("b")),n.appendChild(K(t,"p2dpad")),e.viewProps.bindDisabled(n),r.appendChild(n),this.buttonElement=n;const i=t.createElement("div");if(i.classList.add(Xn("t")),r.appendChild(i),this.textElement=i,"inline"===e.pickerLayout){const e=t.createElement("div");e.classList.add(Xn("p")),this.element.appendChild(e),this.pickerElement=e}else this.pickerElement=null}}const Zn=m("p2dp");class ti{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=e.invertsY,this.maxValue_=e.maxValue,this.element=t.createElement("div"),this.element.classList.add(Zn()),"popup"===e.layout&&this.element.classList.add(Zn(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("div");r.classList.add(Zn("p")),e.viewProps.bindTabIndex(r),this.element.appendChild(r),this.padElement=r;const n=t.createElementNS(z,"svg");n.classList.add(Zn("g")),this.padElement.appendChild(n),this.svgElem_=n;const i=t.createElementNS(z,"line");i.classList.add(Zn("ax")),i.setAttributeNS(null,"x1","0"),i.setAttributeNS(null,"y1","50%"),i.setAttributeNS(null,"x2","100%"),i.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(i);const o=t.createElementNS(z,"line");o.classList.add(Zn("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const a=t.createElementNS(z,"line");a.classList.add(Zn("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;const s=t.createElement("div");s.classList.add(Zn("m")),this.padElement.appendChild(s),this.markerElem_=s,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),r=this.maxValue_,n=qe(t,-r,+r,0,100),i=qe(e,-r,+r,0,100),o=this.invertsY_?100-i:i;this.lineElem_.setAttributeNS(null,"x2",n+"%"),this.lineElem_.setAttributeNS(null,"y2",o+"%"),this.markerElem_.style.left=n+"%",this.markerElem_.style.top=o+"%"}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ei(t,e,r){return[Re(e[0],Ue(t)),Re(e[1],Fe(t))*(r?1:-1)]}class ri{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.baseSteps_=e.baseSteps,this.maxValue_=e.maxValue,this.invertsY_=e.invertsY,this.view=new ti(t,{invertsY:this.invertsY_,layout:e.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new He(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const r=this.maxValue_,n=qe(t.point.x,0,t.bounds.width,-r,+r),i=qe(this.invertsY_?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-r,+r);this.value.setRawValue(new Yn(n,i),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){ze(t.key)&&t.preventDefault();const[e,r]=ei(t,this.baseSteps_,this.invertsY_);0===e&&0===r||this.value.setRawValue(new Yn(this.value.rawValue.x+e,this.value.rawValue.y+r),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,r]=ei(t,this.baseSteps_,this.invertsY_);0===e&&0===r||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class ni{constructor(t,e){var r,n;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=rt.create(e.expanded),this.popC_="popup"===e.pickerLayout?new se(t,{viewProps:this.viewProps}):null;const i=new ri(t,{baseSteps:[e.axes[0].baseStep,e.axes[1].baseStep],invertsY:e.invertsY,layout:e.pickerLayout,maxValue:e.maxValue,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach(t=>{t.addEventListener("blur",this.onPopupChildBlur_),t.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=i,this.textC_=new Kn(t,{assembly:Qn,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Jn(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),null===(r=this.view.buttonElement)||void 0===r||r.addEventListener("blur",this.onPadButtonBlur_),null===(n=this.view.buttonElement)||void 0===n||n.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ie({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:t=>t.rawValue,backward:(t,e)=>e.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),it(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,r=t.relatedTarget;r&&e.contains(r)||(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,r=Y(t);r&&e.contains(r)||r&&r===this.view.buttonElement&&!H(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?"Escape"===t.key&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&"Escape"===t.key&&this.view.buttonElement.focus()}}class ii{constructor(t=0,e=0,r=0){this.x=t,this.y=e,this.z=r}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(s(t))return!1;const e=t.x,r=t.y,n=t.z;return"number"==typeof e&&"number"==typeof r&&"number"==typeof n}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const oi={toComponents:t=>t.getComponents(),fromComponents:t=>new ii(...t)};function ai(t,e){return{baseStep:cr(e),constraint:e,textProps:M.fromObject({draggingScale:pr(e,t),formatter:Te(ur(e,t))})}}const si={id:"input-point3d",type:"input",accept:(t,e)=>{if(!ii.isObject(t))return null;const r=D,n=T(e,{x:r.optional.custom(ar),y:r.optional.custom(ar),z:r.optional.custom(ar)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>function(t){return ii.isObject(t)?new ii(t.x,t.y,t.z):new ii},constraint:t=>{return e=t.params,r=t.initialValue,new Nn({assembly:oi,components:[Vi("x"in e?e.x:void 0,r.x),Vi("y"in e?e.y:void 0,r.y),Vi("z"in e?e.z:void 0,r.z)]});var e,r},equals:ii.equals,writer:t=>function(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z)}},controller:t=>{const e=t.value,r=t.constraint;if(!(r instanceof Nn))throw p.shouldNeverHappen();return new Kn(t.document,{assembly:oi,axes:[ai(e.rawValue.x,r.components[0]),ai(e.rawValue.y,r.components[1]),ai(e.rawValue.z,r.components[2])],parser:Ve,value:e,viewProps:t.viewProps})}};class li{constructor(t=0,e=0,r=0,n=0){this.x=t,this.y=e,this.z=r,this.w=n}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(s(t))return!1;const e=t.x,r=t.y,n=t.z,i=t.w;return"number"==typeof e&&"number"==typeof r&&"number"==typeof n&&"number"==typeof i}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const ui={toComponents:t=>t.getComponents(),fromComponents:t=>new li(...t)},ci={id:"input-point4d",type:"input",accept:(t,e)=>{if(!li.isObject(t))return null;const r=D,n=T(e,{x:r.optional.custom(ar),y:r.optional.custom(ar),z:r.optional.custom(ar),w:r.optional.custom(ar)});return n?{initialValue:t,params:n}:null},binding:{reader:t=>function(t){return li.isObject(t)?new li(t.x,t.y,t.z,t.w):new li},constraint:t=>{return e=t.params,r=t.initialValue,new Nn({assembly:ui,components:[Vi("x"in e?e.x:void 0,r.x),Vi("y"in e?e.y:void 0,r.y),Vi("z"in e?e.z:void 0,r.z),Vi("w"in e?e.w:void 0,r.w)]});var e,r},equals:li.equals,writer:t=>function(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y),t.writeProperty("z",e.z),t.writeProperty("w",e.w)}},controller:t=>{const e=t.value,r=t.constraint;if(!(r instanceof Nn))throw p.shouldNeverHappen();return new Kn(t.document,{assembly:ui,axes:e.rawValue.getComponents().map((t,e)=>{return n=t,{baseStep:cr(i=r.components[e]),constraint:i,textProps:M.fromObject({draggingScale:pr(i,n),formatter:Te(ur(i,n))})};var n,i}),parser:Ve,value:e,viewProps:t.viewProps})}},pi={id:"input-string",type:"input",accept:(t,e)=>{if("string"!=typeof t)return null;const r=T(e,{options:D.optional.custom(ir)});return r?{initialValue:t,params:r}:null},binding:{reader:t=>je,constraint:t=>function(t){const e=[],r=lr(t.options);return r&&e.push(r),new Qt(e)}(t.params),writer:t=>nr},controller:t=>{const e=t.document,r=t.value,n=t.constraint,i=n&&Xt(n,Zt);return i?new ie(e,{props:new M({options:i.values.value("options")}),value:r,viewProps:t.viewProps}):new ce(e,{parser:t=>t,props:M.fromObject({formatter:Be}),value:r,viewProps:t.viewProps})}},hi={defaultInterval:200,defaultLineCount:3},di=m("mll");class fi{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(di()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("textarea");r.classList.add(di("i")),r.style.height=`calc(var(--bld-us) * ${e.lineCount})`,r.readOnly=!0,e.viewProps.bindDisabled(r),this.element.appendChild(r),this.textareaElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,r=[];this.value.rawValue.forEach(t=>{void 0!==t&&r.push(this.formatter_(t))}),t.textContent=r.join("\n"),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class vi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new fi(t,{formatter:e.formatter,lineCount:e.lineCount,value:this.value,viewProps:this.viewProps})}}const mi=m("sgl");class bi{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(mi()),e.viewProps.bindClassModifiers(this.element);const r=t.createElement("input");r.classList.add(mi("i")),r.readOnly=!0,r.type="text",e.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=void 0!==e?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class gi{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new bi(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}const wi={id:"monitor-bool",type:"monitor",accept:(t,e)=>{if("boolean"!=typeof t)return null;const r=T(e,{lineCount:D.optional.number});return r?{initialValue:t,params:r}:null},binding:{reader:t=>pe},controller:t=>{var e;return 1===t.value.rawValue.length?new gi(t.document,{formatter:he,value:t.value,viewProps:t.viewProps}):new vi(t.document,{formatter:he,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:hi.defaultLineCount,value:t.value,viewProps:t.viewProps})}},yi=m("grl");class _i{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(yi()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const r=t.createElementNS(z,"svg");r.classList.add(yi("g")),r.style.height=`calc(var(--bld-us) * ${e.lineCount})`,this.element.appendChild(r),this.svgElem_=r;const n=t.createElementNS(z,"polyline");this.svgElem_.appendChild(n),this.lineElem_=n;const i=t.createElement("div");i.classList.add(yi("t"),m("tt")()),this.element.appendChild(i),this.tooltipElem_=i,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,r=this.props_.get("minValue"),n=this.props_.get("maxValue"),i=[];this.value.rawValue.forEach((o,a)=>{if(void 0===o)return;const s=qe(a,0,e,0,t.width),l=qe(o,r,n,t.height,0);i.push([s,l].join(","))}),this.lineElem_.setAttributeNS(null,"points",i.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(void 0===a)return void o.classList.remove(yi("t","a"));const s=qe(this.cursor_.rawValue,0,e,0,t.width),l=qe(a,r,n,t.height,0);o.style.left=s+"px",o.style.top=l+"px",o.textContent=""+this.formatter_(a),o.classList.contains(yi("t","a"))||(o.classList.add(yi("t","a"),yi("t","in")),N(o),o.classList.remove(yi("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class xi{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=A(-1),this.view=new _i(t,{cursor:this.cursor_,formatter:e.formatter,lineCount:e.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),H(t)){const t=new He(this.view.element);t.emitter.on("down",this.onGraphPointerDown_),t.emitter.on("move",this.onGraphPointerMove_),t.emitter.on("up",this.onGraphPointerUp_)}else this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_)}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(qe(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){t.data.point?this.cursor_.rawValue=Math.floor(qe(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length)):this.cursor_.rawValue=-1}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Ci(t){return"format"in t&&!s(t.format)?t.format:Te(2)}function ki(t){return"view"in t&&"graph"===t.view}const Ei={id:"monitor-number",type:"monitor",accept:(t,e)=>{if("number"!=typeof t)return null;const r=D,n=T(e,{format:r.optional.function,lineCount:r.optional.number,max:r.optional.number,min:r.optional.number,view:r.optional.string});return n?{initialValue:t,params:n}:null},binding:{defaultBufferSize:t=>ki(t)?64:1,reader:t=>Se},controller:t=>ki(t.params)?function(t){var e,r,n;return new xi(t.document,{formatter:Ci(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:hi.defaultLineCount,props:M.fromObject({maxValue:null!==(r="max"in t.params?t.params.max:null)&&void 0!==r?r:100,minValue:null!==(n="min"in t.params?t.params.min:null)&&void 0!==n?n:0}),value:t.value,viewProps:t.viewProps})}(t):function(t){var e;return 1===t.value.rawValue.length?new gi(t.document,{formatter:Ci(t.params),value:t.value,viewProps:t.viewProps}):new vi(t.document,{formatter:Ci(t.params),lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:hi.defaultLineCount,value:t.value,viewProps:t.viewProps})}(t)},Pi={id:"monitor-string",type:"monitor",accept:(t,e)=>{if("string"!=typeof t)return null;const r=D,n=T(e,{lineCount:r.optional.number,multiline:r.optional.boolean});return n?{initialValue:t,params:n}:null},binding:{reader:t=>je},controller:t=>{var e;const r=t.value;return r.rawValue.length>1||"multiline"in t.params&&t.params.multiline?new vi(t.document,{formatter:Be,lineCount:null!==(e=t.params.lineCount)&&void 0!==e?e:hi.defaultLineCount,value:r,viewProps:t.viewProps}):new gi(t.document,{formatter:Be,value:r,viewProps:t.viewProps})}};function Ai(t,e){return 0===e?new Ht:new qt(t,null!=e?e:hi.defaultInterval)}class Mi{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t){"blade"===t.type?this.pluginsMap_.blades.unshift(t):"input"===t.type?this.pluginsMap_.inputs.unshift(t):"monitor"===t.type&&this.pluginsMap_.monitors.unshift(t)}createInput(t,e,r){if(s(e.read()))throw new p({context:{key:e.key},type:"nomatchingcontroller"});const n=this.pluginsMap_.inputs.reduce((n,i)=>null!=n?n:function(t,e){var r;const n=t.accept(e.target.read(),e.params);if(s(n))return null;const i=D,o={target:e.target,initialValue:n.initialValue,params:n.params},a=t.binding.reader(o),l=t.binding.constraint?t.binding.constraint(o):void 0,u=A(a(n.initialValue),{constraint:l,equals:t.binding.equals}),c=new Kt({reader:a,target:e.target,value:u,writer:t.binding.writer(o)}),p=i.optional.boolean(e.params.disabled).value,h=i.optional.boolean(e.params.hidden).value,d=t.controller({constraint:l,document:e.document,initialValue:n.initialValue,params:n.params,value:c.value,viewProps:I.create({disabled:p,hidden:h})});return new lt(e.document,{binding:c,blade:et(),props:M.fromObject({label:"label"in e.params?null!==(r=i.optional.string(e.params.label).value)&&void 0!==r?r:null:e.target.key}),valueController:d})}(i,{document:t,target:e,params:r}),null);if(n)return n;throw new p({context:{key:e.key},type:"nomatchingcontroller"})}createMonitor(t,e,r){const n=this.pluginsMap_.monitors.reduce((n,i)=>null!=n?n:function(t,e){var r,n,i;const o=D,a=t.accept(e.target.read(),e.params);if(s(a))return null;const l={target:e.target,initialValue:a.initialValue,params:a.params},u=t.binding.reader(l),c=null!==(n=null!==(r=o.optional.number(e.params.bufferSize).value)&&void 0!==r?r:t.binding.defaultBufferSize&&t.binding.defaultBufferSize(a.params))&&void 0!==n?n:1,p=o.optional.number(e.params.interval).value,h=new Yt({reader:u,target:e.target,ticker:Ai(e.document,p),value:$t(c)}),d=o.optional.boolean(e.params.disabled).value,f=o.optional.boolean(e.params.hidden).value,v=t.controller({document:e.document,params:a.params,value:h.value,viewProps:I.create({disabled:d,hidden:f})});return new ct(e.document,{binding:h,blade:et(),props:M.fromObject({label:"label"in e.params?null!==(i=o.optional.string(e.params.label).value)&&void 0!==i?i:null:e.target.key}),valueController:v})}(i,{document:t,params:r,target:e}),null);if(n)return n;throw new p({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const r=this.pluginsMap_.blades.reduce((r,n)=>null!=r?r:function(t,e){const r=t.accept(e.params);if(!r)return null;const n=D.optional.boolean(e.params.disabled).value,i=D.optional.boolean(e.params.hidden).value;return t.controller({blade:et(),document:e.document,params:Object.assign(Object.assign({},r.params),{disabled:n,hidden:i}),viewProps:I.create({disabled:n,hidden:i})})}(n,{document:t,params:e}),null);if(!r)throw new p({type:"nomatchingview",context:{params:e}});return r}createBladeApi(t){if(t instanceof lt)return new st(t);if(t instanceof ct)return new ut(t);if(t instanceof _t)return new ft(t,this);const e=this.pluginsMap_.blades.reduce((e,r)=>null!=e?e:r.api({controller:t,pool:this}),null);if(!e)throw p.shouldNeverHappen();return e}}function Vi(t,e){if(!t)return;const r=[],n=Gn(t,e);n&&r.push(n);const i=$n(t);return i&&r.push(i),new Qt(r)}function Si(t,e){const[r,n]=t?function(t){const e=Xt(t,Jt);if(e)return[e.values.get("min"),e.values.get("max")];const r=Xt(t,te);return r?[r.minValue,r.maxValue]:[void 0,void 0]}(t):[];if(!s(r)||!s(n))return Math.max(Math.abs(null!=r?r:0),Math.abs(null!=n?n:0));const i=cr(t);return Math.max(10*Math.abs(i),10*Math.abs(e))}function Di(t,e){const r=e instanceof Nn?e.components[0]:void 0,n=e instanceof Nn?e.components[1]:void 0,i=Si(r,t.x),o=Si(n,t.y);return Math.max(i,o)}function Ti(t,e){return{baseStep:cr(e),constraint:e,textProps:M.fromObject({draggingScale:pr(e,t),formatter:Te(ur(e,t))})}}function Li(t){if(!("y"in t))return!1;const e=t.y;return!!e&&"inverted"in e&&!!e.inverted}const Oi={id:"input-point2d",type:"input",accept:(t,e)=>{if(!Yn.isObject(t))return null;const r=D,n=T(e,{expanded:r.optional.boolean,picker:r.optional.custom(or),x:r.optional.custom(ar),y:r.optional.object({inverted:r.optional.boolean,max:r.optional.number,min:r.optional.number,step:r.optional.number})});return n?{initialValue:t,params:n}:null},binding:{reader:t=>function(t){return Yn.isObject(t)?new Yn(t.x,t.y):new Yn},constraint:t=>{return e=t.params,r=t.initialValue,new Nn({assembly:Qn,components:[Vi("x"in e?e.x:void 0,r.x),Vi("y"in e?e.y:void 0,r.y)]});var e,r},equals:Yn.equals,writer:t=>function(t,e){t.writeProperty("x",e.x),t.writeProperty("y",e.y)}},controller:t=>{const e=t.document,r=t.value,n=t.constraint;if(!(n instanceof Nn))throw p.shouldNeverHappen();const i="expanded"in t.params?t.params.expanded:void 0,o="picker"in t.params?t.params.picker:void 0;return new ni(e,{axes:[Ti(r.rawValue.x,n.components[0]),Ti(r.rawValue.y,n.components[1])],expanded:null!=i&&i,invertsY:Li(t.params),maxValue:Di(r.rawValue,n),parser:Ve,pickerLayout:null!=o?o:"popup",value:r,viewProps:t.viewProps})}};class ji extends e{constructor(t){super(t),this.emitter_=new f,this.controller_.valueController.value.emitter.on("change",t=>{this.emitter_.emit("change",{event:new n(this,t.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get options(){return this.controller_.valueController.props.get("options")}set options(t){this.controller_.valueController.props.set("options",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}}class Bi extends e{constructor(t){super(t),this.emitter_=new f,this.controller_.valueController.value.emitter.on("change",t=>{this.emitter_.emit("change",{event:new n(this,t.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(t){this.controller_.valueController.sliderController.props.set("maxValue",t)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(t){this.controller_.valueController.sliderController.props.set("minValue",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}}class Ii extends e{constructor(t){super(t),this.emitter_=new f,this.controller_.valueController.value.emitter.on("change",t=>{this.emitter_.emit("change",{event:new n(this,t.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(t){this.controller_.props.set("label",t)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(t){this.controller_.valueController.props.set("formatter",t)}get value(){return this.controller_.valueController.value.rawValue}set value(t){this.controller_.valueController.value.rawValue=t}on(t,e){const r=e.bind(this);return this.emitter_.on(t,t=>{r(t.event)}),this}}const Ri={id:"list",type:"blade",accept(t){const e=D,r=T(t,{options:e.required.custom(ir),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return r?{params:r}:null},controller(t){const e=new Zt(sr(t.params.options)),r=A(t.params.value,{constraint:e}),n=new ie(t.document,{props:new M({options:e.values.value("options")}),value:r,viewProps:t.viewProps});return new Pt(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:n})},api:t=>t.controller instanceof Pt&&t.controller.valueController instanceof ie?new ji(t.controller):null};class Fi extends vt{constructor(t,e){super(t,e)}get element(){return this.controller_.view.element}importPreset(t){!function(t,e){t.forEach(t=>{const r=e[t.target.presetKey];void 0!==r&&t.writer(t.target,t.reader(r))})}(this.controller_.rackController.rack.find(lt).map(t=>t.binding),t),this.refresh()}exportPreset(){return this.controller_.rackController.rack.find(lt).map(t=>t.binding.target).reduce((t,e)=>Object.assign(t,{[e.presetKey]:e.read()}),{})}refresh(){this.controller_.rackController.rack.find(lt).forEach(t=>{t.binding.read()}),this.controller_.rackController.rack.find(ct).forEach(t=>{t.binding.read()})}}class Ui extends kt{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const zi={id:"slider",type:"blade",accept(t){const e=D,r=T(t,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return r?{params:r}:null},controller(t){var e,r;const n=null!==(e=t.params.value)&&void 0!==e?e:0,i=new Jt({max:t.params.max,min:t.params.min}),o=new rr(t.document,{baseStep:1,parser:Ve,sliderProps:new M({maxValue:i.values.value("max"),minValue:i.values.value("min")}),textProps:M.fromObject({draggingScale:pr(void 0,n),formatter:null!==(r=t.params.format)&&void 0!==r?r:De}),value:A(n,{constraint:i}),viewProps:t.viewProps});return new Pt(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:o})},api:t=>t.controller instanceof Pt&&t.controller.valueController instanceof rr?new Bi(t.controller):null},Ni={id:"text",type:"blade",accept(t){const e=D,r=T(t,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return r?{params:r}:null},controller(t){var e;const r=new ce(t.document,{parser:t.params.parse,props:M.fromObject({formatter:null!==(e=t.params.format)&&void 0!==e?e:t=>String(t)}),value:A(t.params.value),viewProps:t.viewProps});return new Pt(t.document,{blade:t.blade,props:M.fromObject({label:t.params.label}),valueController:r})},api:t=>t.controller instanceof Pt&&t.controller.valueController instanceof ce?new Ii(t.controller):null};function Hi(t,e,r){if(t.querySelector(`style[data-tp-style=${e}]`))return;const n=t.createElement("style");n.dataset.tpStyle=e,n.textContent=r,t.head.appendChild(n)}new class{constructor(t){const[e,r]=t.split("-"),n=e.split(".");this.major=parseInt(n[0],10),this.minor=parseInt(n[1],10),this.patch=parseInt(n[2],10),this.prerelease=null!=r?r:null}toString(){const t=[this.major,this.minor,this.patch].join(".");return null!==this.prerelease?[t,this.prerelease].join("-"):t}}("3.1.7");t.Pane=class extends Fi{constructor(t){var e,r;const n=null!=t?t:{},i=null!==(e=n.document)&&void 0!==e?e:globalThis.document,o=function(){const t=new Mi;return[Oi,si,ci,pi,Wn,zn,Un,Rn,vr,wi,Pi,Ei,Z,Et,Dt,Nt].forEach(e=>{t.register(e)}),t}();super(new Ui(i,{expanded:n.expanded,blade:et(),props:M.fromObject({title:n.title}),viewProps:I.create()}),o),this.pool_=o,this.containerElem_=null!==(r=n.container)&&void 0!==r?r:function(t){const e=t.createElement("div");return e.classList.add(m("dfw")()),t.body&&t.body.appendChild(e),e}(i),this.containerElem_.appendChild(this.element),this.doc_=i,this.usesDefaultWrapper_=!n.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw p.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw p.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach(t=>{this.pool_.register(t),this.embedPluginStyle_(t)})}embedPluginStyle_(t){t.css&&Hi(this.document,"plugin-"+t.id,t.css)}setUpDefaultPlugins_(){Hi(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(t=>{this.embedPluginStyle_(t)}),this.registerPlugin({plugins:[zi,Ri,Nt,Ni]})}},Object.defineProperty(t,"__esModule",{value:!0})},"object"==typeof ir.exports?rr(ir.exports):"function"==typeof define&&define.amd?define(["exports"],rr):rr((er="undefined"!=typeof globalThis?globalThis:er||self).Tweakpane={}),ir=ir.exports;const{shuffle:or,shuffleLCD:ar,directions:sr,animations:lr}=nr,ur={text:"We chase misprinted lies",duration:2,fps:60,animation:lr.SHOW,direction:sr.RANDOM,nglyphs:""},cr={text:"We face the path of time",fps:60,stayFrames:25,animation:lr.SHOW,nglyphs:""};let pr;const hr=t=>{pr.innerText=t},dr=()=>{const{text:t,duration:e,fps:r,nglyphs:n,direction:i,animation:o}=ur,a=n.length?n:void 0;or({text:t,duration:e,fps:r,glyphs:a,direction:i,animation:o,onUpdate:hr})},fr=()=>{const{text:t,fps:e,nglyphs:r,stayFrames:n,animation:i}=cr,o=r.length?r:void 0;ar({text:t,fps:e,glyphs:o,stayFrames:n,animation:i,onUpdate:hr})};pr=document.querySelector("pre"),(()=>{const t=new ir.Pane;let e;(e=t.addFolder({title:"SHUFFLE"})).addInput(ur,"text"),e.addInput(ur,"duration",{min:0,max:3,step:.1}),e.addInput(ur,"fps",{min:1,max:60,step:1}),e.addInput(ur,"animation",{options:lr}),e.addInput(ur,"direction",{options:sr}),e.addInput(ur,"nglyphs",{label:"glyphs"}),e.addButton({title:"SHUFFLE",label:"play"}).on("click",dr),(e=t.addFolder({title:"SHUFFLE LCD"})).addInput(cr,"text"),e.addInput(cr,"fps",{min:1,max:60,step:1}),e.addInput(cr,"animation",{options:lr}),e.addInput(cr,"stayFrames",{min:1,max:60,step:1}),e.addInput(cr,"nglyphs",{label:"glyphs"}),e.addButton({title:"SHUFFLE LCD",label:"play"}).on("click",fr)})(),dr()}();